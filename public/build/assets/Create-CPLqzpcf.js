import{r as n,e as g,j as e,H as L,m as D,c as H,b as y,h as j,a as B,s as K,g as O,d as G}from"./app-DLWZL5EI.js";import{s as F}from"./toastUtils-CQ8tPw7l.js";import{A as J}from"./App-CPiN04Y0.js";import{b as p,T as f,a as u}from"./ThemedCard-Dc5moHAm.js";import{F as U}from"./ArrowLeftIcon-a6q7R3tQ.js";import{F as S}from"./PlusIcon-CgcHryUb.js";import{F as Y}from"./BuildingOfficeIcon-BJoAl2gF.js";import{F as Q}from"./GlobeAltIcon-CFAl4tmE.js";import{F as X}from"./CheckCircleIcon-CaJShsm_.js";import{F as Z}from"./UserIcon-DiPxEy9e.js";import{c as ee}from"./chunk-C6WKGNND-Dq1nEPC1.js";import{i as d}from"./chunk-SQIAVXJX-C5zDfxFa.js";import{s as R}from"./chunk-C3QHEOC2-Bmp2Jpe_.js";import{l as T}from"./chunk-Y5DMIIWQ-zhqLBGLU.js";import"./app-BI-xrU3s.js";import"./index-lAyyVki8.js";/* empty css                      */import"./routeUtils-C6MiLID5.js";import"./chunk-CV4BWJDJ-C645uC3W.js";import"./index-DD7PnbC4.js";import"./index-Dz459_my.js";import"./Cog6ToothIcon-CI3NiAkm.js";import"./useBranding-C98uB2bk.js";import"./useDialog-LKdJQ55I.js";import"./getScrollParent-B27hviGV.js";import"./keyboard-CSKkBtIV.js";import"./useLabels-CKC_NELL.js";import"./VisuallyHidden-Dslt4DE9.js";import"./index-B5MKI_DQ.js";import"./XMarkIcon-C9tv-sqJ.js";import"./MagnifyingGlassIcon-C9l2NPQE.js";import"./chunk-AUA5GDXN-DgHZKZnK.js";import"./chunk-WQVQ7P2I-BXEU6rr0.js";import"./number-CB4zbwAz.js";import"./chunk-LGMZDQT5-BbUrfslF.js";import"./useMediaQuery-CZ_V8brP.js";import"./chunk-IHO36JMK-DYeauZfe.js";import"./ShieldCheckIcon-BxwQA0uM.js";import"./AcademicCapIcon-Bs9t2qow.js";import"./IdentificationIcon-6E2VOCK1.js";import"./ArrowRightIcon-BZNmx9ah.js";import"./UsersIcon-CpsA-xGl.js";import"./BoltIcon-BRTqiOqL.js";import"./BriefcaseIcon-CunjT5yU.js";import"./CalendarDaysIcon-BR4QgBq8.js";import"./CalendarIcon-BTj7Nn7B.js";import"./ChartBarIcon-CnSK0enl.js";import"./CircleStackIcon-20fpj2M5.js";import"./ClipboardDocumentCheckIcon-Bwahsg1t.js";import"./CogIcon-CQIGGanJ.js";import"./DeviceTabletIcon-CR6eyvHQ.js";import"./CpuChipIcon-Dkmm6hKt.js";import"./CurrencyDollarIcon-DK6JNn4H.js";import"./DevicePhoneMobileIcon-DzKKUXAD.js";import"./DocumentArrowUpIcon-CdnT1l-_.js";import"./PencilIcon-Da-ZoIco.js";import"./TrashIcon-C6DesZfk.js";import"./DocumentIcon-YVJ_odhG.js";import"./EnvelopeIcon-BNQywoLu.js";import"./ExclamationCircleIcon-D-5waelr.js";import"./EyeSlashIcon-C7uJqcIF.js";import"./EyeIcon-Ds6DAjR7.js";import"./FunnelIcon-D8WHt0li.js";import"./InformationCircleIcon-2sIUPx4E.js";import"./KeyIcon-Dl6jmBIi.js";import"./LockClosedIcon-DWSbAAT6.js";import"./MapPinIcon-CoSq0ZKP.js";import"./PlusCircleIcon-borTRmVT.js";import"./PrinterIcon-jsVlFWpL.js";import"./RocketLaunchIcon-C1ofXZeY.js";import"./ShoppingCartIcon-DijpYrUE.js";import"./UserCircleIcon-D9Bl7hMN.js";import"./UserGroupIcon-DLyCB4U6.js";import"./chunk-TW2E3XVA-dNGvEz5r.js";import"./chunk-I3A4XRYQ-CbmreU5k.js";import"./useToggleState-C1tJJPv7.js";import"./chunk-ICU6NNET-BuoRM2Mj.js";import"./MaintenanceModeBanner-CpiCdC4n.js";import"./Item-hnCJOaQ5.js";import"./SelectionManager-UhxaObWG.js";import"./index-D3fxkw17.js";import"./useSelectableItem-Qild1lMf.js";import"./useTreeState-CsNDLaZy.js";import"./useMenuTriggerState-CpMESG3a.js";import"./chunk-KQW2TNLT-BxZBj3py.js";import"./useField-CN4URFK6.js";import"./useLabel-BC4q2FsI.js";import"./chunk-7F3ZLNJ6-BH294qJ7.js";import"./index-CGn2JJsk.js";const ae=({auth:v,title:A})=>{const t=()=>{if(typeof window>"u")return"lg";const i=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12px",o=parseInt(i);return o===0?"none":o<=4?"sm":o<=8?"md":o<=16?"lg":"full"},[m,E]=n.useState(!1),[se,I]=n.useState(!1);n.useEffect(()=>{const a=()=>{E(window.innerWidth<640),I(window.innerWidth<768)};return a(),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]);const[$,k]=n.useState([]),[w,N]=n.useState(!1),[W,_]=n.useState(!1),[h,x]=n.useState(null),[s,q]=n.useState({name:"",subdomain:"",email:"",phone:"",type:"business",plan_id:"",trial_days:14,admin_name:"",admin_email:"",admin_password:""}),[r,b]=n.useState({});n.useEffect(()=>{P()},[]);const P=async()=>{try{const a=await g.get(route("api.v1.plans.index"));k(a.data.data||[])}catch(a){console.error("Failed to fetch plans:",a)}},C=n.useCallback(async a=>{if(!a||a.length<3){x(null);return}_(!0);try{const i=await g.get(route("api.v1.tenants.index"),{params:{subdomain_check:a}});x(i.data.available!==!1)}catch{x(null)}finally{_(!1)}},[]);n.useEffect(()=>{const a=setTimeout(()=>{s.subdomain&&C(s.subdomain)},500);return()=>clearTimeout(a)},[s.subdomain,C]);const l=(a,i)=>{q(o=>({...o,[a]:i})),r[a]&&b(o=>({...o,[a]:null}))},z=()=>{const a={};return s.name||(a.name="Company name is required"),s.subdomain?/^[a-z0-9][a-z0-9-]*[a-z0-9]$/i.test(s.subdomain)||(a.subdomain="Subdomain must start and end with alphanumeric characters"):a.subdomain="Subdomain is required",s.email||(a.email="Email is required"),s.type||(a.type="Tenant type is required"),s.plan_id||(a.plan_id="Plan is required"),s.admin_name||(a.admin_name="Admin name is required"),s.admin_email||(a.admin_email="Admin email is required"),b(a),Object.keys(a).length===0},V=async()=>{if(!z()){F.error("Please fix the form errors");return}N(!0);const a=new Promise(async(i,o)=>{try{const c=await g.post(route("api.v1.tenants.store"),s);i([c.data.message||"Tenant created successfully"]),setTimeout(()=>{j.visit(route("admin.tenants.show",{tenant:c.data.data.id}))},1e3)}catch(c){c.response?.data?.errors&&b(c.response.data.errors),o(c.response?.data?.message||"Failed to create tenant")}finally{N(!1)}});F.promise(a,{loading:"Creating tenant...",success:i=>i.join(", "),error:i=>Array.isArray(i)?i.join(", "):i})},M=[{key:"startup",label:"Startup",description:"Small team, basic features"},{key:"business",label:"Business",description:"Growing business, standard features"},{key:"enterprise",label:"Enterprise",description:"Large organization, full features"}];return e.jsxs(e.Fragment,{children:[e.jsx(L,{title:A||"Create Tenant"}),e.jsx("div",{className:"flex flex-col w-full h-full p-4",role:"main","aria-label":"Create Tenant",children:e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"w-full",children:e.jsx(D.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},children:e.jsxs(H,{className:"transition-all duration-200",style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))",background:`linear-gradient(135deg, 
                                        var(--theme-content1, #FAFAFA) 20%, 
                                        var(--theme-content2, #F4F4F5) 10%, 
                                        var(--theme-content3, #F1F3F4) 20%)`},children:[e.jsx(ee,{className:"border-b p-0",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                            color-mix(in srgb, var(--theme-content1) 50%, transparent) 20%, 
                                            color-mix(in srgb, var(--theme-content2) 30%, transparent) 10%)`},children:e.jsx("div",{className:`${m?"p-4":"p-6"} w-full`,children:e.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsx(y,{isIconOnly:!0,variant:"light",radius:t(),onPress:()=>j.visit(route("admin.tenants.index")),className:"shrink-0",children:e.jsx(U,{className:"w-5 h-5"})}),e.jsx("div",{className:`${m?"p-2":"p-3"} rounded-xl flex items-center justify-center`,style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsx(S,{className:`${m?"w-6 h-6":"w-8 h-8"}`,style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:`${m?"text-xl":"text-2xl"} font-bold text-foreground ${m?"truncate":""}`,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Create New Tenant"}),e.jsx("p",{className:`${m?"text-xs":"text-sm"} text-default-500 ${m?"truncate":""}`,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Provision a new tenant with database and configuration"})]})]})})})}),e.jsx(B,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(p,{children:[e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Company Information"})]})}),e.jsx(u,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(d,{label:"Company Name",placeholder:"Enter company name",value:s.name,onValueChange:a=>l("name",a),isInvalid:!!r.name,errorMessage:r.name,isRequired:!0,radius:t(),classNames:{inputWrapper:"bg-default-100"}}),e.jsx(d,{label:"Email",type:"email",placeholder:"company@example.com",value:s.email,onValueChange:a=>l("email",a),isInvalid:!!r.email,errorMessage:r.email,isRequired:!0,radius:t(),classNames:{inputWrapper:"bg-default-100"}}),e.jsx(d,{label:"Phone",placeholder:"+1 234 567 8900",value:s.phone,onValueChange:a=>l("phone",a),radius:t(),classNames:{inputWrapper:"bg-default-100"}}),e.jsx(R,{label:"Tenant Type",placeholder:"Select type",selectedKeys:s.type?[s.type]:[],onSelectionChange:a=>l("type",Array.from(a)[0]),isInvalid:!!r.type,errorMessage:r.type,isRequired:!0,radius:t(),classNames:{trigger:"bg-default-100"},children:M.map(a=>e.jsx(T,{description:a.description,children:a.label},a.key))})]})})]}),e.jsxs(p,{children:[e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Subdomain Configuration"})]})}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(d,{label:"Subdomain",placeholder:"company-name",value:s.subdomain,onValueChange:a=>l("subdomain",a.toLowerCase().replace(/[^a-z0-9-]/g,"")),isInvalid:!!r.subdomain||h===!1,errorMessage:r.subdomain||(h===!1?"Subdomain is already taken":null),isRequired:!0,radius:t(),classNames:{inputWrapper:"bg-default-100"},description:`Your tenant will be accessible at: ${s.subdomain||"subdomain"}.yourdomain.com`,endContent:W?e.jsx(K,{size:"sm"}):h===!0?e.jsx(X,{className:"w-5 h-5 text-success"}):h===!1?e.jsx(O,{className:"w-5 h-5 text-danger"}):null}),h===!0&&e.jsx(G,{color:"success",variant:"flat",size:"sm",children:"Subdomain is available!"})]})})]}),e.jsxs(p,{children:[e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Initial Admin User"})]})}),e.jsx(u,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(d,{label:"Admin Name",placeholder:"John Doe",value:s.admin_name,onValueChange:a=>l("admin_name",a),isInvalid:!!r.admin_name,errorMessage:r.admin_name,isRequired:!0,radius:t(),classNames:{inputWrapper:"bg-default-100"}}),e.jsx(d,{label:"Admin Email",type:"email",placeholder:"admin@company.com",value:s.admin_email,onValueChange:a=>l("admin_email",a),isInvalid:!!r.admin_email,errorMessage:r.admin_email,isRequired:!0,radius:t(),classNames:{inputWrapper:"bg-default-100"}}),e.jsx(d,{label:"Admin Password",type:"password",placeholder:"Leave empty to auto-generate",value:s.admin_password,onValueChange:a=>l("admin_password",a),description:"If left empty, a secure password will be generated and emailed",radius:t(),classNames:{inputWrapper:"bg-default-100"}})]})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(p,{children:[e.jsx(f,{children:e.jsx("h3",{className:"text-lg font-semibold",children:"Subscription Plan"})}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(R,{label:"Select Plan",placeholder:"Choose a plan",selectedKeys:s.plan_id?[String(s.plan_id)]:[],onSelectionChange:a=>l("plan_id",Array.from(a)[0]),isInvalid:!!r.plan_id,errorMessage:r.plan_id,isRequired:!0,radius:t(),classNames:{trigger:"bg-default-100"},children:$.map(a=>e.jsx(T,{description:`$${a.price}/mo`,children:a.name},String(a.id)))}),e.jsx(d,{type:"number",label:"Trial Days",placeholder:"14",value:String(s.trial_days),onValueChange:a=>l("trial_days",parseInt(a)||0),min:0,max:90,description:"Number of days before billing starts",radius:t(),classNames:{inputWrapper:"bg-default-100"}})]})})]}),e.jsx(p,{children:e.jsx(u,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(y,{color:"primary",className:"w-full",size:"lg",radius:t(),onPress:V,isLoading:w,startContent:!w&&e.jsx(S,{className:"w-5 h-5"}),children:"Create Tenant"}),e.jsx(y,{variant:"flat",className:"w-full",radius:t(),onPress:()=>j.visit(route("admin.tenants.index")),children:"Cancel"})]})})}),e.jsx(p,{children:e.jsx(u,{children:e.jsxs("div",{className:"text-sm text-default-500 space-y-2",children:[e.jsx("p",{className:"font-semibold text-default-700",children:"What happens next?"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Database will be provisioned"}),e.jsx("li",{children:"Default configurations applied"}),e.jsx("li",{children:"Admin user will be created"}),e.jsx("li",{children:"Welcome email will be sent"})]})]})})})]})]})})]})})})})})]})};ae.layout=v=>e.jsx(J,{children:v});export{ae as default};
