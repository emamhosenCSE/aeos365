import{f as je,R as Ne,j as e,e as X,b as P,l as ee,c as A,d as B,i as be,F as Fe,r as y,al as ye,n as we,H as ke,m as re,A as Se}from"./app-CUKgmgkQ.js";import{D as De}from"./index-3SaTkLKc.js";import{i as V,o as Re,M as Ce,A as _e}from"./App-CvOoorjt.js";import{u as G}from"./useMediaQuery-D1T4P2tz.js";import{F as L}from"./DocumentIcon-H6SY8Apv.js";import{F as Z}from"./ClockIcon-C7Qz8x4a.js";import{F as ie}from"./CheckCircleIcon-BTkUkVsG.js";import{F as le,D as Ie,a as $e,b as We,u as E,w as Ee}from"./xlsx-E9qOGhgt.js";import{F as ne}from"./CalendarDaysIcon-BYBK8ahe.js";import{F as M,c as Me}from"./PlusIcon-B8O-76eD.js";import{F as oe}from"./BuildingOfficeIcon-CH8PKk1B.js";import{F as te}from"./MapPinIcon-BCZPO731.js";import{F as se}from"./CheckCircleIcon-BtkCgu8m.js";import{c as _,t as Ye,a as Pe,b as Ae}from"./chunk-F3UDT23P-B6ABEQDZ.js";import{p as T}from"./chunk-VFIJPDYX-B2KMTkmj.js";import{a as K,s as de}from"./chunk-C3QHEOC2-CBY11Hc6.js";import{t as Be,a as ze}from"./chunk-YRZGWF2W-Bx4wDt5g.js";import{d as ce}from"./chunk-IHO36JMK-Da6CysX7.js";import{s as O}from"./chunk-P7ACKWSP-DvoyYz7N.js";import{S as Le}from"./StatsCards-BnMhrAku.js";import{s as U}from"./toastUtils-BCw-PFPF.js";import{F as Te}from"./InformationCircleIcon-BJy93gUz.js";import{m as Oe,a as Ve,b as Ge,c as qe}from"./chunk-TW2E3XVA-COE9AJJ7.js";import{r as me,a as xe}from"./chunk-AEQOEFWT-CImN4brK.js";import{c as He}from"./chunk-7LVYGA7G-DMquV4fB.js";import{c as Ue}from"./chunk-PMMJMDBI-BZw8GU_o.js";import{m as Qe}from"./chunk-5LXTSPS7-CZ21ezR9.js";import{d as F}from"./dayjs.min-EDeHxeHl.js";import{F as Je}from"./UserIcon-8pNwIG1U.js";import{c as Xe}from"./chunk-C6WKGNND-Cd99O2LG.js";import{b as Ze}from"./chunk-57V4RE7B-DLR7aw0M.js";import{i as ue}from"./chunk-SQIAVXJX-BSDoHEaZ.js";import{l as pe}from"./chunk-Y5DMIIWQ-QT1gUwpI.js";import"./app-C-p_Tn8z.js";import"./index-Dzu-b3U6.js";/* empty css                      */import"./chunk-CV4BWJDJ-BhkohVh_.js";import"./index-Ci2maQVh.js";import"./index-NVAh7aiH.js";import"./Cog6ToothIcon-Bd2U0cAU.js";import"./GlobeAltIcon-DWEN_FH4.js";import"./useBranding-pYw2Hzzv.js";import"./useDialog-DySdyj_3.js";import"./VisuallyHidden-CHV9OSia.js";import"./keyboard-DlCYvvGr.js";import"./useLabels-BrQlrx-g.js";import"./index-cKZ86Ybs.js";import"./XMarkIcon-D9mnutVy.js";import"./MagnifyingGlassIcon-Cas8aWJF.js";import"./chunk-AUA5GDXN-C46Yqs3E.js";import"./chunk-WQVQ7P2I-BPjo0fU9.js";import"./number-CB4zbwAz.js";import"./chunk-LGMZDQT5-BUrMXbuP.js";import"./ShieldCheckIcon-BLPk1DHg.js";import"./AcademicCapIcon-oebKVwHX.js";import"./IdentificationIcon-C8gDKdht.js";import"./ArrowLeftIcon-Dj3RuXoT.js";import"./ArrowRightIcon-BJjTlz_O.js";import"./BriefcaseIcon-Bgg5MBD1.js";import"./CalendarIcon-Csr73T5I.js";import"./CircleStackIcon-BW9xW7cx.js";import"./ClipboardDocumentCheckIcon-DWTU-LPH.js";import"./DeviceTabletIcon-ymOs6GC-.js";import"./CpuChipIcon-mcbXnAg0.js";import"./CurrencyDollarIcon-CnTYtBXi.js";import"./DevicePhoneMobileIcon-BGVJ6NhH.js";import"./DocumentArrowUpIcon-i_-dGzbv.js";import"./EnvelopeIcon-F7b6B4-f.js";import"./EyeIcon-BkMrBF9T.js";import"./KeyIcon-B79OyKRq.js";import"./LockClosedIcon-HF4CRMyG.js";import"./PlusCircleIcon-DZoA9ZJ-.js";import"./PrinterIcon-o8fN_3io.js";import"./UserCircleIcon-CZfyut7Z.js";import"./UserGroupIcon-BOh_uzO9.js";import"./useHasTabbableChild-CGrbfQoB.js";import"./useSelectableItem-l0pHZh0p.js";import"./SelectionManager-B6ixbygR.js";import"./Item-Bua0SRf7.js";import"./MaintenanceModeBanner-C_ymobah.js";import"./createLucideIcon-b5_43sro.js";import"./index-DFJtv7Cd.js";import"./useTreeState-CSPYaXmS.js";import"./useMenuTriggerState-B-lXHpyB.js";import"./chunk-7F3ZLNJ6-DjpfC3pM.js";import"./index-9IyGFsSn.js";import"./useProgressBar-BqcTySXo.js";import"./useLabel-BCvojCgc.js";import"./useNumberFormatter-C5aclKXe.js";import"./NumberFormatter-DNR9MAW-.js";import"./chunk-KQW2TNLT-BJ9m50sz.js";import"./chunk-ICU6NNET-7RZ9nPEr.js";import"./useToggleState-D0KmqrFs.js";import"./index-4Gv1aAW-.js";const Ke=({filteredData:p,onRefresh:S,loading:w=!1})=>{const{theme:k}=je(),m=G("(max-width: 1024px)"),c=()=>{if(typeof window>"u")return"lg";const t=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12");return t===0?"none":t<=4?"sm":t<=8?"md":t<=16?"lg":"full"},h=()=>e.jsxs("div",{className:"max-h-[84vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-2",children:[e.jsx(O,{className:"w-32 h-6 rounded"}),e.jsx(O,{className:"w-20 h-8 rounded"})]}),e.jsx(K,{className:"max-h-[70vh]",children:e.jsxs("div",{className:"border border-divider rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-default-100/80 backdrop-blur-md border-b border-divider",children:e.jsx("div",{className:"flex",children:$.map((t,s)=>e.jsx("div",{className:"flex-1 p-3",children:e.jsx(O,{className:"w-20 h-4 rounded"})},s))})}),e.jsx("div",{className:"divide-y divide-divider",children:Array.from({length:8}).map((t,s)=>e.jsx("div",{className:"flex hover:bg-default-50/50 transition-colors",children:$.map((r,i)=>e.jsx("div",{className:"flex-1 p-3",children:e.jsx(O,{className:"w-full h-4 rounded"})},i))},s))})]})})]}),l=t=>new Date(t).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}),o=t=>t>=100?"success":t>=75?"warning":t>=50?"primary":"danger",x=t=>t>=100?e.jsx(ie,{className:"w-3 h-3"}):t>=50?e.jsx(Z,{className:"w-3 h-3"}):e.jsx(Fe,{className:"w-3 h-3"}),u=(t,s)=>{const r="w-3 h-3",i=s>0?"":"text-gray-400";switch(t?.toLowerCase()){case"embankment":return e.jsx(oe,{className:`${r} text-amber-500 ${i}`});case"structure":return e.jsx(L,{className:`${r} text-blue-500 ${i}`});case"pavement":return e.jsx(te,{className:`${r} text-gray-500 ${i}`});default:return e.jsx(V,{className:`${r} text-primary ${i}`})}},I=({summary:t})=>{const s=t.totalDailyWorks>0?(t.completed/t.totalDailyWorks*100).toFixed(1):0,r=t.rfiSubmissions>0&&t.completed>0?(t.rfiSubmissions/t.completed*100).toFixed(1):0,i=t.totalDailyWorks-t.completed;return e.jsx(A,{className:"mb-2",shadow:"sm",radius:c(),style:{border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(B,{className:"p-3",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"flex items-center gap-3 flex-1",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold text-primary",style:{fontFamily:'var(--fontFamily, "Inter")'},children:l(t.date)}),e.jsxs("span",{className:"text-xs text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[t.totalDailyWorks," total works"]})]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(X,{size:"sm",variant:"flat",color:o(parseFloat(s)),startContent:x(parseFloat(s)),radius:c(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:[s,"%"]})})]}),e.jsx(ce,{className:"my-3"}),e.jsxs("div",{className:"space-y-3 mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Completion Progress"}),e.jsxs("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[t.completed,"/",t.totalDailyWorks]})]}),e.jsx(T,{value:parseFloat(s),color:o(parseFloat(s)),size:"sm",radius:c(),className:"w-full","aria-label":`Completion progress: ${s}%`})]}),t.rfiSubmissions>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"RFI Submission"}),e.jsxs("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[t.rfiSubmissions,"/",t.completed]})]}),e.jsx(T,{value:parseFloat(r),color:o(parseFloat(r)),size:"sm",radius:c(),className:"w-full","aria-label":`RFI submission progress: ${r}%`})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[u("embankment",t.embankment),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Embankment"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:t.embankment})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[u("structure",t.structure),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Structure"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:t.structure})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[u("pavement",t.pavement),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Pavement"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:t.pavement})]})]}),e.jsx(ce,{className:"my-3"}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{className:"w-3 h-3 text-warning"}),e.jsxs("span",{style:{fontFamily:'var(--fontFamily, "Inter")'},children:["Resubmissions: ",t.resubmissions]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-3 h-3 text-danger"}),e.jsxs("span",{style:{fontFamily:'var(--fontFamily, "Inter")'},children:["Pending: ",i]})]})]})]})})},D=Ne.useCallback((t,s)=>{const r=t.totalDailyWorks>0?(t.completed/t.totalDailyWorks*100).toFixed(1):0,i=t.rfiSubmissions>0&&t.completed>0?(t.rfiSubmissions/t.completed*100).toFixed(1):0,f=t.totalDailyWorks-t.completed;switch(s){case"date":return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ne,{className:"w-3 h-3 text-default-500"}),e.jsx("span",{className:"text-sm font-medium",children:l(t.date)})]})});case"totalDailyWorks":return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(V,{className:"w-3 h-3 text-primary"}),e.jsx("span",{className:"text-sm font-bold",children:t.totalDailyWorks})]})});case"resubmissions":return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{className:"w-3 h-3 text-warning"}),e.jsx("span",{className:"text-sm",children:t.resubmissions})]})});case"embankment":case"structure":case"pavement":return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[u(s,t[s]),e.jsx("span",{className:"text-sm",children:t[s]})]})});case"completed":return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"w-3 h-3 text-success"}),e.jsx("span",{className:"text-sm font-medium text-success",children:t.completed})]})});case"pending":return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-3 h-3 text-danger"}),e.jsx("span",{className:"text-sm font-medium text-danger",children:f})]})});case"completionPercentage":return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{value:parseFloat(r),color:o(parseFloat(r)),size:"sm",className:"flex-1 min-w-[80px]","aria-label":`Daily work completion: ${r}%`}),e.jsxs(X,{size:"sm",variant:"flat",color:o(parseFloat(r)),startContent:x(parseFloat(r)),children:[r,"%"]})]})});case"rfiSubmissions":return e.jsx(_,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"w-3 h-3 text-info"}),e.jsx("span",{className:"text-sm",children:t.rfiSubmissions})]})});case"rfiSubmissionPercentage":return e.jsx(_,{children:e.jsx("div",{className:"flex items-center gap-2",children:t.rfiSubmissions>0?e.jsxs(e.Fragment,{children:[e.jsx(T,{value:parseFloat(i),color:o(parseFloat(i)),size:"sm",className:"flex-1 min-w-[80px]","aria-label":`RFI submission percentage: ${i}%`}),e.jsxs(X,{size:"sm",variant:"flat",color:o(parseFloat(i)),startContent:x(parseFloat(i)),children:[i,"%"]})]}):e.jsx("span",{className:"text-sm text-default-400",children:"-"})})});default:return e.jsx(_,{children:t[s]})}},[]),$=[{name:"Date",uid:"date",icon:ne},{name:"Total Daily Works",uid:"totalDailyWorks",icon:V},{name:"Resubmissions",uid:"resubmissions",icon:ee},{name:"Embankment",uid:"embankment",icon:oe},{name:"Structure",uid:"structure",icon:L},{name:"Pavement",uid:"pavement",icon:te},{name:"Completed",uid:"completed",icon:se},{name:"Pending",uid:"pending",icon:be},{name:"Completion %",uid:"completionPercentage",icon:M},{name:"RFI Submissions",uid:"rfiSubmissions",icon:L},{name:"RFI Submission %",uid:"rfiSubmissionPercentage",icon:M}];return m?e.jsxs("div",{className:"space-y-4",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[S&&e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(P,{size:"sm",variant:"bordered",color:"primary",radius:c(),startContent:e.jsx(ee,{className:"w-4 h-4"}),onPress:S,"aria-label":"Refresh daily work summary table",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:"Refresh Summary"})}),e.jsx(K,{className:"max-h-[70vh]",children:p?.length>0?p.map((t,s)=>e.jsx(I,{summary:t},s)):e.jsx(A,{className:"text-center py-8",radius:c(),style:{border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(B,{children:[e.jsx(M,{className:"w-12 h-12 text-default-300 mb-4 mx-auto"}),e.jsx("h6",{className:"text-lg font-semibold text-default-600 mb-2",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"No summary data found"}),e.jsx("p",{className:"text-sm text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"No work summary available for the selected period"})]})})})]}):w?e.jsx(h,{}):e.jsx("div",{className:"max-h-[84vh] overflow-y-auto",children:e.jsx(K,{className:"max-h-[70vh]",children:e.jsxs(Ye,{selectionMode:"none",isCompact:!0,removeWrapper:!0,isStriped:!0,"aria-label":"Daily Work Summary Table",isHeaderSticky:!0,radius:c(),classNames:{base:"max-h-[520px] overflow-auto",table:"min-h-[200px] w-full",thead:"z-10",tbody:"overflow-y-auto",th:"bg-default-100 text-default-700 font-semibold",td:"text-default-600"},style:{borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(Be,{columns:$,children:t=>e.jsx(ze,{align:t.uid==="date"?"start":"center",className:`bg-default-100/80 backdrop-blur-md ${t.width||""}`,style:{minWidth:t.uid==="date"?"128px":t.uid==="incharge"?"192px":"auto"},children:e.jsxs("div",{className:`flex items-center gap-1 ${t.uid==="date"?"justify-start":"justify-center"}`,children:[t.icon&&e.jsx(t.icon,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs font-semibold",children:t.name})]})},t.uid)}),e.jsx(Pe,{items:p||[],emptyContent:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(M,{className:"w-12 h-12 text-default-300 mb-4"}),e.jsx("h6",{className:"text-lg font-medium text-default-600",children:"No summary data found"}),e.jsx("span",{className:"text-sm text-default-500",children:"No work summary available for the selected period"})]}),children:t=>e.jsx(Ae,{children:s=>D(t,s)},t.date)})]})})})},et=({open:p,closeModal:S,filteredData:w=[],inCharges:k=[]})=>{const[m,c]=y.useState({format:"excel",columns:["date","totalDailyWorks","completed","pending","completionPercentage","rfiSubmissions","embankment","structure","pavement","resubmissions"],includeCharts:!1,groupBy:"date"}),[h,l]=y.useState(!1),o=[{key:"excel",label:"Excel (.xlsx)",description:"Comprehensive spreadsheet with summary data",icon:e.jsx($e,{size:20,className:"text-green-600"})},{key:"csv",label:"CSV (.csv)",description:"Simple comma-separated values",icon:e.jsx(We,{size:20,className:"text-blue-600"})}],x=[{key:"date",label:"Date",description:"Summary date"},{key:"totalDailyWorks",label:"Total Works",description:"Total number of daily works"},{key:"completed",label:"Completed",description:"Number of completed works"},{key:"pending",label:"Pending",description:"Number of pending works"},{key:"completionPercentage",label:"Completion %",description:"Completion percentage"},{key:"rfiSubmissions",label:"RFI Submissions",description:"Number of RFI submissions"},{key:"rfiSubmissionPercentage",label:"RFI Submission %",description:"RFI submission percentage"},{key:"embankment",label:"Embankment Works",description:"Number of embankment works"},{key:"structure",label:"Structure Works",description:"Number of structure works"},{key:"pavement",label:"Pavement Works",description:"Number of pavement works"},{key:"resubmissions",label:"Resubmissions",description:"Number of resubmissions"}],u=[{key:"date",label:"By Date",description:"Group summary by date"},{key:"type",label:"By Type",description:"Group summary by work type"},{key:"overall",label:"Overall Summary",description:"Single overall summary"}],I=async()=>{l(!0);try{let s=D();const r=`daily_work_summary_${new Date().toISOString().split("T")[0]}`;switch(m.format){case"excel":$(s,r);break;case"csv":t(s,r);break}U.success(`Successfully exported ${s.length} summary records`,{icon:e.jsx(se,{className:"w-5 h-5"})}),S()}catch(s){U.error("Export failed: "+s.message)}finally{l(!1)}},D=()=>{let s=[...w];if(m.groupBy==="overall"){const r=s.reduce((n,g)=>n+g.totalDailyWorks,0),i=s.reduce((n,g)=>n+g.completed,0),f=s.reduce((n,g)=>n+g.rfiSubmissions,0),v=s.reduce((n,g)=>n+g.embankment,0),d=s.reduce((n,g)=>n+g.structure,0),R=s.reduce((n,g)=>n+g.pavement,0),W=s.reduce((n,g)=>n+g.resubmissions,0);s=[{date:"Overall Summary",totalDailyWorks:r,completed:i,pending:r-i,completionPercentage:r>0?(i/r*100).toFixed(1)+"%":"0%",rfiSubmissions:f,rfiSubmissionPercentage:r>0?(f/r*100).toFixed(1)+"%":"0%",embankment:v,structure:d,pavement:R,resubmissions:W}]}else if(m.groupBy==="type"){const r=s.reduce((i,f)=>(["embankment","structure","pavement"].forEach(v=>{f[v]>0&&(i[v]||(i[v]={type:v.charAt(0).toUpperCase()+v.slice(1),totalWorks:0,dates:[]}),i[v].totalWorks+=f[v],i[v].dates.push(f.date))}),i),{});s=Object.values(r).map(i=>({type:i.type,totalWorks:i.totalWorks,dateRange:`${Math.min(...i.dates)} to ${Math.max(...i.dates)}`,dateCount:i.dates.length}))}return s.map(r=>{const i={};return m.columns.forEach(f=>{if(r.hasOwnProperty(f)){const v=x.find(d=>d.key===f)?.label||f;i[v]=r[f]}}),i})},$=(s,r)=>{const i=E.json_to_sheet(s),f=E.book_new();E.book_append_sheet(f,i,"Summary");const v=Object.keys(s[0]||{}).map(()=>({wch:20}));i["!cols"]=v;const d=E.decode_range(i["!ref"]);for(let R=d.s.c;R<=d.e.c;R++){const W=E.encode_cell({r:0,c:R});i[W]&&(i[W].s={font:{bold:!0},fill:{fgColor:{rgb:"CCCCCC"}}})}Ee(f,`${r}.xlsx`)},t=(s,r)=>{const i=E.json_to_sheet(s),f=E.sheet_to_csv(i),v=new Blob([f],{type:"text/csv;charset=utf-8;"}),d=document.createElement("a"),R=URL.createObjectURL(v);d.setAttribute("href",R),d.setAttribute("download",`${r}.csv`),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d)};return e.jsx(Oe,{isOpen:p,onClose:S,size:"3xl",scrollBehavior:"inside",classNames:{base:"backdrop-blur-md",backdrop:"bg-black/50 backdrop-blur-sm"},children:e.jsxs(Ve,{children:[e.jsxs(Ge,{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-6 h-6 text-primary"}),e.jsx("span",{children:"Export Daily Work Summary"})]}),e.jsx("p",{className:"text-sm text-default-500 font-normal",children:"Export summary data with customizable grouping and format options"})]}),e.jsx(qe,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(A,{className:"bg-default-50",children:e.jsxs(B,{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Export Format"}),e.jsx(me,{value:m.format,onValueChange:s=>c(r=>({...r,format:s})),orientation:"horizontal",children:o.map(s=>e.jsx(xe,{value:s.key,children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.icon,e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.label}),e.jsx("div",{className:"text-xs text-default-500",children:s.description})]})]})},s.key))})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Grouping & Summary"}),e.jsx(me,{value:m.groupBy,onValueChange:s=>c(r=>({...r,groupBy:s})),children:u.map(s=>e.jsx(xe,{value:s.key,children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.label}),e.jsx("div",{className:"text-xs text-default-500",children:s.description})]})},s.key))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Columns to Export"}),e.jsx(He,{value:m.columns,onValueChange:s=>c(r=>({...r,columns:s})),children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:x.map(s=>e.jsx(Ue,{value:s.key,children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.label}),e.jsx("div",{className:"text-xs text-default-500",children:s.description})]})},s.key))})})]}),e.jsx(A,{className:"bg-primary-50 border-primary-200",children:e.jsx(B,{children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Te,{className:"w-5 h-5 text-primary-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-primary-900",children:"Export Summary"}),e.jsxs("div",{className:"text-sm text-primary-700 space-y-1",children:[e.jsxs("p",{children:["• Format: ",o.find(s=>s.key===m.format)?.label]}),e.jsxs("p",{children:["• Grouping: ",u.find(s=>s.key===m.groupBy)?.label]}),e.jsxs("p",{children:["• Columns: ",m.columns.length," selected"]}),e.jsxs("p",{children:["• Records: ",w.length," summary entries"]})]})]})]})})})]})}),e.jsxs(Qe,{children:[e.jsx(P,{variant:"light",onPress:S,isDisabled:h,children:"Cancel"}),e.jsx(P,{color:"primary",onPress:I,isLoading:h,startContent:!h&&e.jsx(Ie,{size:16}),isDisabled:m.columns.length===0,children:h?"Exporting...":"Export Summary"})]})]})})};var q={exports:{}},tt=q.exports,fe;function st(){return fe||(fe=1,(function(p,S){(function(w,k){p.exports=k()})(tt,(function(){return function(w,k,m){var c=function(h,l){if(!l||!l.length||l.length===1&&!l[0]||l.length===1&&Array.isArray(l[0])&&!l[0].length)return null;var o;l.length===1&&l[0].length>0&&(l=l[0]),o=(l=l.filter((function(u){return u})))[0];for(var x=1;x<l.length;x+=1)l[x].isValid()&&!l[x][h](o)||(o=l[x]);return o};m.max=function(){var h=[].slice.call(arguments,0);return c("isAfter",h)},m.min=function(){var h=[].slice.call(arguments,0);return c("isBefore",h)}}}))})(q)),q.exports}var at=st();const rt=ye(at);var H={exports:{}},it=H.exports,he;function lt(){return he||(he=1,(function(p,S){(function(w,k){p.exports=k()})(it,(function(){return function(w,k,m){k.prototype.isBetween=function(c,h,l,o){var x=m(c),u=m(h),I=(o=o||"()")[0]==="(",D=o[1]===")";return(I?this.isAfter(x,l):!this.isBefore(x,l))&&(D?this.isBefore(u,l):!this.isAfter(u,l))||(I?this.isBefore(x,l):!this.isAfter(x,l))&&(D?this.isAfter(u,l):!this.isBefore(u,l))}}}))})(H)),H.exports}var nt=lt();const ot=ye(nt);F.extend(rt);F.extend(ot);const dt=({auth:p,title:S,summary:w,jurisdictions:k,inCharges:m})=>{const c=G("(min-width: 1025px)"),h=G("(min-width: 641px) and (max-width: 1024px)"),l=G("(max-width: 640px)"),o=()=>{if(typeof window>"u")return"lg";const b=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12px",N=parseInt(b);return N===0?"none":N<=4?"sm":N<=8?"md":N<=16?"lg":"full"},[x]=y.useState(w),[u,I]=y.useState(w),[D,$]=y.useState(!1),[t,s]=y.useState(null),[r,i]=y.useState(!1),f=y.useCallback(a=>{s(a)},[]),v=y.useCallback(()=>{s(null)},[]),d=y.useMemo(()=>!x||x.length===0?[]:x.map(a=>F(a.date)).filter(a=>a.isValid()),[x]),R=y.useCallback((a,b,N,Q="name")=>{if(!a||a.length===0)return e.jsx("span",{className:"text-default-400 text-xs",children:N});const J=a.map(String),C=b?.filter(j=>J.includes(String(j.id))).map(j=>j[Q])??[];return C.length===0?e.jsx("span",{className:"text-default-400 text-xs",children:N}):e.jsx("div",{className:"flex flex-wrap gap-1",children:C.map(j=>e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-primary/10 text-primary",children:j},j))})},[]),W=y.useMemo(()=>k?.map(a=>({...a,displayLabel:`${a.start_chainage} - ${a.end_chainage}`}))??[],[k]),[n,g]=y.useState({startDate:d.length>0?F.min(...d).format("YYYY-MM-DD"):F().subtract(30,"days").format("YYYY-MM-DD"),endDate:d.length>0?F.max(...d).format("YYYY-MM-DD"):F().format("YYYY-MM-DD"),status:"all",incharge:[],jurisdiction:[]}),z=y.useCallback(async()=>{$(!0);try{const a={startDate:n.startDate,endDate:n.endDate};n.incharge?.length&&(a.incharge=n.incharge),n.jurisdiction?.length&&(a.jurisdiction=n.jurisdiction);const N=(await we.post(De("daily-works-summary.filter"),a)).data?.summaries??[];return I(N),!0}catch(a){console.error("Failed to load filtered summary:",a);const b=a.response?.data?.error||"Failed to load summary data";return U.error(b),!1}finally{$(!1)}},[n]),ae=y.useCallback(async()=>{await z()&&U.success("Summary data refreshed successfully")},[z]),Y=y.useCallback((a,b)=>{g(N=>({...N,[a]:b}))},[]),ve=y.useMemo(()=>{const a=u.reduce((C,j)=>C+j.totalDailyWorks,0),b=u.reduce((C,j)=>C+j.completed,0),N=u.reduce((C,j)=>C+j.pending,0),Q=u.reduce((C,j)=>C+j.rfiSubmissions,0),J=a>0?(b/a*100).toFixed(1):0;return[{title:"Total Works",value:a,icon:e.jsx(M,{className:"w-5 h-5"}),color:"text-blue-600",description:"All logged works"},{title:"Completed",value:b,icon:e.jsx(se,{className:"w-5 h-5"}),color:"text-green-600",description:`${J}% completion rate`},{title:"Pending",value:N,icon:e.jsx(be,{className:"w-5 h-5"}),color:"text-orange-600",description:"In progress"},{title:"RFI Submissions",value:Q,icon:e.jsx(V,{className:"w-5 h-5"}),color:"text-purple-600",description:"Ready for inspection"}]},[u]),ge=[{label:"Refresh",icon:e.jsx(ee,{className:"w-4 h-4"}),variant:"flat",color:"primary",onPress:ae,isLoading:D,className:"bg-linear-to-r from-blue-500/20 to-cyan-500/20 hover:from-blue-500/30 hover:to-cyan-500/30",ariaLabel:"Refresh daily work summary data"},...p.roles.includes("Administrator")||p.designation==="Supervision Engineer"?[{label:"Export",icon:e.jsx(Re,{className:"w-4 h-4"}),variant:"flat",color:"success",onPress:()=>f("exportDailyWorkSummary"),className:"bg-linear-to-r from-green-500/20 to-emerald-500/20 hover:from-green-500/30 hover:to-emerald-500/30",ariaLabel:"Export daily work summary data"}]:[]];return y.useEffect(()=>{d.length>0&&(!n.startDate||!n.endDate)&&g(a=>({...a,startDate:F.min(...d).format("YYYY-MM-DD"),endDate:F.max(...d).format("YYYY-MM-DD")}))},[d]),y.useEffect(()=>{z()},[z]),e.jsxs(e.Fragment,{children:[e.jsx(ke,{title:S}),t==="exportDailyWorkSummary"&&e.jsx(et,{open:t==="exportDailyWorkSummary",closeModal:v,filteredData:u,inCharges:m}),e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(re.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full max-w-[2000px]",children:e.jsxs(A,{className:"transition-all duration-200",radius:o(),style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))",background:`linear-gradient(135deg, 
                                var(--theme-content1, #FAFAFA) 20%, 
                                var(--theme-content2, #F4F4F5) 10%, 
                                var(--theme-content3, #F1F3F4) 20%)`},children:[e.jsx(Xe,{className:"border-b p-0",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                    color-mix(in srgb, var(--theme-content1) 50%, transparent) 20%, 
                                    color-mix(in srgb, var(--theme-content2) 30%, transparent) 10%)`},children:e.jsx("div",{className:`${c?"p-6":h?"p-4":"p-3"} w-full`,children:e.jsx("div",{className:"flex flex-col space-y-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsx("div",{className:`
                                                    ${c?"p-3":h?"p-2.5":"p-2"} 
                                                    rounded-xl flex items-center justify-center
                                                `,style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsx(M,{className:`
                                                        ${c?"w-8 h-8":h?"w-6 h-6":"w-5 h-5"}
                                                    `,style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:`
                                                        ${c?"text-2xl":h?"text-xl":"text-lg"}
                                                        font-bold text-foreground
                                                        ${c?"":"truncate"}
                                                    `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Daily Work Summary"}),e.jsx("p",{className:`
                                                        ${c?"text-sm":"text-xs"} 
                                                        text-default-500
                                                        ${c?"":"truncate"}
                                                    `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Overview of daily work statistics and progress"})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{className:"flex items-center gap-2",children:ge.map((a,b)=>e.jsx(P,{size:c?"md":"sm",variant:a.variant||"flat",color:a.color||"primary",startContent:a.icon,onPress:a.onPress,isLoading:a.isLoading,className:`${a.className||""} font-medium`,radius:o(),"aria-label":a.ariaLabel||a.label,style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)"},children:a.label},b))})})]})})})}),e.jsxs(B,{className:"pt-6",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(Le,{stats:ve,isLoading:D}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5 text-default-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Quick Filters:"})]}),e.jsx("div",{className:"flex gap-2 items-end",children:e.jsx(Ze,{variant:"bordered",radius:o(),className:"bg-white/5",children:e.jsxs(P,{isIconOnly:l,color:r?"primary":"default",onPress:()=>i(!r),className:r?"bg-primary/20":"bg-white/5","aria-label":r?"Hide advanced filters":"Show advanced filters",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(Ce,{className:"w-4 h-4"}),!l&&e.jsx("span",{className:"ml-1",children:"Advanced Filters"})]})})})]}),e.jsx(Se,{children:r&&e.jsx(re.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx("div",{className:"p-4 bg-white/5 backdrop-blur-md rounded-lg border border-white/10",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(ue,{type:"date",label:"Start Date",value:n.startDate,onChange:a=>Y("startDate",a.target.value),size:"sm",variant:"bordered",radius:o(),"aria-label":"Select start date",classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                                             focus-within:bg-content2/90 border-divider/50 
                                                                             hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'}}),e.jsx(ue,{type:"date",label:"End Date",value:n.endDate,onChange:a=>Y("endDate",a.target.value),size:"sm",variant:"bordered",radius:o(),"aria-label":"Select end date",classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                                             focus-within:bg-content2/90 border-divider/50 
                                                                             hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'}}),(p.roles.includes("Administrator")||p.roles.includes("Super Administrator")||p.designation==="Supervision Engineer")&&e.jsx(de,{label:"In Charge",placeholder:"Select in charge...",selectionMode:"multiple",selectedKeys:new Set(n.incharge||[]),onSelectionChange:a=>{const b=Array.from(a);Y("incharge",b),b.length>0&&Y("jurisdiction",[])},variant:"bordered",size:"sm",radius:o(),startContent:e.jsx(Je,{className:"w-4 h-4 text-default-400"}),classNames:{trigger:"text-sm min-h-unit-10",value:"text-foreground",listboxWrapper:"bg-content1",popoverContent:"bg-content1"},renderValue:()=>R(n.incharge,m,"Select in charge..."),style:{fontFamily:'var(--fontFamily, "Inter")'},"aria-label":"Filter by in charge",children:m.map(a=>e.jsx(pe,{value:String(a.id),children:a.name},String(a.id)))}),(p.roles.includes("Administrator")||p.roles.includes("Super Administrator")||p.designation==="Supervision Engineer")&&e.jsx(de,{label:"Jurisdiction",placeholder:"Select jurisdiction...",selectionMode:"multiple",selectedKeys:new Set(n.jurisdiction||[]),onSelectionChange:a=>{const b=Array.from(a);Y("jurisdiction",b),b.length>0&&Y("incharge",[])},variant:"bordered",size:"sm",radius:o(),startContent:e.jsx(te,{className:"w-4 h-4 text-default-400"}),classNames:{trigger:"text-sm min-h-unit-10",value:"text-foreground",listboxWrapper:"bg-content1",popoverContent:"bg-content1"},renderValue:()=>R(n.jurisdiction,W,"Select jurisdiction...","displayLabel"),style:{fontFamily:'var(--fontFamily, "Inter")'},"aria-label":"Filter by jurisdiction",children:W?.map(a=>e.jsx(pe,{value:String(a.id),children:a.displayLabel},String(a.id)))}),e.jsx("div",{className:"flex items-end",children:e.jsx(P,{size:"sm",variant:"flat",color:"danger",onPress:()=>{g({startDate:d.length>0?F.min(...d).format("YYYY-MM-DD"):F().subtract(30,"days").format("YYYY-MM-DD"),endDate:d.length>0?F.max(...d).format("YYYY-MM-DD"):F().format("YYYY-MM-DD"),status:"all",incharge:[],jurisdiction:[]})},style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Clear Filters"})})]})})})})]})}),e.jsx(A,{radius:o(),className:"bg-content1/80 backdrop-blur-md border border-divider/20",style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)",border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                        color-mix(in srgb, var(--theme-content1) 90%, transparent) 20%, 
                                        color-mix(in srgb, var(--theme-content2) 60%, transparent) 10%)`},children:e.jsx(B,{className:"p-0",style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsx(Ke,{filteredData:u,onRefresh:ae,loading:D})})})]})]})})})]})};dt.layout=p=>e.jsx(_e,{children:p});export{dt as default};
