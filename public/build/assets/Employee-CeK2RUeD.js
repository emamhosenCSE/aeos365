import{o as le,r as a,n as ee,j as e,i as m,F as O,c as B,b as K,d as G,s as oe,m as ie,k as J,e as z,R as ce,H as de}from"./app-B1idACz3.js";import{ay as me,x as ue,az as te,a0 as se,R as ae,t as xe,f as re,ar as he,A as pe}from"./App-BxA45E4t.js";import{S as fe}from"./StatsCards-BcTb12h8.js";import{d as v}from"./dayjs.min-BD2CMXby.js";import{u as ne}from"./useMediaQuery-oujQjmbJ.js";import{F as T}from"./CalendarDaysIcon-CPIWRTu0.js";import{c as M,t as ge,a as je,b as be}from"./chunk-F3UDT23P-C-ho-l6F.js";import{a as ve}from"./chunk-C3QHEOC2-tt4DAwFy.js";import{s as Ne}from"./chunk-P7ACKWSP-5o7fRwLF.js";import{t as ye,a as we}from"./chunk-YRZGWF2W-DSN9j3G1.js";import{p as Me}from"./chunk-NL7EUJG2-aTLCznnI.js";import{F as X}from"./CheckCircleIcon-znT6UY48.js";import{c as Z}from"./chunk-C6WKGNND-DYIi9UqF.js";import{d as Q}from"./chunk-IHO36JMK-_QcGGA4V.js";import{t as Fe}from"./chunk-AUA5GDXN-Dy7XAS6o.js";import{F as _e}from"./UserIcon-1qA6iUQn.js";import{F as Se}from"./PlusIcon-B7YJbjTI.js";import{i as De}from"./chunk-SQIAVXJX-BmeQe73H.js";import"./app-BmhO9GrS.js";import"./index-B22Xm-65.js";/* empty css                      */import"./toastUtils-CW5B8m6C.js";import"./chunk-CV4BWJDJ-BFly1wX0.js";import"./index-CaNeU5V8.js";import"./index-BvevyAVm.js";import"./Cog6ToothIcon-BTkQVx_H.js";import"./GlobeAltIcon-BXsgRUBL.js";import"./useBranding-BpzGYNdv.js";import"./useDialog-Ch8oEuGx.js";import"./VisuallyHidden-8dXxwzFE.js";import"./keyboard-Ct-gpNNq.js";import"./useLabels-xtEGP3rr.js";import"./index-BvG5LGgQ.js";import"./XMarkIcon-BkS9W9l-.js";import"./MagnifyingGlassIcon-DgboSUq1.js";import"./ShieldCheckIcon-BVzIZ77z.js";import"./AcademicCapIcon-QvlhCYpE.js";import"./IdentificationIcon-CvziX476.js";import"./ArrowLeftIcon-B39h7gxR.js";import"./ArrowRightIcon-DyVdpuyc.js";import"./BriefcaseIcon-CtncUTGk.js";import"./BuildingOfficeIcon-DRKs9y4o.js";import"./CalendarIcon-DXmDQodP.js";import"./CircleStackIcon-DdzMQ0P3.js";import"./ClipboardDocumentCheckIcon-DRpcDtD7.js";import"./DeviceTabletIcon--UjnqdVT.js";import"./CpuChipIcon-Czc12K36.js";import"./CurrencyDollarIcon-nhXxeFAs.js";import"./DevicePhoneMobileIcon-BEyIwQb0.js";import"./DocumentArrowUpIcon-1h0_t1N_.js";import"./DocumentIcon-CZnboGRP.js";import"./EnvelopeIcon-B0z_TX9R.js";import"./EyeIcon-Cqrke5l0.js";import"./InformationCircleIcon-DqlZzEsT.js";import"./KeyIcon-EZeCAT5w.js";import"./LockClosedIcon-D4pmCoEC.js";import"./MapPinIcon-CvRrNoqN.js";import"./PlusCircleIcon-ChwrtP31.js";import"./PrinterIcon-BAYK2vO7.js";import"./UserCircleIcon-BluwysQc.js";import"./UserGroupIcon-C2aGroqx.js";import"./chunk-TW2E3XVA-DozWYklk.js";import"./useHasTabbableChild-D7clvTMF.js";import"./chunk-LGMZDQT5-BFW_lSqD.js";import"./useSelectableItem-2B3SBj_3.js";import"./SelectionManager-CcfpIYkh.js";import"./chunk-Y5DMIIWQ-CwpVnCx_.js";import"./Item-C3GqwNyW.js";import"./useLabel-BWLgnRON.js";import"./index-BsK0-JqV.js";import"./index-BMFea15Y.js";import"./MaintenanceModeBanner-BuwtjklV.js";import"./chunk-PMMJMDBI-B-BWMVyO.js";import"./useToggleState-DFwZ_RpM.js";import"./chunk-ICU6NNET-CXrsm0Bw.js";import"./index-CcVAKcbs.js";import"./chunk-7F3ZLNJ6-CMjtQ9ZK.js";import"./chunk-KQW2TNLT-Cz1cLYHm.js";import"./useMenuTriggerState-ZTP0zge5.js";import"./chunk-WQVQ7P2I-BDe9YmDI.js";import"./number-CB4zbwAz.js";import"./chunk-OH2E76JR-ZyB0wyOM.js";import"./useTreeState-D7Kaxu17.js";const Ce=({handleDateChange:N,selectedDate:j,updateTimeSheet:k,externalFilterData:E,externalEmployee:U})=>{const{url:p}=le();ne("(min-width: 1025px)"),ne("(min-width: 641px) and (max-width: 1024px)");const[o,y]=a.useState([]),[w,f]=a.useState(""),[$,A]=a.useState(0),[I,H]=a.useState(0),[F,R]=a.useState(10),[_,c]=a.useState(1),[L,u]=a.useState(U||""),[P,S]=a.useState(!1),x=a.useMemo(()=>E||{currentMonth:v().format("YYYY-MM")},[E]),D=()=>{if(typeof window>"u")return"lg";const h=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12px",n=parseInt(h);return n===0?"none":n<=4?"sm":n<=8?"md":n<=16?"lg":"full"},C=a.useCallback((s,h)=>{if(!s)return null;const n=v(h).format("YYYY-MM-DD");let d;return s.match(/^\d{2}:\d{2}(:\d{2})?$/)?d=v(`${n}T${s}`):d=v(s),d.isValid()?d.format("h:mm A"):"Invalid Time"},[]),t=a.useCallback(async(s=!1)=>{if(!j){S(!0),f("No date selected");return}S(!1),f("");const h=route("getCurrentUserAttendanceForDate");try{const n=await ee.get(h,{params:{page:_,perPage:F,employee:L,date:v(j).format("YYYY-MM-DD"),currentYear:x?.currentMonth?v(x.currentMonth).year():"",currentMonth:x?.currentMonth?v(x.currentMonth).format("MM"):"",_t:s?Date.now():void 0}});n.status===200?(y(n.data.attendances||[]),A(n.data.total||0),H(n.data.last_page||1),n.data.current_page&&c(n.data.current_page),f("")):f(`Unexpected response: ${n.status}`)}catch(n){console.error("Error fetching attendance data:",n),f(n.response?.data?.message||"An error occurred while retrieving attendance data."),y([]),A(0)}finally{S(!0)}},[j,_,F,L,x]);a.useEffect(()=>{t()},[t,k]),a.useEffect(()=>{c(1)},[j,x.currentMonth]);const l=s=>{c(s)},r=[{name:"Date",uid:"date",icon:T,ariaLabel:"Attendance date"},{name:"Clock In",uid:"clockin_time",icon:m,ariaLabel:"All clock in times"},{name:"Clock Out",uid:"clockout_time",icon:m,ariaLabel:"All clock out times"},{name:"Work Hours",uid:"production_time",icon:m,ariaLabel:"Total working hours"},{name:"Punches",uid:"punch_details",icon:m,ariaLabel:"Number of time punches recorded"}],b=a.useCallback((s,h)=>{const n="text-xs sm:text-sm md:text-base whitespace-nowrap",d=v(s.date).isSame(v(),"day");switch(h){case"date":return e.jsx(M,{className:`${n}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-primary shrink-0"}),e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{children:v(s.date).format("MMM D, YYYY")})})]})});case"clockin_time":return e.jsx(M,{className:`${n}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{className:"w-4 h-4 text-success"}),e.jsx("div",{className:"flex flex-col",children:s.punches&&s.punches.length>0?s.punches.filter(g=>g.punch_in).map((g,i)=>e.jsxs("span",{className:"block text-xs",children:[e.jsxs("span",{className:"text-default-400 mr-1",children:[i+1,"."]}),C(g.punch_in,s.date)||"Invalid time"]},i)):e.jsx("span",{children:"Not clocked in"})})]})});case"clockout_time":return e.jsx(M,{className:`${n}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{className:"w-4 h-4 text-danger"}),e.jsx("div",{className:"flex flex-col",children:s.punches&&s.punches.length>0?s.punches.map((g,i)=>e.jsxs("span",{className:"block text-xs",children:[e.jsxs("span",{className:"text-default-400 mr-1",children:[i+1,"."]}),g.punch_out?C(g.punch_out,s.date)||"Invalid time":"No punch out"]},i)):s.punchin_time?e.jsx("span",{children:d?"Currently working":"Missing punch-out"}):e.jsx("span",{children:"Not started"})})]})});case"production_time":const W=s.total_work_minutes>0,V=s.has_incomplete_punch,q=s.punchin_time&&!s.punchout_time&&d;if(W){const g=Math.floor(s.total_work_minutes/60),i=Math.floor(s.total_work_minutes%60);return e.jsx(M,{className:`${n}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{className:`w-4 h-4 ${V?"text-warning":"text-primary"}`}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:`${g}h ${i}m`}),e.jsx("span",{className:"text-xs text-default-500",children:V?"Partial data - in progress":"Total worked time"})]})]})})}else{if(q)return e.jsx(M,{className:`${n}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{className:"w-4 h-4 text-warning"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-warning",children:"In Progress"}),e.jsx("span",{className:"text-xs text-default-500",children:"Currently working"})]})]})});if(s.punchin_time&&!s.punchout_time&&!d)return e.jsx(M,{className:`${n}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4 text-danger"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-danger",children:"Incomplete punch"}),e.jsx("span",{className:"text-xs text-default-500",children:"Missing punch out"})]})]})})}return e.jsx(M,{className:`${n}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4 text-warning"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-warning",children:"No work time"}),e.jsx("span",{className:"text-xs text-default-500",children:"No attendance"})]})]})});case"punch_details":return e.jsx(M,{className:`${n}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{className:"w-4 h-4 text-default-400"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-xs font-medium",children:[s.punch_count||0," punch",(s.punch_count||0)!==1?"es":""]}),s.complete_punches!==s.punch_count&&e.jsxs("span",{className:"text-xs text-warning",children:[s.complete_punches," complete"]}),s.complete_punches===s.punch_count&&s.punch_count>0&&e.jsx("span",{className:"text-xs text-success",children:"All complete"})]})]})});default:return e.jsx(M,{className:`${n}`,children:"N/A"})}},[C]);return e.jsx("div",{role:"region","aria-label":"Attendance data table",className:"w-full",children:w?e.jsx(B,{className:"p-4 transition-all duration-200",style:{background:"color-mix(in srgb, var(--theme-danger, #F31260) 10%, transparent)",borderColor:"color-mix(in srgb, var(--theme-danger, #F31260) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(O,{className:"w-5 h-5",style:{color:"var(--theme-danger)"}}),e.jsx("p",{className:"text-sm",style:{color:"var(--theme-danger)"},children:w})]})}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{orientation:"horizontal",className:"overflow-y-hidden",children:e.jsx(Ne,{className:"rounded-lg",isLoaded:P,children:e.jsxs(ge,{selectionMode:"none",isCompact:!0,removeWrapper:!0,"aria-label":"Employee attendance timesheet table",isHeaderSticky:!0,radius:D(),classNames:{base:"max-h-[520px] overflow-auto",table:"min-h-[200px] w-full",thead:"z-10",tbody:"overflow-y-auto",th:"bg-default-100 text-default-700 font-semibold",td:"text-default-600"},style:{borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(ye,{columns:r,children:s=>e.jsx(we,{align:"start","aria-label":s.ariaLabel||s.name,children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.icon&&e.jsx(s.icon,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:s.name})]})},s.uid)}),e.jsx(je,{items:o,emptyContent:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(m,{className:"w-16 h-16 text-default-300 mb-4"}),e.jsx("h6",{className:"text-lg font-semibold mb-2",children:"No Attendance Records"}),e.jsx("p",{className:"text-default-500",children:"No attendance records found for the selected date"})]}),children:s=>e.jsx(be,{children:h=>b(s,h)},s.id||s.user_id)})]})})}),$>F&&e.jsx("div",{className:"flex justify-center items-center py-4",children:e.jsx(Me,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",variant:"bordered",radius:D(),page:_,total:I,onChange:l,"aria-label":"Timesheet pagination",style:{fontFamily:'var(--fontFamily, "Inter")'}})})]})})},Y=N=>({Present:{bg:"bg-success-100",text:"text-success-700",border:"border-success-300"},Absent:{bg:"bg-danger-100",text:"text-danger-700",border:"border-danger-300"},Late:{bg:"bg-warning-100",text:"text-warning-700",border:"border-warning-300"},Leave:{bg:"bg-primary-100",text:"text-primary-700",border:"border-primary-300"},"Half Day":{bg:"bg-secondary-100",text:"text-secondary-700",border:"border-secondary-300"},Weekend:{bg:"bg-default-100",text:"text-default-500",border:"border-default-200"},Holiday:{bg:"bg-purple-100",text:"text-purple-700",border:"border-purple-300"}})[N]||{bg:"bg-default-50",text:"text-default-400",border:"border-default-100"},ke=({userId:N=null,currentMonth:j=new Date().toISOString().slice(0,7),onDateClick:k=null,showStats:E=!0,compact:U=!1})=>{const[p,o]=a.useState(new Date(j)),[y,w]=a.useState({}),[f,$]=a.useState(!1),[A,I]=a.useState(null),[H,F]=a.useState(null),R=a.useCallback(async()=>{$(!0);try{const t=p.getFullYear(),l=String(p.getMonth()+1).padStart(2,"0"),r=await ee.get(route("attendance.calendar-data"),{params:{user_id:N,year:t,month:l}});r.data.success&&w(r.data.data)}catch(t){console.error("Failed to fetch attendance data:",t)}finally{$(!1)}},[p,N]);a.useEffect(()=>{R()},[R]),a.useEffect(()=>{o(new Date(j))},[j]);const _=a.useMemo(()=>{const t=p.getFullYear(),l=p.getMonth(),r=new Date(t,l,1),s=new Date(t,l+1,0).getDate(),h=r.getDay(),n=new Date(t,l,0).getDate(),d=[];for(let i=h-1;i>=0;i--)d.push({date:n-i,isCurrentMonth:!1,fullDate:new Date(t,l-1,n-i)});const W=[];for(let i=1;i<=s;i++)W.push({date:i,isCurrentMonth:!0,fullDate:new Date(t,l,i)});const q=42-(d.length+W.length),g=[];for(let i=1;i<=q;i++)g.push({date:i,isCurrentMonth:!1,fullDate:new Date(t,l+1,i)});return[...d,...W,...g]},[p]),c=a.useCallback(t=>{if(!t.isCurrentMonth)return null;const l=t.fullDate.getFullYear()+"-"+String(t.fullDate.getMonth()+1).padStart(2,"0")+"-"+String(t.fullDate.getDate()).padStart(2,"0");return y[l]||null},[y]),L=a.useCallback(()=>{o(t=>new Date(t.getFullYear(),t.getMonth()-1,1))},[]),u=a.useCallback(()=>{o(t=>new Date(t.getFullYear(),t.getMonth()+1,1))},[]),P=a.useCallback(()=>{o(new Date)},[]),S=a.useCallback(t=>{if(t.isCurrentMonth&&(I(t.date),k)){const l=t.fullDate.getFullYear()+"-"+String(t.fullDate.getMonth()+1).padStart(2,"0")+"-"+String(t.fullDate.getDate()).padStart(2,"0");k(l,c(t))}},[k,c]),x=a.useMemo(()=>{const t={present:0,absent:0,late:0,leave:0,halfDay:0,weekend:0,holiday:0,total:0};return Object.values(y).forEach(l=>{t.total++;const r=l.status;r==="Present"?t.present++:r==="Absent"?t.absent++:r==="Late"?t.late++:r==="Leave"?t.leave++:r==="Half Day"?t.halfDay++:r==="Weekend"?t.weekend++:r==="Holiday"&&t.holiday++}),t},[y]),D=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],C=p.toLocaleDateString("en-US",{month:"long",year:"numeric"});return e.jsxs(B,{className:"bg-white/5 backdrop-blur-md border-white/10",children:[e.jsxs(Z,{className:"pb-3 flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-6 h-6 text-primary-400"}),e.jsx("h4",{className:"text-lg font-semibold text-foreground",children:"Attendance Calendar"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{isIconOnly:!0,size:"sm",variant:"flat",onPress:L,isDisabled:f,children:e.jsx(me,{className:"w-4 h-4"})}),e.jsx(K,{size:"sm",variant:"flat",onPress:P,isDisabled:f,children:"Today"}),e.jsx(K,{isIconOnly:!0,size:"sm",variant:"flat",onPress:u,isDisabled:f,children:e.jsx(ue,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"w-full",children:e.jsx("p",{className:"text-xl font-bold text-foreground",children:C})})]}),e.jsx(Q,{}),e.jsx(G,{className:"p-4",children:f?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(oe,{size:"lg",color:"primary"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-7 gap-1 mb-4",children:[D.map((t,l)=>e.jsx("div",{className:`text-center text-xs font-semibold py-2 ${l===0||l===6?"text-danger-500":"text-default-600"}`,children:t},t)),_.map((t,l)=>{const r=c(t),b=r?.status||"Unknown",s=Y(b),h=t.isCurrentMonth&&t.date===new Date().getDate()&&p.getMonth()===new Date().getMonth()&&p.getFullYear()===new Date().getFullYear(),n=t.fullDate.getDay()===0||t.fullDate.getDay()===6,d=A===t.date&&t.isCurrentMonth;return e.jsx(Fe,{content:t.isCurrentMonth&&r?e.jsxs("div",{className:"px-2 py-1",children:[e.jsx("p",{className:"text-xs font-semibold",children:b}),r.check_in&&e.jsxs("p",{className:"text-xs",children:["In: ",r.check_in]}),r.check_out&&e.jsxs("p",{className:"text-xs",children:["Out: ",r.check_out]}),r.work_hours&&e.jsxs("p",{className:"text-xs",children:["Hours: ",r.work_hours,"h"]})]}):null,isDisabled:!t.isCurrentMonth||!r,children:e.jsxs(ie.div,{whileHover:{scale:t.isCurrentMonth?1.05:1},whileTap:{scale:t.isCurrentMonth?.95:1},className:`
                                                aspect-square flex flex-col items-center justify-center rounded-lg
                                                transition-all duration-200 cursor-pointer
                                                ${t.isCurrentMonth?"opacity-100":"opacity-30"}
                                                ${t.isCurrentMonth&&r?s.bg:"bg-default-50"}
                                                ${h?"ring-2 ring-primary-500 ring-offset-2":""}
                                                ${d?"ring-2 ring-secondary-500":""}
                                                ${n&&!r?"bg-default-100":""}
                                                hover:shadow-md
                                            `,onClick:()=>S(t),onMouseEnter:()=>F(t.date),onMouseLeave:()=>F(null),children:[e.jsx("span",{className:`
                                                text-sm font-medium
                                                ${t.isCurrentMonth&&r?s.text:"text-default-600"}
                                                ${t.isCurrentMonth?"":"text-default-300"}
                                            `,children:t.date}),t.isCurrentMonth&&r&&e.jsxs("div",{className:"mt-0.5",children:[b==="Present"&&e.jsx(X,{className:"w-3 h-3 text-success-600"}),b==="Absent"&&e.jsx(J,{className:"w-3 h-3 text-danger-600"}),b==="Late"&&e.jsx(m,{className:"w-3 h-3 text-warning-600"}),b==="Leave"&&e.jsx(te,{className:"w-3 h-3 text-primary-600"}),b==="Half Day"&&e.jsx(se,{className:"w-3 h-3 text-secondary-600"})]})]})},l)})]}),e.jsx(Q,{className:"my-3"}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[e.jsx(z,{size:"sm",className:Y("Present").bg,variant:"flat",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-3 h-3"}),e.jsx("span",{children:"Present"})]})}),e.jsx(z,{size:"sm",className:Y("Absent").bg,variant:"flat",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"w-3 h-3"}),e.jsx("span",{children:"Absent"})]})}),e.jsx(z,{size:"sm",className:Y("Late").bg,variant:"flat",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(m,{className:"w-3 h-3"}),e.jsx("span",{children:"Late"})]})}),e.jsx(z,{size:"sm",className:Y("Leave").bg,variant:"flat",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(te,{className:"w-3 h-3"}),e.jsx("span",{children:"Leave"})]})}),e.jsx(z,{size:"sm",className:Y("Half Day").bg,variant:"flat",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"w-3 h-3"}),e.jsx("span",{children:"Half Day"})]})})]}),E&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"my-3"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:[e.jsxs("div",{className:"text-center p-2 bg-success-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-default-500",children:"Present"}),e.jsx("p",{className:"text-lg font-bold text-success-600",children:x.present})]}),e.jsxs("div",{className:"text-center p-2 bg-danger-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-default-500",children:"Absent"}),e.jsx("p",{className:"text-lg font-bold text-danger-600",children:x.absent})]}),e.jsxs("div",{className:"text-center p-2 bg-warning-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-default-500",children:"Late"}),e.jsx("p",{className:"text-lg font-bold text-warning-600",children:x.late})]}),e.jsxs("div",{className:"text-center p-2 bg-primary-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-default-500",children:"Leave"}),e.jsx("p",{className:"text-lg font-bold text-primary-600",children:x.leave})]})]})]})]})})]})},$e=ce.memo(({title:N,totalWorkingDays:j,presentDays:k,absentDays:E,lateArrivals:U})=>{const{auth:p}=le().props,[o,y]=a.useState(!1),[w,f]=a.useState(!1);a.useEffect(()=>{const t=()=>{y(window.innerWidth>=1025),f(window.innerWidth>=641&&window.innerWidth<=1024)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const $=()=>{if(typeof window>"u")return"lg";const l=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12px",r=parseInt(l);return r===0?"none":r<=4?"sm":r<=8?"md":r<=16?"lg":"full"},[A,I]=a.useState(new Date),[H,F]=a.useState(!1),[R,_]=a.useState("table"),[c,L]=a.useState({currentMonth:new Date().toISOString().slice(0,7)}),[u,P]=a.useState({meta:{month:"",workingDays:0,holidays:0,weekends:0},attendance:{present:0,absent:0,leaves:0,lateArrivals:0,percentage:0},hours:{totalWork:0,averageDaily:0,overtime:0}}),S=t=>{const l=t.target.value;l&&I(new Date(l))},x=a.useCallback((t,l)=>{L(r=>({...r,[t]:l}))},[]),D=a.useCallback(async()=>{try{const t=await ee.get(route("attendance.myMonthlyStats"),{params:{currentYear:new Date(c.currentMonth).getFullYear(),currentMonth:String(new Date(c.currentMonth).getMonth()+1).padStart(2,"0")}});t.data.success&&P(t.data.data)}catch(t){console.error("Failed to fetch stats:",t)}},[c.currentMonth]);a.useEffect(()=>{D()},[D]);const C=[{title:"Working Days",value:u.meta.workingDays,icon:e.jsx(T,{}),color:"text-default-600",iconBg:"bg-default-100",description:`Calendar: ${u.meta.month}`},{title:"Present",value:u.attendance.present,icon:e.jsx(X,{}),color:"text-success",iconBg:"bg-success/20",description:`${u.attendance.percentage}% Attendance Rate`},{title:"Absent",value:u.attendance.absent,icon:e.jsx(J,{}),color:"text-danger",iconBg:"bg-danger/20",description:"Unexcused absences"},{title:"On Leave",value:u.attendance.leaves,icon:e.jsx(_e,{}),color:"text-warning",iconBg:"bg-warning/20",description:"Approved leaves"},{title:"Late Arrivals",value:u.attendance.lateArrivals,icon:e.jsx(O,{}),color:"text-orange-500",iconBg:"bg-orange-100",description:"After grace period"},{title:"Total Hours",value:`${u.hours.totalWork}h`,icon:e.jsx(m,{}),color:"text-primary",iconBg:"bg-primary/20",description:"Total production time"},{title:"Daily Avg",value:`${u.hours.averageDaily}h`,icon:e.jsx(ae,{}),color:"text-secondary",iconBg:"bg-secondary/20",description:"Target: 8.0h"},{title:"Overtime",value:`${u.hours.overtime}h`,icon:e.jsx(Se,{}),color:"text-success-600",iconBg:"bg-success-100",description:"Extra hours logged"}];return e.jsxs(e.Fragment,{children:[e.jsx(de,{title:N||"My Attendance"}),e.jsx("div",{className:"flex flex-col w-full h-full p-4",role:"main","aria-label":"My Attendance Management",children:e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"w-full",children:e.jsx(ie.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},children:e.jsxs(B,{className:"transition-all duration-200",style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',background:"linear-gradient(135deg, var(--theme-content1, #FAFAFA) 20%, var(--theme-content2, #F4F4F5) 10%, var(--theme-content3, #F1F3F4) 20%)"},children:[e.jsx(Z,{className:"border-b p-0",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:"linear-gradient(135deg, color-mix(in srgb, var(--theme-content1) 50%, transparent) 20%, color-mix(in srgb, var(--theme-content2) 30%, transparent) 10%)"},children:e.jsx("div",{className:`${o?"p-6":w?"p-4":"p-3"} w-full`,children:e.jsx("div",{className:"flex flex-col space-y-4",children:e.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsx("div",{className:`${o?"p-3":w?"p-2.5":"p-2"} rounded-xl flex items-center justify-center`,style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsx(ae,{className:`${o?"w-8 h-8":w?"w-6 h-6":"w-5 h-5"}`,style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:`${o?"text-2xl":w?"text-xl":"text-lg"} font-bold text-foreground ${o?"":"truncate"}`,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"My Attendance"}),e.jsx("p",{className:`${o?"text-sm":"text-xs"} text-default-500 ${o?"":"truncate"}`,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"View your attendance records and timesheet details"})]})]})})})})}),e.jsxs(G,{className:"p-6",children:[e.jsx(fe,{stats:C,className:"mb-6"}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-end",children:e.jsx("div",{className:"w-full sm:w-auto sm:min-w-[200px]",children:e.jsx(De,{label:"Month/Year",type:"month",value:c.currentMonth,onChange:t=>x("currentMonth",t.target.value),variant:"bordered",size:"sm",radius:$(),startContent:e.jsx(T,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-sm"},style:{fontFamily:'var(--fontFamily, "Inter")'},"aria-label":"Select month and year for attendance"})})})}),e.jsxs(B,{className:"transition-all duration-200",style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',background:"linear-gradient(135deg, var(--theme-content1, #FAFAFA) 20%, var(--theme-content2, #F4F4F5) 10%, var(--theme-content3, #F1F3F4) 20%)"},children:[e.jsx(Z,{className:"border-b pb-2",style:{borderColor:"var(--theme-divider, #E4E4E7)"},children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg flex items-center justify-center",style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)"},children:e.jsx(m,{className:"w-6 h-6",style:{color:"var(--theme-primary)"}})}),e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-semibold text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"My Attendance Records"})]}),e.jsxs(xe,{selectedKey:R,onSelectionChange:_,variant:"underlined",size:"sm",classNames:{tabList:"gap-4",cursor:"w-full bg-primary-500",tab:"max-w-fit px-3 h-10",tabContent:"group-data-[selected=true]:text-primary text-default-600 font-medium"},children:[e.jsx(re,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Calendar"})]})},"calendar"),e.jsx(re,{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Table"})]})},"table")]})]})}),e.jsx(G,{children:e.jsx("div",{className:"max-h-[84vh] overflow-y-auto",children:R==="calendar"?e.jsx(ke,{userId:p.user.id,currentMonth:c.currentMonth,showStats:!0}):e.jsx(Ce,{selectedDate:A,handleDateChange:S,updateTimeSheet:H,externalFilterData:c})})})]})]})]})})})})})]})});$e.layout=N=>e.jsx(pe,{children:N});export{$e as default};
