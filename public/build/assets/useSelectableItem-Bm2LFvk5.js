import{g as j,h as q,i as z}from"./SelectionManager-BBvngXuP.js";import{r as g,B as J,ae as Q,T as B,af as W,ag as X,V as F,ah as Y,$ as Z,ai as _,D as ee,aj as te}from"./app-wtupjOeZ.js";import{a as oe}from"./keyboard-DBJvDvua.js";let re=0;const w=new Map;function ne(r){let[p,t]=g.useState();return J(()=>{if(!r)return;let o=w.get(r);if(o)t(o.element.id);else{let n=`react-aria-description-${re++}`;t(n);let d=document.createElement("div");d.id=n,d.style.display="none",d.textContent=r,document.body.appendChild(d),o={refCount:0,element:d},w.set(r,o)}return o.refCount++,()=>{o&&--o.refCount===0&&(o.element.remove(),w.delete(r))}},[r]),{"aria-describedby":r?p:void 0}}const se=500;function ie(r){let{isDisabled:p,onLongPressStart:t,onLongPressEnd:o,onLongPress:n,threshold:d=se,accessibilityDescription:f}=r;const b=g.useRef(void 0);let{addGlobalListener:a,removeGlobalListener:P}=Q(),{pressProps:k}=B({isDisabled:p,onPressStart(s){if(s.continuePropagation(),(s.pointerType==="mouse"||s.pointerType==="touch")&&(t&&t({...s,type:"longpressstart"}),b.current=setTimeout(()=>{s.target.dispatchEvent(new PointerEvent("pointercancel",{bubbles:!0})),W(s.target).activeElement!==s.target&&X(s.target),n&&n({...s,type:"longpress"}),b.current=void 0},d),s.pointerType==="touch")){let c=$=>{$.preventDefault()};a(s.target,"contextmenu",c,{once:!0}),a(window,"pointerup",()=>{setTimeout(()=>{P(s.target,"contextmenu",c)},30)},{once:!0})}},onPressEnd(s){b.current&&clearTimeout(b.current),o&&(s.pointerType==="mouse"||s.pointerType==="touch")&&o({...s,type:"longpressend"})}}),u=ne(n&&!p?f:void 0);return{longPressProps:F(k,u)}}function de(r){let{id:p,selectionManager:t,key:o,ref:n,shouldSelectOnPressUp:d,shouldUseVirtualFocus:f,focus:b,isDisabled:a,onAction:P,allowsDifferentPressOrigin:k,linkBehavior:u="action"}=r,s=Y();p=Z(p);let c=e=>{if(e.pointerType==="keyboard"&&z(e))t.toggleSelection(o);else{if(t.selectionMode==="none")return;if(t.isLink(o)){if(u==="selection"&&n.current){let m=t.getItemProps(o);s.open(n.current,e,m.href,m.routerOptions),t.setSelectedKeys(t.selectedKeys);return}else if(u==="override"||u==="none")return}t.selectionMode==="single"?t.isSelected(o)&&!t.disallowEmptySelection?t.toggleSelection(o):t.replaceSelection(o):e&&e.shiftKey?t.extendSelection(o):t.selectionBehavior==="toggle"||e&&(oe(e)||e.pointerType==="touch"||e.pointerType==="virtual")?t.toggleSelection(o):t.replaceSelection(o)}};g.useEffect(()=>{o===t.focusedKey&&t.isFocused&&(f?j(n.current):b?b():document.activeElement!==n.current&&n.current&&_(n.current))},[n,o,t.focusedKey,t.childFocusStrategy,t.isFocused,f]),a=a||t.isDisabled(o);let $={};!f&&!a?$={tabIndex:o===t.focusedKey?0:-1,onFocus(e){e.target===n.current&&t.setFocusedKey(o)}}:a&&($.onMouseDown=e=>{e.preventDefault()});let U=t.isLink(o)&&u==="override",I=P&&r.UNSTABLE_itemBehavior==="action",C=t.isLink(o)&&u!=="selection"&&u!=="none",l=!a&&t.canSelectItem(o)&&!U&&!I,x=(P||C)&&!a,y=x&&(t.selectionBehavior==="replace"?!l:!l||t.isEmpty),E=x&&l&&t.selectionBehavior==="replace",v=y||E,S=g.useRef(null),T=v&&l,L=g.useRef(!1),A=g.useRef(!1),h=t.getItemProps(o),D=e=>{if(P){var m;P(),(m=n.current)===null||m===void 0||m.dispatchEvent(new CustomEvent("react-aria-item-action",{bubbles:!0}))}C&&n.current&&s.open(n.current,e,h.href,h.routerOptions)},i={ref:n};if(d?(i.onPressStart=e=>{S.current=e.pointerType,L.current=T,e.pointerType==="keyboard"&&(!v||K())&&c(e)},k?(i.onPressUp=y?void 0:e=>{e.pointerType==="mouse"&&l&&c(e)},i.onPress=y?D:e=>{e.pointerType!=="keyboard"&&e.pointerType!=="mouse"&&l&&c(e)}):i.onPress=e=>{if(y||E&&e.pointerType!=="mouse"){if(e.pointerType==="keyboard"&&!O())return;D(e)}else e.pointerType!=="keyboard"&&l&&c(e)}):(i.onPressStart=e=>{S.current=e.pointerType,L.current=T,A.current=y,l&&(e.pointerType==="mouse"&&!y||e.pointerType==="keyboard"&&(!x||K()))&&c(e)},i.onPress=e=>{(e.pointerType==="touch"||e.pointerType==="pen"||e.pointerType==="virtual"||e.pointerType==="keyboard"&&v&&O()||e.pointerType==="mouse"&&A.current)&&(v?D(e):l&&c(e))}),$["data-collection"]=q(t.collection),$["data-key"]=o,i.preventFocusOnPress=f,f&&(i=F(i,{onPressStart(e){e.pointerType!=="touch"&&(t.setFocused(!0),t.setFocusedKey(o))},onPress(e){e.pointerType==="touch"&&(t.setFocused(!0),t.setFocusedKey(o))}})),h)for(let e of["onPressStart","onPressEnd","onPressChange","onPress","onPressUp","onClick"])h[e]&&(i[e]=ee(i[e],h[e]));let{pressProps:M,isPressed:R}=B(i),G=E?e=>{S.current==="mouse"&&(e.stopPropagation(),e.preventDefault(),D(e))}:void 0,{longPressProps:V}=ie({isDisabled:!T,onLongPress(e){e.pointerType==="touch"&&(c(e),t.setSelectionBehavior("toggle"))}}),H=e=>{S.current==="touch"&&L.current&&e.preventDefault()},N=u!=="none"&&t.isLink(o)?e=>{te.isOpening||e.preventDefault()}:void 0;return{itemProps:F($,l||y||f&&!a?M:{},T?V:{},{onDoubleClick:G,onDragStartCapture:H,onClick:N,id:p},f?{onMouseDown:e=>e.preventDefault()}:void 0),isPressed:R,isSelected:t.isSelected(o),isFocused:t.isFocused&&t.focusedKey===o,isDisabled:a,allowsSelection:l,hasAction:v}}function O(){let r=window.event;return r?.key==="Enter"}function K(){let r=window.event;return r?.key===" "||r?.code==="Space"}export{de as $,ie as a,ne as b};
