import{o as W,r as b,n as q,j as e,H as G,c as j,d as w,a as g,b as J}from"./app-D_-WVEdp.js";import{S as K}from"./SafeLink-Ca0TPwQX.js";import{h as Q,c as V}from"./routeUtils-Ck7DPZCW.js";import{A as v}from"./AuthCard-DIwHRajl.js";import{R as X}from"./RegisterLayout-2-vg5pQQ.js";import{u as Z}from"./useBranding-FxIvTb8a.js";import{s as M}from"./toastUtils-ycRu2wJH.js";import{P as ee}from"./ProgressSteps-BEgPJrRU.js";import{F as R}from"./CheckCircleIcon-C2VXk29s.js";import{d as o}from"./chunk-IHO36JMK-YsOKRYLU.js";import{s as se}from"./chunk-I3A4XRYQ-CJNCN2D_.js";import{c as E}from"./chunk-C6WKGNND-DzOcfHNA.js";import{t as ae}from"./chunk-WEIB4WXA-Cf-_iQ3U.js";import"./app-Bq-q9uAS.js";import"./chunk-AUA5GDXN-DN3ZdlyW.js";import"./index-D0ogoVNn.js";import"./index-C-9Wnuxw.js";import"./chunk-WQVQ7P2I-CH5xj4JM.js";import"./number-CB4zbwAz.js";import"./chunk-LGMZDQT5-CaoNqm2A.js";import"./index-C2EWbGBu.js";/* empty css                      */import"./MaintenanceModeBanner-Ced2Il-8.js";import"./ArrowLeftIcon-CvMFTAF3.js";import"./useToggleState-Dg72h8QO.js";import"./chunk-ICU6NNET-CTByTmgN.js";import"./chunk-KQW2TNLT-CWiQ5bkd.js";import"./useLabel-sAk_8DNM.js";import"./useLabels-CUZ0Yc-W.js";function Me({steps:F=[],currentStep:D,savedData:O={},plans:$=[],modules:_=[],modulePricing:P={}}){const x=O?.plan??{},S=Array.isArray($)?$:[],f=Array.isArray(_)?_:[],{data:l,setData:h,post:T,processing:k,errors:p}=W({billing_cycle:x.billing_cycle??"monthly",plan_id:x.plan_id??null,modules:Array.isArray(x.modules)?x.modules:[],notes:x.notes??""}),{siteName:B}=Z(),I=a=>{l.plan_id===a?h({...l,plan_id:null}):h({...l,plan_id:a,modules:[]})},z=a=>{const i=Array.isArray(l.modules)?l.modules:[],m=i.includes(a)?i.filter(d=>d!==a):[...i,a];h({...l,modules:m,plan_id:null})},c=l.billing_cycle==="yearly",t=S.find(a=>a.id===l.plan_id),r=Array.isArray(l.modules)?l.modules:[],C=c?P.yearly??200:P.monthly??20,N=t?c?t.yearly_price:t.monthly_price:0,y=!t&&r.length>0?r.length*C:0,A=t?N:y,u=b.useMemo(()=>f.filter(a=>r.includes(a.id)),[f,r]),L=b.useMemo(()=>{const a=!!l.plan_id,i=Array.isArray(l.modules)&&l.modules.length>0,m=a||i;return console.log("hasSelection check:",{hasPlan:a,hasModules:i,result:m,plan_id:l.plan_id,modules:l.modules}),m},[l.plan_id,l.modules]),Y=a=>{if(a.preventDefault(),!L){M.warning("Please select a plan or at least one module to continue.");return}if(!Q("platform.register.plan.store")){console.error("Route platform.register.plan.store not found"),M.error("Navigation route not found. Please contact support.");return}const i=V("platform.register.plan.store");T(i)},{themeSettings:U}=q(),n=U?.mode==="dark",s=b.useMemo(()=>({heading:n?"text-white":"text-slate-900",copy:n?"text-slate-300":"text-slate-600",badge:n?"text-slate-300":"text-slate-500",card:n?"border border-white/10 bg-white/5":"border border-slate-200 bg-white shadow-sm",selectedCard:n?"border border-emerald-400/60 bg-emerald-500/10":"border border-emerald-200 bg-emerald-50",surface:n?"bg-white/5 border border-white/10":"bg-white border border-slate-200 shadow-sm",link:n?"text-white/80 hover:text-white":"text-slate-600 hover:text-slate-900",muted:n?"text-slate-400":"text-slate-500",accent:n?"text-white":"text-slate-900"}),[n]);return e.jsxs(X,{children:[e.jsx(G,{title:`Choose modules - ${B}`}),e.jsxs("section",{className:"max-w-6xl mx-auto px-4 sm:px-6 py-6 sm:py-12 space-y-6 sm:space-y-8",children:[e.jsxs("div",{className:"space-y-2 sm:space-y-3 text-center",children:[e.jsx("p",{className:`text-[10px] sm:text-sm uppercase tracking-[0.3em] ${s.badge}`,children:"Step 4"}),e.jsx("h1",{className:`text-2xl sm:text-4xl font-semibold ${s.heading} px-2`,children:"Choose Your Plan & Products"}),e.jsx("p",{className:`${s.copy} text-sm sm:text-base px-2`,children:"Select a pre-configured plan or customize with individual products."})]}),e.jsx(ee,{steps:F,currentStep:D}),e.jsxs("div",{className:"grid gap-4 sm:gap-6 lg:grid-cols-[2fr,1fr]",children:[e.jsx("div",{className:"lg:hidden order-first",children:e.jsx(v,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsx("p",{className:`text-xs sm:text-sm uppercase tracking-[0.3em] ${s.badge}`,children:"Total Estimate"}),e.jsxs("h2",{className:`text-2xl sm:text-3xl font-semibold ${s.heading}`,children:["$",A.toLocaleString()]})]}),e.jsxs("p",{className:`text-xs sm:text-sm ${s.copy}`,children:["Per ",c?"year":"month"]}),e.jsx(o,{}),e.jsxs("div",{className:"space-y-2 text-xs sm:text-sm",children:[t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:s.copy,children:[t.name," Plan"]}),e.jsxs("span",{className:s.heading,children:["$",N.toLocaleString()]})]}),e.jsxs("p",{className:`text-xs ${s.muted}`,children:["Includes ",t.modules?.length||0," modules"]})]}):r.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:s.copy,children:[r.length," Custom Module",r.length!==1?"s":""]}),e.jsxs("span",{className:s.heading,children:["$",y.toLocaleString()]})]}),e.jsx("p",{className:`text-xs ${s.muted}`,children:"Custom plan"})]}):e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:s.copy,children:"No selection"}),e.jsx("span",{className:s.muted,children:"$0"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:s.copy,children:"Core Platform"}),e.jsx("span",{className:"text-emerald-500",children:"Free"})]})]}),e.jsx(o,{}),(t||u.length>0)&&e.jsxs("div",{children:[e.jsx("p",{className:`text-xs font-semibold ${s.muted} mb-2`,children:"YOUR SELECTION:"}),e.jsx("ul",{className:`text-xs space-y-1 ${s.copy}`,children:t?t.modules&&t.modules.map(a=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-1.5 w-1.5 rounded-full bg-blue-400"}),a.name]},a.id)):u.map(a=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-1.5 w-1.5 rounded-full bg-emerald-400"}),a.name]},a.id))})]})]})})}),e.jsx(v,{children:e.jsxs("form",{onSubmit:Y,className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsx("p",{className:`text-xs sm:text-sm ${s.muted}`,children:"Billing cadence"}),e.jsxs("div",{className:`flex items-center gap-2 text-xs sm:text-sm ${s.copy}`,children:[e.jsx("span",{className:c?s.muted:`font-semibold ${s.heading}`,children:"Monthly"}),e.jsx(se,{isSelected:c,onChange:()=>h("billing_cycle",c?"monthly":"yearly"),color:"secondary","aria-label":"Toggle billing cycle",size:"sm"}),e.jsxs("span",{className:c?`font-semibold ${s.heading}`:s.muted,children:["Yearly ",e.jsx("small",{className:"text-emerald-500",children:"(2 mo free)"})]})]})]}),e.jsx(o,{className:"my-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-base sm:text-lg font-semibold ${s.heading}`,children:"1. Choose a Plan"}),e.jsx("p",{className:`text-xs sm:text-sm ${s.copy}`,children:"Pre-configured bundles with modules included"})]}),e.jsx("div",{className:"grid gap-3 sm:gap-4 md:grid-cols-2",children:S.map(a=>{const i=l.plan_id===a.id,m=c?a.yearly_price:a.monthly_price;return e.jsxs(j,{isPressable:!0,onPress:()=>I(a.id),className:i?s.selectedCard:s.card,children:[e.jsxs(E,{className:"flex-col items-start pb-2",children:[e.jsxs("div",{className:"flex items-start justify-between w-full",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:`text-lg sm:text-xl font-bold ${s.heading}`,children:a.name}),a.badge&&e.jsx(w,{size:"sm",color:"primary",variant:"flat",className:"mt-1",children:a.badge})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-xl sm:text-2xl font-bold ${s.heading}`,children:["$",m]}),e.jsxs("p",{className:`text-xs ${s.muted}`,children:["/",c?"year":"month"]})]})]}),e.jsx("p",{className:`text-xs sm:text-sm ${s.copy} mt-2`,children:a.description})]}),e.jsxs(g,{className:"text-xs sm:text-sm space-y-3 pt-2",children:[a.modules&&a.modules.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:`text-xs font-semibold ${s.muted} mb-2`,children:"INCLUDED MODULES:"}),e.jsx("div",{className:"space-y-2",children:a.modules.map(d=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(R,{className:"h-4 w-4 text-emerald-500 shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`font-medium ${s.heading} text-sm`,children:d.name}),d.description&&e.jsx("p",{className:`text-xs ${s.muted} line-clamp-2`,children:d.description})]})]},d.id))})]}),a.features&&a.features.length>0&&e.jsx("div",{className:"space-y-1",children:a.features.slice(0,3).map((d,H)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(R,{className:"h-4 w-4 text-emerald-500 shrink-0 mt-0.5"}),e.jsx("span",{className:s.copy,children:d})]},H))}),e.jsx("div",{className:"pt-2",children:e.jsx(w,{size:"sm",color:i?"success":"default",variant:i?"solid":"flat",children:i?"âœ“ Selected":"Select Plan"})})]})]},a.id)})})]}),e.jsx(o,{className:"my-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-base sm:text-lg font-semibold ${s.heading}`,children:"2. Or Build Custom with Modules"}),e.jsxs("p",{className:`text-xs sm:text-sm ${s.copy}`,children:["Select individual modules â€¢ $",C,"/",c?"year":"month"," per module"]}),e.jsx("p",{className:`text-xs ${s.muted} mt-1`,children:"ðŸ’¡ Selecting modules will deselect any plan â€¢ Core Platform is always included free"})]}),e.jsx("div",{className:"grid gap-3 sm:gap-4 md:grid-cols-2",children:f.map(a=>{const i=r.includes(a.id);return e.jsxs(j,{isPressable:!0,onPress:()=>z(a.id),className:i?s.selectedCard:s.card,children:[e.jsxs(E,{className:"justify-between pb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-[10px] sm:text-xs uppercase tracking-[0.4em] ${s.muted}`,children:a.category}),e.jsx("h2",{className:`text-base sm:text-xl font-semibold ${s.heading} truncate`,children:a.name})]}),e.jsx(w,{size:"sm",color:i?"success":"default",variant:"flat",className:"text-[10px] sm:text-xs ml-2 shrink-0",children:i?"âœ“ Added":"Add"})]}),e.jsx(g,{className:"text-xs sm:text-sm space-y-2 pt-2",children:e.jsx("p",{className:s.copy,children:a.description})})]},a.id)})})]}),p.modules&&e.jsx("p",{className:"text-sm text-red-400",children:p.modules}),e.jsx(ae,{label:"Implementation notes (optional)",placeholder:"Tell us about integrations, compliance packs, or migration timelines.",minRows:3,value:l.notes,onChange:a=>h("notes",a.target.value),isInvalid:!!p.notes,errorMessage:p.notes,classNames:{label:"text-sm sm:text-base",input:"text-sm sm:text-base"}}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsx(K,{route:"platform.register.details",className:`text-xs sm:text-sm transition-colors text-center sm:text-left ${s.link}`,children:"â† Back to details"}),e.jsx(J,{type:"submit",color:"primary",className:"bg-gradient-to-r from-blue-500 to-purple-600 w-full sm:w-auto",isLoading:k,isDisabled:k||!L,children:"Review & launch trial"})]})]})}),e.jsxs("div",{className:"hidden lg:block space-y-4",children:[e.jsx(v,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:`text-sm uppercase tracking-[0.3em] ${s.badge}`,children:"Total Estimate"}),e.jsxs("h2",{className:`text-3xl font-semibold ${s.heading}`,children:["$",A.toLocaleString()]}),e.jsxs("p",{className:`text-sm ${s.copy}`,children:["Per ",c?"year":"month"]}),e.jsx(o,{}),e.jsxs("div",{className:"space-y-2 text-sm",children:[t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:s.copy,children:[t.name," Plan"]}),e.jsxs("span",{className:s.heading,children:["$",N.toLocaleString()]})]}),e.jsxs("p",{className:`text-xs ${s.muted}`,children:["Includes ",t.modules?.length||0," modules"]})]}):r.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:s.copy,children:[r.length," Module",r.length!==1?"s":""]}),e.jsxs("span",{className:s.heading,children:["$",y.toLocaleString()]})]}),e.jsx("p",{className:`text-xs ${s.muted}`,children:"Custom plan"})]}):e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:s.copy,children:"No selection"}),e.jsx("span",{className:s.muted,children:"$0"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:s.copy,children:"Core Platform"}),e.jsx("span",{className:"text-emerald-500",children:"Free"})]})]}),e.jsx(o,{}),(t||u.length>0)&&e.jsxs("div",{children:[e.jsx("p",{className:`text-xs font-semibold ${s.muted} mb-2`,children:"YOUR SELECTION:"}),e.jsx("ul",{className:`text-sm space-y-1 ${s.copy}`,children:t?t.modules&&t.modules.map(a=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-blue-400"}),a.name]},a.id)):u.map(a=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-emerald-400"}),a.name]},a.id))})]})]})}),e.jsx(j,{className:`${s.surface} text-sm`,children:e.jsxs(g,{className:"space-y-2",children:[e.jsx("p",{className:`font-semibold ${s.heading}`,children:"Flexible Pricing"}),e.jsx("p",{className:s.copy,children:"Choose a pre-configured plan OR build custom with individual modules. Pick what works best for your needs."}),e.jsx("p",{className:"text-emerald-500",children:"Core platform features (auth, users, settings) are always included at no extra cost."})]})})]}),e.jsx("div",{className:"lg:hidden",children:e.jsx(j,{className:`${s.surface} text-xs sm:text-sm`,children:e.jsxs(g,{className:"space-y-2",children:[e.jsx("p",{className:`font-semibold ${s.heading}`,children:"Why modules?"}),e.jsx("p",{className:s.copy,children:"Rolling modules lets finance teams align spend with adoption milestones. You can pause any module in 1 click."}),e.jsx("p",{className:"text-emerald-500",children:"Payment collection happens later. Right now we only need your wish list."})]})})})]})]})]})}export{Me as default};
