import{n as Ne,R as Fe,j as e,e as X,b as Y,g as ee,c as A,d as B,p as ye,F as we,r as y,am as ve,f as ke,H as Se,m as ie,A as De}from"./app-B6wsOsaS.js";import{D as Re}from"./index-3SaTkLKc.js";import{g as V,m as _e,L as Ce,A as Ie}from"./App-CK2S0NSv.js";import{u as G}from"./useMediaQuery-DZUWRbmB.js";import{F as L}from"./DocumentIcon-Dyrjy08c.js";import{F as Z}from"./ClockIcon-BUXQo1ym.js";import{F as le}from"./CheckCircleIcon-6Exxd0Z4.js";import{F as ne,D as $e,a as We,b as Ee,u as E,w as Me}from"./xlsx-BFgGBOgy.js";import{F as oe}from"./CalendarDaysIcon-CNGOJamk.js";import{F as M,c as Pe}from"./PlusIcon-C9FvSUYH.js";import{F as de}from"./BuildingOfficeIcon-DnIJIovL.js";import{F as se}from"./MapPinIcon-DLvBLoQF.js";import{F as te}from"./CheckCircleIcon-DEtAvStx.js";import{c as C,t as Ye,a as Ae,b as Be}from"./chunk-F3UDT23P-BA6MA9xb.js";import{p as T}from"./chunk-VFIJPDYX-BAUheveH.js";import{a as K,s as ce}from"./chunk-C3QHEOC2-CExZ-LMh.js";import{t as ze,a as Le}from"./chunk-YRZGWF2W-HdxvFUui.js";import{d as me}from"./chunk-IHO36JMK-CuHsjaEa.js";import{s as O}from"./chunk-P7ACKWSP-BNwvhvzP.js";import{S as Te}from"./StatsCards-CfadUbLo.js";import{s as U}from"./toastUtils-DmQakeEH.js";import{F as Oe}from"./InformationCircleIcon-5mmLyCUw.js";import{m as Ve,a as Ge,b as qe,c as He}from"./chunk-TW2E3XVA-BZhjrx-b.js";import{r as xe,a as ue}from"./chunk-AEQOEFWT-CVoJWksy.js";import{c as Ue}from"./chunk-7LVYGA7G-B80lANny.js";import{c as Qe}from"./chunk-PMMJMDBI-9SYdMhDV.js";import{m as Je}from"./chunk-5LXTSPS7-Sqo0SLte.js";import{d as F}from"./dayjs.min-3pOIRhRA.js";import{F as Xe}from"./UserIcon-zGrV1LXN.js";import{c as Ze}from"./chunk-C6WKGNND-_SL0ETSL.js";import{b as Ke}from"./chunk-57V4RE7B-BG8Ez0Gd.js";import{i as fe}from"./chunk-SQIAVXJX-BKfxTp82.js";import{l as pe}from"./chunk-Y5DMIIWQ-rOZjnGr-.js";const es=({filteredData:f,onRefresh:S,loading:w=!1})=>{const{theme:k}=Ne(),m=G("(max-width: 1024px)"),c=()=>{if(typeof window>"u")return"lg";const s=parseInt(getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12");return s===0?"none":s<=4?"sm":s<=8?"md":s<=16?"lg":"full"},h=()=>e.jsxs("div",{className:"max-h-[84vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-2",children:[e.jsx(O,{className:"w-32 h-6 rounded"}),e.jsx(O,{className:"w-20 h-8 rounded"})]}),e.jsx(K,{className:"max-h-[70vh]",children:e.jsxs("div",{className:"border border-divider rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-default-100/80 backdrop-blur-md border-b border-divider",children:e.jsx("div",{className:"flex",children:$.map((s,t)=>e.jsx("div",{className:"flex-1 p-3",children:e.jsx(O,{className:"w-20 h-4 rounded"})},t))})}),e.jsx("div",{className:"divide-y divide-divider",children:Array.from({length:8}).map((s,t)=>e.jsx("div",{className:"flex hover:bg-default-50/50 transition-colors",children:$.map((r,i)=>e.jsx("div",{className:"flex-1 p-3",children:e.jsx(O,{className:"w-full h-4 rounded"})},i))},t))})]})})]}),l=s=>new Date(s).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}),o=s=>s>=100?"success":s>=75?"warning":s>=50?"primary":"danger",x=s=>s>=100?e.jsx(le,{className:"w-3 h-3"}):s>=50?e.jsx(Z,{className:"w-3 h-3"}):e.jsx(we,{className:"w-3 h-3"}),u=(s,t)=>{const r="w-3 h-3",i=t>0?"":"text-gray-400";switch(s?.toLowerCase()){case"embankment":return e.jsx(de,{className:`${r} text-amber-500 ${i}`});case"structure":return e.jsx(L,{className:`${r} text-blue-500 ${i}`});case"pavement":return e.jsx(se,{className:`${r} text-gray-500 ${i}`});default:return e.jsx(V,{className:`${r} text-primary ${i}`})}},I=({summary:s})=>{const t=s.totalDailyWorks>0?(s.completed/s.totalDailyWorks*100).toFixed(1):0,r=s.rfiSubmissions>0&&s.completed>0?(s.rfiSubmissions/s.completed*100).toFixed(1):0,i=s.totalDailyWorks-s.completed;return e.jsx(A,{className:"mb-2",shadow:"sm",radius:c(),style:{border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(B,{className:"p-3",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"flex items-center gap-3 flex-1",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-bold text-primary",style:{fontFamily:'var(--fontFamily, "Inter")'},children:l(s.date)}),e.jsxs("span",{className:"text-xs text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[s.totalDailyWorks," total works"]})]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(X,{size:"sm",variant:"flat",color:o(parseFloat(t)),startContent:x(parseFloat(t)),radius:c(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:[t,"%"]})})]}),e.jsx(me,{className:"my-3"}),e.jsxs("div",{className:"space-y-3 mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Completion Progress"}),e.jsxs("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[s.completed,"/",s.totalDailyWorks]})]}),e.jsx(T,{value:parseFloat(t),color:o(parseFloat(t)),size:"sm",radius:c(),className:"w-full","aria-label":`Completion progress: ${t}%`})]}),s.rfiSubmissions>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"RFI Submission"}),e.jsxs("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[s.rfiSubmissions,"/",s.completed]})]}),e.jsx(T,{value:parseFloat(r),color:o(parseFloat(r)),size:"sm",radius:c(),className:"w-full","aria-label":`RFI submission progress: ${r}%`})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[u("embankment",s.embankment),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Embankment"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:s.embankment})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[u("structure",s.structure),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Structure"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:s.structure})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-white/5 rounded-lg",style:{borderRadius:"var(--borderRadius, 8px)"},children:[u("pavement",s.pavement),e.jsx("span",{className:"text-xs mt-1 text-default-600",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Pavement"}),e.jsx("span",{className:"text-xs font-medium",style:{fontFamily:'var(--fontFamily, "Inter")'},children:s.pavement})]})]}),e.jsx(me,{className:"my-3"}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ne,{className:"w-3 h-3 text-warning"}),e.jsxs("span",{style:{fontFamily:'var(--fontFamily, "Inter")'},children:["Resubmissions: ",s.resubmissions]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-3 h-3 text-danger"}),e.jsxs("span",{style:{fontFamily:'var(--fontFamily, "Inter")'},children:["Pending: ",i]})]})]})]})})},D=Fe.useCallback((s,t)=>{const r=s.totalDailyWorks>0?(s.completed/s.totalDailyWorks*100).toFixed(1):0,i=s.rfiSubmissions>0&&s.completed>0?(s.rfiSubmissions/s.completed*100).toFixed(1):0,p=s.totalDailyWorks-s.completed;switch(t){case"date":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(oe,{className:"w-3 h-3 text-default-500"}),e.jsx("span",{className:"text-sm font-medium",children:l(s.date)})]})});case"totalDailyWorks":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(V,{className:"w-3 h-3 text-primary"}),e.jsx("span",{className:"text-sm font-bold",children:s.totalDailyWorks})]})});case"resubmissions":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ne,{className:"w-3 h-3 text-warning"}),e.jsx("span",{className:"text-sm",children:s.resubmissions})]})});case"embankment":case"structure":case"pavement":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[u(t,s[t]),e.jsx("span",{className:"text-sm",children:s[t]})]})});case"completed":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(le,{className:"w-3 h-3 text-success"}),e.jsx("span",{className:"text-sm font-medium text-success",children:s.completed})]})});case"pending":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-3 h-3 text-danger"}),e.jsx("span",{className:"text-sm font-medium text-danger",children:p})]})});case"completionPercentage":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{value:parseFloat(r),color:o(parseFloat(r)),size:"sm",className:"flex-1 min-w-[80px]","aria-label":`Daily work completion: ${r}%`}),e.jsxs(X,{size:"sm",variant:"flat",color:o(parseFloat(r)),startContent:x(parseFloat(r)),children:[r,"%"]})]})});case"rfiSubmissions":return e.jsx(C,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"w-3 h-3 text-info"}),e.jsx("span",{className:"text-sm",children:s.rfiSubmissions})]})});case"rfiSubmissionPercentage":return e.jsx(C,{children:e.jsx("div",{className:"flex items-center gap-2",children:s.rfiSubmissions>0?e.jsxs(e.Fragment,{children:[e.jsx(T,{value:parseFloat(i),color:o(parseFloat(i)),size:"sm",className:"flex-1 min-w-[80px]","aria-label":`RFI submission percentage: ${i}%`}),e.jsxs(X,{size:"sm",variant:"flat",color:o(parseFloat(i)),startContent:x(parseFloat(i)),children:[i,"%"]})]}):e.jsx("span",{className:"text-sm text-default-400",children:"-"})})});default:return e.jsx(C,{children:s[t]})}},[]),$=[{name:"Date",uid:"date",icon:oe},{name:"Total Daily Works",uid:"totalDailyWorks",icon:V},{name:"Resubmissions",uid:"resubmissions",icon:ee},{name:"Embankment",uid:"embankment",icon:de},{name:"Structure",uid:"structure",icon:L},{name:"Pavement",uid:"pavement",icon:se},{name:"Completed",uid:"completed",icon:te},{name:"Pending",uid:"pending",icon:ye},{name:"Completion %",uid:"completionPercentage",icon:M},{name:"RFI Submissions",uid:"rfiSubmissions",icon:L},{name:"RFI Submission %",uid:"rfiSubmissionPercentage",icon:M}];return m?e.jsxs("div",{className:"space-y-4",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[S&&e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(Y,{size:"sm",variant:"bordered",color:"primary",radius:c(),startContent:e.jsx(ee,{className:"w-4 h-4"}),onPress:S,"aria-label":"Refresh daily work summary table",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:"Refresh Summary"})}),e.jsx(K,{className:"max-h-[70vh]",children:f?.length>0?f.map((s,t)=>e.jsx(I,{summary:s},t)):e.jsx(A,{className:"text-center py-8",radius:c(),style:{border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(B,{children:[e.jsx(M,{className:"w-12 h-12 text-default-300 mb-4 mx-auto"}),e.jsx("h6",{className:"text-lg font-semibold text-default-600 mb-2",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"No summary data found"}),e.jsx("p",{className:"text-sm text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"No work summary available for the selected period"})]})})})]}):w?e.jsx(h,{}):e.jsx("div",{className:"max-h-[84vh] overflow-y-auto",children:e.jsx(K,{className:"max-h-[70vh]",children:e.jsxs(Ye,{selectionMode:"none",isCompact:!0,removeWrapper:!0,isStriped:!0,"aria-label":"Daily Work Summary Table",isHeaderSticky:!0,radius:c(),classNames:{base:"max-h-[520px] overflow-auto",table:"min-h-[200px] w-full",thead:"z-10",tbody:"overflow-y-auto",th:"bg-default-100 text-default-700 font-semibold",td:"text-default-600"},style:{borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(ze,{columns:$,children:s=>e.jsx(Le,{align:s.uid==="date"?"start":"center",className:`bg-default-100/80 backdrop-blur-md ${s.width||""}`,style:{minWidth:s.uid==="date"?"128px":s.uid==="incharge"?"192px":"auto"},children:e.jsxs("div",{className:`flex items-center gap-1 ${s.uid==="date"?"justify-start":"justify-center"}`,children:[s.icon&&e.jsx(s.icon,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs font-semibold",children:s.name})]})},s.uid)}),e.jsx(Ae,{items:f||[],emptyContent:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(M,{className:"w-12 h-12 text-default-300 mb-4"}),e.jsx("h6",{className:"text-lg font-medium text-default-600",children:"No summary data found"}),e.jsx("span",{className:"text-sm text-default-500",children:"No work summary available for the selected period"})]}),children:s=>e.jsx(Be,{children:t=>D(s,t)},s.date)})]})})})},ss=({open:f,closeModal:S,filteredData:w=[],inCharges:k=[]})=>{const[m,c]=y.useState({format:"excel",columns:["date","totalDailyWorks","completed","pending","completionPercentage","rfiSubmissions","embankment","structure","pavement","resubmissions"],includeCharts:!1,groupBy:"date"}),[h,l]=y.useState(!1),o=[{key:"excel",label:"Excel (.xlsx)",description:"Comprehensive spreadsheet with summary data",icon:e.jsx(We,{size:20,className:"text-green-600"})},{key:"csv",label:"CSV (.csv)",description:"Simple comma-separated values",icon:e.jsx(Ee,{size:20,className:"text-blue-600"})}],x=[{key:"date",label:"Date",description:"Summary date"},{key:"totalDailyWorks",label:"Total Works",description:"Total number of daily works"},{key:"completed",label:"Completed",description:"Number of completed works"},{key:"pending",label:"Pending",description:"Number of pending works"},{key:"completionPercentage",label:"Completion %",description:"Completion percentage"},{key:"rfiSubmissions",label:"RFI Submissions",description:"Number of RFI submissions"},{key:"rfiSubmissionPercentage",label:"RFI Submission %",description:"RFI submission percentage"},{key:"embankment",label:"Embankment Works",description:"Number of embankment works"},{key:"structure",label:"Structure Works",description:"Number of structure works"},{key:"pavement",label:"Pavement Works",description:"Number of pavement works"},{key:"resubmissions",label:"Resubmissions",description:"Number of resubmissions"}],u=[{key:"date",label:"By Date",description:"Group summary by date"},{key:"type",label:"By Type",description:"Group summary by work type"},{key:"overall",label:"Overall Summary",description:"Single overall summary"}],I=async()=>{l(!0);try{let t=D();const r=`daily_work_summary_${new Date().toISOString().split("T")[0]}`;switch(m.format){case"excel":$(t,r);break;case"csv":s(t,r);break}U.success(`Successfully exported ${t.length} summary records`,{icon:e.jsx(te,{className:"w-5 h-5"})}),S()}catch(t){U.error("Export failed: "+t.message)}finally{l(!1)}},D=()=>{let t=[...w];if(m.groupBy==="overall"){const r=t.reduce((n,g)=>n+g.totalDailyWorks,0),i=t.reduce((n,g)=>n+g.completed,0),p=t.reduce((n,g)=>n+g.rfiSubmissions,0),v=t.reduce((n,g)=>n+g.embankment,0),d=t.reduce((n,g)=>n+g.structure,0),R=t.reduce((n,g)=>n+g.pavement,0),W=t.reduce((n,g)=>n+g.resubmissions,0);t=[{date:"Overall Summary",totalDailyWorks:r,completed:i,pending:r-i,completionPercentage:r>0?(i/r*100).toFixed(1)+"%":"0%",rfiSubmissions:p,rfiSubmissionPercentage:r>0?(p/r*100).toFixed(1)+"%":"0%",embankment:v,structure:d,pavement:R,resubmissions:W}]}else if(m.groupBy==="type"){const r=t.reduce((i,p)=>(["embankment","structure","pavement"].forEach(v=>{p[v]>0&&(i[v]||(i[v]={type:v.charAt(0).toUpperCase()+v.slice(1),totalWorks:0,dates:[]}),i[v].totalWorks+=p[v],i[v].dates.push(p.date))}),i),{});t=Object.values(r).map(i=>({type:i.type,totalWorks:i.totalWorks,dateRange:`${Math.min(...i.dates)} to ${Math.max(...i.dates)}`,dateCount:i.dates.length}))}return t.map(r=>{const i={};return m.columns.forEach(p=>{if(r.hasOwnProperty(p)){const v=x.find(d=>d.key===p)?.label||p;i[v]=r[p]}}),i})},$=(t,r)=>{const i=E.json_to_sheet(t),p=E.book_new();E.book_append_sheet(p,i,"Summary");const v=Object.keys(t[0]||{}).map(()=>({wch:20}));i["!cols"]=v;const d=E.decode_range(i["!ref"]);for(let R=d.s.c;R<=d.e.c;R++){const W=E.encode_cell({r:0,c:R});i[W]&&(i[W].s={font:{bold:!0},fill:{fgColor:{rgb:"CCCCCC"}}})}Me(p,`${r}.xlsx`)},s=(t,r)=>{const i=E.json_to_sheet(t),p=E.sheet_to_csv(i),v=new Blob([p],{type:"text/csv;charset=utf-8;"}),d=document.createElement("a"),R=URL.createObjectURL(v);d.setAttribute("href",R),d.setAttribute("download",`${r}.csv`),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d)};return e.jsx(Ve,{isOpen:f,onClose:S,size:"3xl",scrollBehavior:"inside",classNames:{base:"backdrop-blur-md",backdrop:"bg-black/50 backdrop-blur-sm"},children:e.jsxs(Ge,{children:[e.jsxs(qe,{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-6 h-6 text-primary"}),e.jsx("span",{children:"Export Daily Work Summary"})]}),e.jsx("p",{className:"text-sm text-default-500 font-normal",children:"Export summary data with customizable grouping and format options"})]}),e.jsx(He,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(A,{className:"bg-default-50",children:e.jsxs(B,{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Export Format"}),e.jsx(xe,{value:m.format,onValueChange:t=>c(r=>({...r,format:t})),orientation:"horizontal",children:o.map(t=>e.jsx(ue,{value:t.key,children:e.jsxs("div",{className:"flex items-center gap-2",children:[t.icon,e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.label}),e.jsx("div",{className:"text-xs text-default-500",children:t.description})]})]})},t.key))})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Grouping & Summary"}),e.jsx(xe,{value:m.groupBy,onValueChange:t=>c(r=>({...r,groupBy:t})),children:u.map(t=>e.jsx(ue,{value:t.key,children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.label}),e.jsx("div",{className:"text-xs text-default-500",children:t.description})]})},t.key))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Columns to Export"}),e.jsx(Ue,{value:m.columns,onValueChange:t=>c(r=>({...r,columns:t})),children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:x.map(t=>e.jsx(Qe,{value:t.key,children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.label}),e.jsx("div",{className:"text-xs text-default-500",children:t.description})]})},t.key))})})]}),e.jsx(A,{className:"bg-primary-50 border-primary-200",children:e.jsx(B,{children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Oe,{className:"w-5 h-5 text-primary-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-primary-900",children:"Export Summary"}),e.jsxs("div",{className:"text-sm text-primary-700 space-y-1",children:[e.jsxs("p",{children:["• Format: ",o.find(t=>t.key===m.format)?.label]}),e.jsxs("p",{children:["• Grouping: ",u.find(t=>t.key===m.groupBy)?.label]}),e.jsxs("p",{children:["• Columns: ",m.columns.length," selected"]}),e.jsxs("p",{children:["• Records: ",w.length," summary entries"]})]})]})]})})})]})}),e.jsxs(Je,{children:[e.jsx(Y,{variant:"light",onPress:S,isDisabled:h,children:"Cancel"}),e.jsx(Y,{color:"primary",onPress:I,isLoading:h,startContent:!h&&e.jsx($e,{size:16}),isDisabled:m.columns.length===0,children:h?"Exporting...":"Export Summary"})]})]})})};var q={exports:{}},ts=q.exports,he;function as(){return he||(he=1,(function(f,S){(function(w,k){f.exports=k()})(ts,(function(){return function(w,k,m){var c=function(h,l){if(!l||!l.length||l.length===1&&!l[0]||l.length===1&&Array.isArray(l[0])&&!l[0].length)return null;var o;l.length===1&&l[0].length>0&&(l=l[0]),o=(l=l.filter((function(u){return u})))[0];for(var x=1;x<l.length;x+=1)l[x].isValid()&&!l[x][h](o)||(o=l[x]);return o};m.max=function(){var h=[].slice.call(arguments,0);return c("isAfter",h)},m.min=function(){var h=[].slice.call(arguments,0);return c("isBefore",h)}}}))})(q)),q.exports}var rs=as();const is=ve(rs);var H={exports:{}},ls=H.exports,be;function ns(){return be||(be=1,(function(f,S){(function(w,k){f.exports=k()})(ls,(function(){return function(w,k,m){k.prototype.isBetween=function(c,h,l,o){var x=m(c),u=m(h),I=(o=o||"()")[0]==="(",D=o[1]===")";return(I?this.isAfter(x,l):!this.isBefore(x,l))&&(D?this.isBefore(u,l):!this.isAfter(u,l))||(I?this.isBefore(x,l):!this.isAfter(x,l))&&(D?this.isAfter(u,l):!this.isBefore(u,l))}}}))})(H)),H.exports}var os=ns();const ds=ve(os);F.extend(is);F.extend(ds);const ae=({auth:f,title:S,summary:w,jurisdictions:k,inCharges:m})=>{const c=G("(min-width: 1025px)"),h=G("(min-width: 641px) and (max-width: 1024px)"),l=G("(max-width: 640px)"),o=()=>{if(typeof window>"u")return"lg";const b=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12px",N=parseInt(b);return N===0?"none":N<=4?"sm":N<=8?"md":N<=16?"lg":"full"},[x]=y.useState(w),[u,I]=y.useState(w),[D,$]=y.useState(!1),[s,t]=y.useState(null),[r,i]=y.useState(!1),p=y.useCallback(a=>{t(a)},[]),v=y.useCallback(()=>{t(null)},[]),d=y.useMemo(()=>!x||x.length===0?[]:x.map(a=>F(a.date)).filter(a=>a.isValid()),[x]),R=y.useCallback((a,b,N,Q="name")=>{if(!a||a.length===0)return e.jsx("span",{className:"text-default-400 text-xs",children:N});const J=a.map(String),_=b?.filter(j=>J.includes(String(j.id))).map(j=>j[Q])??[];return _.length===0?e.jsx("span",{className:"text-default-400 text-xs",children:N}):e.jsx("div",{className:"flex flex-wrap gap-1",children:_.map(j=>e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-primary/10 text-primary",children:j},j))})},[]),W=y.useMemo(()=>k?.map(a=>({...a,displayLabel:`${a.start_chainage} - ${a.end_chainage}`}))??[],[k]),[n,g]=y.useState({startDate:d.length>0?F.min(...d).format("YYYY-MM-DD"):F().subtract(30,"days").format("YYYY-MM-DD"),endDate:d.length>0?F.max(...d).format("YYYY-MM-DD"):F().format("YYYY-MM-DD"),status:"all",incharge:[],jurisdiction:[]}),z=y.useCallback(async()=>{$(!0);try{const a={startDate:n.startDate,endDate:n.endDate};n.incharge?.length&&(a.incharge=n.incharge),n.jurisdiction?.length&&(a.jurisdiction=n.jurisdiction);const N=(await ke.post(Re("daily-works-summary.filter"),a)).data?.summaries??[];return I(N),!0}catch(a){console.error("Failed to load filtered summary:",a);const b=a.response?.data?.error||"Failed to load summary data";return U.error(b),!1}finally{$(!1)}},[n]),re=y.useCallback(async()=>{await z()&&U.success("Summary data refreshed successfully")},[z]),P=y.useCallback((a,b)=>{g(N=>({...N,[a]:b}))},[]),ge=y.useMemo(()=>{const a=u.reduce((_,j)=>_+j.totalDailyWorks,0),b=u.reduce((_,j)=>_+j.completed,0),N=u.reduce((_,j)=>_+j.pending,0),Q=u.reduce((_,j)=>_+j.rfiSubmissions,0),J=a>0?(b/a*100).toFixed(1):0;return[{title:"Total Works",value:a,icon:e.jsx(M,{className:"w-5 h-5"}),color:"text-blue-600",description:"All logged works"},{title:"Completed",value:b,icon:e.jsx(te,{className:"w-5 h-5"}),color:"text-green-600",description:`${J}% completion rate`},{title:"Pending",value:N,icon:e.jsx(ye,{className:"w-5 h-5"}),color:"text-orange-600",description:"In progress"},{title:"RFI Submissions",value:Q,icon:e.jsx(V,{className:"w-5 h-5"}),color:"text-purple-600",description:"Ready for inspection"}]},[u]),je=[{label:"Refresh",icon:e.jsx(ee,{className:"w-4 h-4"}),variant:"flat",color:"primary",onPress:re,isLoading:D,className:"bg-linear-to-r from-blue-500/20 to-cyan-500/20 hover:from-blue-500/30 hover:to-cyan-500/30",ariaLabel:"Refresh daily work summary data"},...f.roles.includes("Administrator")||f.designation==="Supervision Engineer"?[{label:"Export",icon:e.jsx(_e,{className:"w-4 h-4"}),variant:"flat",color:"success",onPress:()=>p("exportDailyWorkSummary"),className:"bg-linear-to-r from-green-500/20 to-emerald-500/20 hover:from-green-500/30 hover:to-emerald-500/30",ariaLabel:"Export daily work summary data"}]:[]];return y.useEffect(()=>{d.length>0&&(!n.startDate||!n.endDate)&&g(a=>({...a,startDate:F.min(...d).format("YYYY-MM-DD"),endDate:F.max(...d).format("YYYY-MM-DD")}))},[d]),y.useEffect(()=>{z()},[z]),e.jsxs(e.Fragment,{children:[e.jsx(Se,{title:S}),s==="exportDailyWorkSummary"&&e.jsx(ss,{open:s==="exportDailyWorkSummary",closeModal:v,filteredData:u,inCharges:m}),e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(ie.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full max-w-[2000px]",children:e.jsxs(A,{className:"transition-all duration-200",radius:o(),style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))",background:`linear-gradient(135deg, 
                                var(--theme-content1, #FAFAFA) 20%, 
                                var(--theme-content2, #F4F4F5) 10%, 
                                var(--theme-content3, #F1F3F4) 20%)`},children:[e.jsx(Ze,{className:"border-b p-0",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                    color-mix(in srgb, var(--theme-content1) 50%, transparent) 20%, 
                                    color-mix(in srgb, var(--theme-content2) 30%, transparent) 10%)`},children:e.jsx("div",{className:`${c?"p-6":h?"p-4":"p-3"} w-full`,children:e.jsx("div",{className:"flex flex-col space-y-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsx("div",{className:`
                                                    ${c?"p-3":h?"p-2.5":"p-2"} 
                                                    rounded-xl flex items-center justify-center
                                                `,style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsx(M,{className:`
                                                        ${c?"w-8 h-8":h?"w-6 h-6":"w-5 h-5"}
                                                    `,style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:`
                                                        ${c?"text-2xl":h?"text-xl":"text-lg"}
                                                        font-bold text-foreground
                                                        ${c?"":"truncate"}
                                                    `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Daily Work Summary"}),e.jsx("p",{className:`
                                                        ${c?"text-sm":"text-xs"} 
                                                        text-default-500
                                                        ${c?"":"truncate"}
                                                    `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Overview of daily work statistics and progress"})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{className:"flex items-center gap-2",children:je.map((a,b)=>e.jsx(Y,{size:c?"md":"sm",variant:a.variant||"flat",color:a.color||"primary",startContent:a.icon,onPress:a.onPress,isLoading:a.isLoading,className:`${a.className||""} font-medium`,radius:o(),"aria-label":a.ariaLabel||a.label,style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)"},children:a.label},b))})})]})})})}),e.jsxs(B,{className:"pt-6",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(Te,{stats:ge,isLoading:D}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"w-5 h-5 text-default-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Quick Filters:"})]}),e.jsx("div",{className:"flex gap-2 items-end",children:e.jsx(Ke,{variant:"bordered",radius:o(),className:"bg-white/5",children:e.jsxs(Y,{isIconOnly:l,color:r?"primary":"default",onPress:()=>i(!r),className:r?"bg-primary/20":"bg-white/5","aria-label":r?"Hide advanced filters":"Show advanced filters",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(Ce,{className:"w-4 h-4"}),!l&&e.jsx("span",{className:"ml-1",children:"Advanced Filters"})]})})})]}),e.jsx(De,{children:r&&e.jsx(ie.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx("div",{className:"p-4 bg-white/5 backdrop-blur-md rounded-lg border border-white/10",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(fe,{type:"date",label:"Start Date",value:n.startDate,onChange:a=>P("startDate",a.target.value),size:"sm",variant:"bordered",radius:o(),"aria-label":"Select start date",classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                                             focus-within:bg-content2/90 border-divider/50 
                                                                             hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'}}),e.jsx(fe,{type:"date",label:"End Date",value:n.endDate,onChange:a=>P("endDate",a.target.value),size:"sm",variant:"bordered",radius:o(),"aria-label":"Select end date",classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                                             focus-within:bg-content2/90 border-divider/50 
                                                                             hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'}}),(f.roles.includes("Administrator")||f.roles.includes("Super Administrator")||f.designation==="Supervision Engineer")&&e.jsx(ce,{label:"In Charge",placeholder:"Select in charge...",selectionMode:"multiple",selectedKeys:new Set(n.incharge||[]),onSelectionChange:a=>{const b=Array.from(a);P("incharge",b),b.length>0&&P("jurisdiction",[])},variant:"bordered",size:"sm",radius:o(),startContent:e.jsx(Xe,{className:"w-4 h-4 text-default-400"}),classNames:{trigger:"text-sm min-h-unit-10",value:"text-foreground",listboxWrapper:"bg-content1",popoverContent:"bg-content1"},renderValue:()=>R(n.incharge,m,"Select in charge..."),style:{fontFamily:'var(--fontFamily, "Inter")'},"aria-label":"Filter by in charge",children:m.map(a=>e.jsx(pe,{value:String(a.id),children:a.name},String(a.id)))}),(f.roles.includes("Administrator")||f.roles.includes("Super Administrator")||f.designation==="Supervision Engineer")&&e.jsx(ce,{label:"Jurisdiction",placeholder:"Select jurisdiction...",selectionMode:"multiple",selectedKeys:new Set(n.jurisdiction||[]),onSelectionChange:a=>{const b=Array.from(a);P("jurisdiction",b),b.length>0&&P("incharge",[])},variant:"bordered",size:"sm",radius:o(),startContent:e.jsx(se,{className:"w-4 h-4 text-default-400"}),classNames:{trigger:"text-sm min-h-unit-10",value:"text-foreground",listboxWrapper:"bg-content1",popoverContent:"bg-content1"},renderValue:()=>R(n.jurisdiction,W,"Select jurisdiction...","displayLabel"),style:{fontFamily:'var(--fontFamily, "Inter")'},"aria-label":"Filter by jurisdiction",children:W?.map(a=>e.jsx(pe,{value:String(a.id),children:a.displayLabel},String(a.id)))}),e.jsx("div",{className:"flex items-end",children:e.jsx(Y,{size:"sm",variant:"flat",color:"danger",onPress:()=>{g({startDate:d.length>0?F.min(...d).format("YYYY-MM-DD"):F().subtract(30,"days").format("YYYY-MM-DD"),endDate:d.length>0?F.max(...d).format("YYYY-MM-DD"):F().format("YYYY-MM-DD"),status:"all",incharge:[],jurisdiction:[]})},style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Clear Filters"})})]})})})})]})}),e.jsx(A,{radius:o(),className:"bg-content1/80 backdrop-blur-md border border-divider/20",style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)",border:"var(--borderWidth, 1px) solid var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                        color-mix(in srgb, var(--theme-content1) 90%, transparent) 20%, 
                                        color-mix(in srgb, var(--theme-content2) 60%, transparent) 10%)`},children:e.jsx(B,{className:"p-0",style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsx(es,{filteredData:u,onRefresh:re,loading:D})})})]})]})})})]})};ae.layout=f=>e.jsx(Ie,{children:f});const Os=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"})),Vs=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"}));export{Os as D,Vs as I};
