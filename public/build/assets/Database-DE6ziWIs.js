import{r as o,j as e,H as T,c as D,a as I,F as S,b as x,e as P}from"./app-D_-WVEdp.js";import{s as g}from"./routeUtils-Ck7DPZCW.js";import{s as j}from"./toastUtils-ycRu2wJH.js";import{F as _}from"./CircleStackIcon-sq1Godj6.js";import{F as v}from"./CheckCircleIcon-BLFfNgko.js";import{c as k}from"./chunk-C6WKGNND-DzOcfHNA.js";import{i as c}from"./chunk-SQIAVXJX-BbTP8Q49.js";import"./app-Bq-q9uAS.js";import"./index-C2EWbGBu.js";import"./chunk-KQW2TNLT-CWiQ5bkd.js";import"./index-C-9Wnuxw.js";import"./chunk-ICU6NNET-CTByTmgN.js";import"./useLabel-sAk_8DNM.js";import"./useLabels-CUZ0Yc-W.js";function J({title:N,currentConfig:u}){const[n,w]=o.useState("lg"),[l,y]=o.useState({host:u?.host||"localhost",port:u?.port||"3306",database:u?.database||"",username:u?.username||"",password:""}),[t,p]=o.useState({}),[m,f]=o.useState(!1),[h,b]=o.useState(!1);o.useEffect(()=>{w((()=>{const i=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12px",a=parseInt(i);return a===0?"none":a<=4?"sm":a<=8?"md":a<=12?"lg":"xl"})())},[]);const d=(s,r)=>{y(i=>({...i,[s]:r})),t[s]&&p(i=>({...i,[s]:""})),b(!1)},C=async()=>{p({});const s=new Promise(async(r,i)=>{try{f(!0);const a=await P.post(route("install.test-database"),l);a.data.success?(b(!0),r([a.data.message])):i([a.data.message])}catch(a){a.response?.data?.errors&&p(a.response.data.errors),i(a.response?.data?.message?[a.response.data.message]:["Connection failed"])}finally{f(!1)}});j.promise(s,{loading:"Testing database connection...",success:r=>r.join(", "),error:r=>Array.isArray(r)?r.join(", "):r})},R=()=>{if(!h){j.error("Please test the database connection first");return}g("install.application")};return e.jsxs(e.Fragment,{children:[e.jsx(T,{title:N}),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-content1 to-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-4xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-primary font-semibold",children:"Step 3 of 6"}),e.jsx("span",{className:"text-default-500",children:"Database Configuration"})]}),e.jsx("div",{className:"mt-2 h-2 bg-default-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary rounded-full",style:{width:"50%"}})})]}),e.jsxs(D,{children:[e.jsx(k,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{className:"w-8 h-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Database Configuration"}),e.jsx("p",{className:"text-sm text-default-600 mt-1",children:"Configure your database connection"})]})]})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(c,{label:"Database Host",placeholder:"localhost or IP address",value:l.host,onValueChange:s=>d("host",s),isInvalid:!!t.host,errorMessage:t.host,isRequired:!0,radius:n,classNames:{inputWrapper:"bg-default-100"}})}),e.jsx(c,{type:"number",label:"Port",placeholder:"3306",value:l.port,onValueChange:s=>d("port",s),isInvalid:!!t.port,errorMessage:t.port,isRequired:!0,radius:n,classNames:{inputWrapper:"bg-default-100"}})]}),e.jsx(c,{label:"Database Name",placeholder:"aero_db",value:l.database,onValueChange:s=>d("database",s),isInvalid:!!t.database,errorMessage:t.database,isRequired:!0,radius:n,classNames:{inputWrapper:"bg-default-100"},description:"The database must already exist"}),e.jsx(c,{label:"Database Username",placeholder:"root",value:l.username,onValueChange:s=>d("username",s),isInvalid:!!t.username,errorMessage:t.username,isRequired:!0,radius:n,classNames:{inputWrapper:"bg-default-100"}}),e.jsx(c,{type:"password",label:"Database Password",placeholder:"Enter password",value:l.password,onValueChange:s=>d("password",s),isInvalid:!!t.password,errorMessage:t.password,radius:n,classNames:{inputWrapper:"bg-default-100"},description:"Leave empty if no password"}),h&&e.jsx("div",{className:"p-4 bg-success/10 border border-success/20 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{className:"w-6 h-6 text-success flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-success",children:"Connection Successful"}),e.jsxs("p",{className:"text-sm text-default-700 dark:text-default-300 mt-0.5",children:["Successfully connected to database: ",e.jsx("strong",{children:l.database})]})]})]})}),e.jsx("div",{className:"p-4 bg-warning/10 border border-warning/20 rounded-lg",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(S,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-warning mb-1",children:"Important"}),e.jsxs("ul",{className:"space-y-1 text-default-700 dark:text-default-300",children:[e.jsx("li",{children:"• The database must be created before installation"}),e.jsx("li",{children:"• Make sure the user has full privileges on the database"}),e.jsx("li",{children:"• Test the connection before proceeding"})]})]})]})}),e.jsx("div",{children:e.jsx(x,{color:"secondary",variant:"flat",radius:n,onPress:C,isLoading:m,className:"w-full",children:m?"Testing Connection...":"Test Database Connection"})}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx(x,{variant:"flat",radius:n,onPress:()=>g("install.requirements"),isDisabled:m,children:"Back"}),e.jsx(x,{color:"primary",radius:n,onPress:R,isDisabled:!h||m,endContent:e.jsx(v,{className:"w-5 h-5"}),children:"Continue"})]})]})})]})]})})]})}export{J as default};
