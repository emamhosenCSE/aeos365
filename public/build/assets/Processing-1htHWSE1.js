import{r as l,e as b,j as e,H as N,c as w,a as v,s as y}from"./app-BAXRlJ48.js";import{s as S}from"./routeUtils-B8YzhDEw.js";import{s as I}from"./toastUtils-CgpXtHQI.js";import{F as i}from"./ExclamationCircleIcon-_eLwtUSB.js";import{F as o}from"./CheckCircleIcon-DpGmT_VL.js";import{F}from"./CogIcon-C-fAMeKY.js";import{c as k}from"./chunk-C6WKGNND-CJZl1JMF.js";import{p as C}from"./chunk-VFIJPDYX-CnqB3wTu.js";import"./app-Bq-q9uAS.js";import"./index-1fQ0x8g_.js";import"./useProgressBar-CgE7BD74.js";import"./number-CB4zbwAz.js";import"./useLabel-B3fAPYpc.js";import"./useLabels-pxb2sUWj.js";import"./useNumberFormatter-CPGSRRsJ.js";import"./NumberFormatter-DNR9MAW-.js";function Y({title:g}){const[a,d]=l.useState(0),[u,c]=l.useState(""),[t,f]=l.useState(!1),[r,p]=l.useState(!1),[m,h]=l.useState("");l.useEffect(()=>{j()},[]);const j=async()=>{try{const s=await b.post(route("install.process"));if(s.data.success)f(!0),d(100),c("Installation completed successfully!"),setTimeout(()=>{window.location.href=s.data.redirect||route("login")},2e3);else throw new Error(s.data.message||"Installation failed")}catch(s){p(!0),h(s.response?.data?.message||s.message||"Installation failed"),I.error(m)}};return l.useEffect(()=>{if(!t&&!r){const s=[{progress:10,message:"Validating license..."},{progress:20,message:"Running database migrations..."},{progress:40,message:"Seeding core data..."},{progress:60,message:"Creating admin user..."},{progress:75,message:"Storing license information..."},{progress:85,message:"Syncing modules..."},{progress:95,message:"Writing configuration files..."},{progress:99,message:"Finalizing installation..."}];let n=0;const x=setInterval(()=>{n<s.length?(d(s[n].progress),c(s[n].message),n++):clearInterval(x)},1500);return()=>clearInterval(x)}},[t,r]),e.jsxs(e.Fragment,{children:[e.jsx(N,{title:g}),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-content1 to-background flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-4xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-primary font-semibold",children:"Step 6 of 6"}),e.jsx("span",{className:"text-default-500",children:"Installation in Progress"})]}),e.jsx("div",{className:"mt-2 h-2 bg-default-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary rounded-full",style:{width:"100%"}})})]}),e.jsxs(w,{children:[e.jsx(k,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[r?e.jsx(i,{className:"w-8 h-8 text-danger"}):t?e.jsx(o,{className:"w-8 h-8 text-success"}):e.jsx(F,{className:"w-8 h-8 text-primary animate-spin"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:r?"Installation Failed":t?"Installation Complete!":"Installing..."}),e.jsx("p",{className:"text-sm text-default-600 mt-1",children:r?"An error occurred during installation":t?"Redirecting to login page...":"Please wait while we set up your system"})]})]})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-8",children:[!r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:u}),e.jsxs("span",{className:"text-sm font-semibold text-primary",children:[a,"%"]})]}),e.jsx(C,{value:a,color:t?"success":"primary",size:"lg",className:"max-w-full"})]}),e.jsx("div",{className:"space-y-3",children:[{name:"License Validation",done:a>10},{name:"Database Migrations",done:a>20},{name:"Core Data Seeding",done:a>40},{name:"Admin User Creation",done:a>60},{name:"License Storage",done:a>75},{name:"Module Synchronization",done:a>85},{name:"Configuration Files",done:a>95},{name:"Finalization",done:a===100}].map((s,n)=>e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg transition-all ${s.done?"bg-success/10 text-success":a>=(n+1)*12.5-5?"bg-primary/10 text-primary":"bg-default-50 text-default-500"}`,children:[s.done?e.jsx(o,{className:"w-5 h-5 flex-shrink-0"}):a>=(n+1)*12.5-5?e.jsx(y,{size:"sm",color:"current"}):e.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-current flex-shrink-0"}),e.jsx("span",{className:"font-medium",children:s.name})]},n))})]}),r&&e.jsx("div",{className:"p-6 bg-danger/10 border-2 border-danger/20 rounded-lg",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx(i,{className:"w-8 h-8 text-danger flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-danger mb-2",children:"Installation Error"}),e.jsx("p",{className:"text-default-700 dark:text-default-300 mb-4",children:m}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-danger text-white rounded-lg hover:bg-danger/90 transition-colors",children:"Try Again"}),e.jsx("button",{onClick:()=>S("install.index"),className:"px-4 py-2 bg-default-200 text-foreground rounded-lg hover:bg-default-300 transition-colors",children:"Start Over"})]})]})]})}),t&&e.jsxs("div",{className:"p-6 bg-success/10 border-2 border-success/20 rounded-lg text-center",children:[e.jsx(o,{className:"w-16 h-16 text-success mx-auto mb-4"}),e.jsx("h3",{className:"text-2xl font-bold text-success mb-2",children:"Installation Successful!"}),e.jsx("p",{className:"text-default-700 dark:text-default-300",children:"Your system has been installed successfully. Redirecting to login page..."})]}),!r&&!t&&e.jsx("div",{className:"p-4 bg-warning/10 border border-warning/20 rounded-lg",children:e.jsxs("p",{className:"text-sm text-warning-700 dark:text-warning flex items-center gap-2",children:[e.jsx(i,{className:"w-5 h-5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Please do not close this window"})," or navigate away until the installation is complete."]})]})})]})})]})]})})]})}export{Y as default};
