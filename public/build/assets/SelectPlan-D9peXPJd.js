import{u as U,r as w,f as H,j as e,H as W,c as j,e as g,d as f,L as q,b as G}from"./app-BrpQ0UwM.js";import{A as v}from"./AuthCard-Do8-IJ4V.js";import{R as J}from"./RegisterLayout-DkEykFun.js";import{u as K}from"./useBranding-qv63WW7j.js";import{s as Q}from"./toastUtils-DmXWeOL1.js";import{P as V}from"./ProgressSteps-CeVuo-P5.js";import{F as X}from"./CheckCircleIcon-DJpbJfJ6.js";import{d as o}from"./chunk-IHO36JMK-xRSFIery.js";import{s as Z}from"./chunk-I3A4XRYQ-CfGUc_10.js";import{c as M}from"./chunk-C6WKGNND-CkI8tRvQ.js";import{t as ee}from"./chunk-WEIB4WXA-DikSLtkc.js";import"./app-Dxe9AM1M.js";import"./index-DGjdlXV7.js";/* empty css                      */import"./MaintenanceModeBanner-Cxhu4lEL.js";import"./chunk-AUA5GDXN-BodSRBst.js";import"./index-CpUThtir.js";import"./index-DRhHtkcR.js";import"./chunk-WQVQ7P2I-hHnQawC0.js";import"./number-CB4zbwAz.js";import"./chunk-LGMZDQT5-CSsa5DzI.js";import"./ArrowLeftIcon-Cdc1HrjB.js";import"./useToggleState-B-2VEJIj.js";import"./chunk-ICU6NNET-JgRCpHuB.js";import"./chunk-KQW2TNLT-Ex180OOD.js";import"./useLabel-CGwDFWJ-.js";import"./useLabels-DLWWaVRl.js";function ke({steps:R=[],currentStep:E,savedData:F={},plans:$=[],modules:_=[],modulePricing:P={}}){const x=F?.plan??{},S=Array.isArray($)?$:[],N=Array.isArray(_)?_:[],{data:a,setData:h,post:D,processing:k,errors:p}=U({billing_cycle:x.billing_cycle??"monthly",plan_id:x.plan_id??null,modules:Array.isArray(x.modules)?x.modules:[],notes:x.notes??""}),{siteName:O}=K(),T=l=>{a.plan_id===l?h({...a,plan_id:null}):h({...a,plan_id:l,modules:[]})},z=l=>{const i=Array.isArray(a.modules)?a.modules:[],d=i.includes(l)?i.filter(m=>m!==l):[...i,l];h({...a,modules:d,plan_id:null})},c=a.billing_cycle==="yearly",t=S.find(l=>l.id===a.plan_id),r=Array.isArray(a.modules)?a.modules:[],C=c?P.yearly??200:P.monthly??20,y=t?c?t.yearly_price:t.monthly_price:0,b=!t&&r.length>0?r.length*C:0,A=t?y:b,u=w.useMemo(()=>N.filter(l=>r.includes(l.id)),[N,r]),L=w.useMemo(()=>{const l=!!a.plan_id,i=Array.isArray(a.modules)&&a.modules.length>0,d=l||i;return console.log("hasSelection check:",{hasPlan:l,hasModules:i,result:d,plan_id:a.plan_id,modules:a.modules}),d},[a.plan_id,a.modules]),B=l=>{if(l.preventDefault(),!L){Q.warning("Please select a plan or at least one module to continue.");return}D(route("platform.register.plan.store"))},{themeSettings:I}=H(),n=I?.mode==="dark",s=w.useMemo(()=>({heading:n?"text-white":"text-slate-900",copy:n?"text-slate-300":"text-slate-600",badge:n?"text-slate-300":"text-slate-500",card:n?"border border-white/10 bg-white/5":"border border-slate-200 bg-white shadow-sm",selectedCard:n?"border border-emerald-400/60 bg-emerald-500/10":"border border-emerald-200 bg-emerald-50",surface:n?"bg-white/5 border border-white/10":"bg-white border border-slate-200 shadow-sm",link:n?"text-white/80 hover:text-white":"text-slate-600 hover:text-slate-900",muted:n?"text-slate-400":"text-slate-500",accent:n?"text-white":"text-slate-900"}),[n]);return e.jsxs(J,{children:[e.jsx(W,{title:`Choose modules - ${O}`}),e.jsxs("section",{className:"max-w-6xl mx-auto px-4 sm:px-6 py-6 sm:py-12 space-y-6 sm:space-y-8",children:[e.jsxs("div",{className:"space-y-2 sm:space-y-3 text-center",children:[e.jsx("p",{className:`text-[10px] sm:text-sm uppercase tracking-[0.3em] ${s.badge}`,children:"Step 4"}),e.jsx("h1",{className:`text-2xl sm:text-4xl font-semibold ${s.heading} px-2`,children:"Choose Your Plan & Modules"}),e.jsx("p",{className:`${s.copy} text-sm sm:text-base px-2`,children:"Select a pre-configured plan or customize with individual modules. Core platform features are always included."})]}),e.jsx(V,{steps:R,currentStep:E}),e.jsxs("div",{className:"grid gap-4 sm:gap-6 lg:grid-cols-[2fr,1fr]",children:[e.jsx("div",{className:"lg:hidden order-first",children:e.jsx(v,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsx("p",{className:`text-xs sm:text-sm uppercase tracking-[0.3em] ${s.badge}`,children:"Total Estimate"}),e.jsxs("h2",{className:`text-2xl sm:text-3xl font-semibold ${s.heading}`,children:["$",A.toLocaleString()]})]}),e.jsxs("p",{className:`text-xs sm:text-sm ${s.copy}`,children:["Per ",c?"year":"month"]}),e.jsx(o,{}),e.jsxs("div",{className:"space-y-2 text-xs sm:text-sm",children:[t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:s.copy,children:[t.name," Plan"]}),e.jsxs("span",{className:s.heading,children:["$",y.toLocaleString()]})]}),e.jsxs("p",{className:`text-xs ${s.muted}`,children:["Includes ",t.modules?.length||0," modules"]})]}):r.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:s.copy,children:[r.length," Custom Module",r.length!==1?"s":""]}),e.jsxs("span",{className:s.heading,children:["$",b.toLocaleString()]})]}),e.jsx("p",{className:`text-xs ${s.muted}`,children:"Custom plan"})]}):e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:s.copy,children:"No selection"}),e.jsx("span",{className:s.muted,children:"$0"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:s.copy,children:"Core Platform"}),e.jsx("span",{className:"text-emerald-500",children:"Free"})]})]}),e.jsx(o,{}),(t||u.length>0)&&e.jsxs("div",{children:[e.jsx("p",{className:`text-xs font-semibold ${s.muted} mb-2`,children:"YOUR SELECTION:"}),e.jsx("ul",{className:`text-xs space-y-1 ${s.copy}`,children:t?t.modules&&t.modules.map(l=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-1.5 w-1.5 rounded-full bg-blue-400"}),l.name]},l.id)):u.map(l=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-1.5 w-1.5 rounded-full bg-emerald-400"}),l.name]},l.id))})]})]})})}),e.jsx(v,{children:e.jsxs("form",{onSubmit:B,className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsx("p",{className:`text-xs sm:text-sm ${s.muted}`,children:"Billing cadence"}),e.jsxs("div",{className:`flex items-center gap-2 text-xs sm:text-sm ${s.copy}`,children:[e.jsx("span",{className:c?s.muted:`font-semibold ${s.heading}`,children:"Monthly"}),e.jsx(Z,{isSelected:c,onChange:()=>h("billing_cycle",c?"monthly":"yearly"),color:"secondary","aria-label":"Toggle billing cycle",size:"sm"}),e.jsxs("span",{className:c?`font-semibold ${s.heading}`:s.muted,children:["Yearly ",e.jsx("small",{className:"text-emerald-500",children:"(2 mo free)"})]})]})]}),e.jsx(o,{className:"my-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-base sm:text-lg font-semibold ${s.heading}`,children:"1. Choose a Plan"}),e.jsx("p",{className:`text-xs sm:text-sm ${s.copy}`,children:"Pre-configured bundles with modules included"})]}),e.jsx("div",{className:"grid gap-3 sm:gap-4 md:grid-cols-2",children:S.map(l=>{const i=a.plan_id===l.id,d=c?l.yearly_price:l.monthly_price;return e.jsxs(j,{isPressable:!0,onPress:()=>T(l.id),className:i?s.selectedCard:s.card,children:[e.jsxs(M,{className:"flex-col items-start pb-2",children:[e.jsxs("div",{className:"flex items-start justify-between w-full",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:`text-lg sm:text-xl font-bold ${s.heading}`,children:l.name}),l.badge&&e.jsx(g,{size:"sm",color:"primary",variant:"flat",className:"mt-1",children:l.badge})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-xl sm:text-2xl font-bold ${s.heading}`,children:["$",d]}),e.jsxs("p",{className:`text-xs ${s.muted}`,children:["/",c?"year":"month"]})]})]}),e.jsx("p",{className:`text-xs sm:text-sm ${s.copy} mt-2`,children:l.description})]}),e.jsxs(f,{className:"text-xs sm:text-sm space-y-3 pt-2",children:[l.modules&&l.modules.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:`text-xs font-semibold ${s.muted} mb-2`,children:"INCLUDED MODULES:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:l.modules.map(m=>e.jsx(g,{size:"sm",variant:"flat",color:"success",children:m.name},m.id))})]}),l.features&&l.features.length>0&&e.jsx("div",{className:"space-y-1",children:l.features.slice(0,3).map((m,Y)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(X,{className:"h-4 w-4 text-emerald-500 shrink-0 mt-0.5"}),e.jsx("span",{className:s.copy,children:m})]},Y))}),e.jsx("div",{className:"pt-2",children:e.jsx(g,{size:"sm",color:i?"success":"default",variant:i?"solid":"flat",children:i?"âœ“ Selected":"Select Plan"})})]})]},l.id)})})]}),e.jsx(o,{className:"my-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-base sm:text-lg font-semibold ${s.heading}`,children:"2. Or Build Custom with Modules"}),e.jsxs("p",{className:`text-xs sm:text-sm ${s.copy}`,children:["Select individual modules â€¢ $",C,"/",c?"year":"month"," per module"]}),e.jsx("p",{className:`text-xs ${s.muted} mt-1`,children:"ðŸ’¡ Selecting modules will deselect any plan â€¢ Core Platform is always included free"})]}),e.jsx("div",{className:"grid gap-3 sm:gap-4 md:grid-cols-2",children:N.map(l=>{const i=r.includes(l.id);return e.jsxs(j,{isPressable:!0,onPress:()=>z(l.id),className:i?s.selectedCard:s.card,children:[e.jsxs(M,{className:"justify-between pb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-[10px] sm:text-xs uppercase tracking-[0.4em] ${s.muted}`,children:l.category}),e.jsx("h2",{className:`text-base sm:text-xl font-semibold ${s.heading} truncate`,children:l.name})]}),e.jsx(g,{size:"sm",color:i?"success":"default",variant:"flat",className:"text-[10px] sm:text-xs ml-2 shrink-0",children:i?"âœ“ Added":"Add"})]}),e.jsx(f,{className:"text-xs sm:text-sm space-y-2 pt-2",children:e.jsx("p",{className:s.copy,children:l.description})})]},l.id)})})]}),p.modules&&e.jsx("p",{className:"text-sm text-red-400",children:p.modules}),e.jsx(ee,{label:"Implementation notes (optional)",placeholder:"Tell us about integrations, compliance packs, or migration timelines.",minRows:3,value:a.notes,onChange:l=>h("notes",l.target.value),isInvalid:!!p.notes,errorMessage:p.notes,classNames:{label:"text-sm sm:text-base",input:"text-sm sm:text-base"}}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsx(q,{href:route("platform.register.details"),className:`text-xs sm:text-sm transition-colors text-center sm:text-left ${s.link}`,children:"â† Back to details"}),e.jsx(G,{type:"submit",color:"primary",className:"bg-gradient-to-r from-blue-500 to-purple-600 w-full sm:w-auto",isLoading:k,isDisabled:k||!L,children:"Review & launch trial"})]})]})}),e.jsxs("div",{className:"hidden lg:block space-y-4",children:[e.jsx(v,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:`text-sm uppercase tracking-[0.3em] ${s.badge}`,children:"Total Estimate"}),e.jsxs("h2",{className:`text-3xl font-semibold ${s.heading}`,children:["$",A.toLocaleString()]}),e.jsxs("p",{className:`text-sm ${s.copy}`,children:["Per ",c?"year":"month"]}),e.jsx(o,{}),e.jsxs("div",{className:"space-y-2 text-sm",children:[t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:s.copy,children:[t.name," Plan"]}),e.jsxs("span",{className:s.heading,children:["$",y.toLocaleString()]})]}),e.jsxs("p",{className:`text-xs ${s.muted}`,children:["Includes ",t.modules?.length||0," modules"]})]}):r.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:s.copy,children:[r.length," Module",r.length!==1?"s":""]}),e.jsxs("span",{className:s.heading,children:["$",b.toLocaleString()]})]}),e.jsx("p",{className:`text-xs ${s.muted}`,children:"Custom plan"})]}):e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:s.copy,children:"No selection"}),e.jsx("span",{className:s.muted,children:"$0"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:s.copy,children:"Core Platform"}),e.jsx("span",{className:"text-emerald-500",children:"Free"})]})]}),e.jsx(o,{}),(t||u.length>0)&&e.jsxs("div",{children:[e.jsx("p",{className:`text-xs font-semibold ${s.muted} mb-2`,children:"YOUR SELECTION:"}),e.jsx("ul",{className:`text-sm space-y-1 ${s.copy}`,children:t?t.modules&&t.modules.map(l=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-blue-400"}),l.name]},l.id)):u.map(l=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block h-2 w-2 rounded-full bg-emerald-400"}),l.name]},l.id))})]})]})}),e.jsx(j,{className:`${s.surface} text-sm`,children:e.jsxs(f,{className:"space-y-2",children:[e.jsx("p",{className:`font-semibold ${s.heading}`,children:"Flexible Pricing"}),e.jsx("p",{className:s.copy,children:"Choose a pre-configured plan OR build custom with individual modules. Pick what works best for your needs."}),e.jsx("p",{className:"text-emerald-500",children:"Core platform features (auth, users, settings) are always included at no extra cost."})]})})]}),e.jsx("div",{className:"lg:hidden",children:e.jsx(j,{className:`${s.surface} text-xs sm:text-sm`,children:e.jsxs(f,{className:"space-y-2",children:[e.jsx("p",{className:`font-semibold ${s.heading}`,children:"Why modules?"}),e.jsx("p",{className:s.copy,children:"Rolling modules lets finance teams align spend with adoption milestones. You can pause any module in 1 click."}),e.jsx("p",{className:"text-emerald-500",children:"Payment collection happens later. Right now we only need your wish list."})]})})})]})]})]})}export{ke as default};
