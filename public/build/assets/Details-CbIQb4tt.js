import{o as F,r as x,n as q,e as y,j as e,H as A,s as W,g as H,b as O,h as w}from"./app-DLWZL5EI.js";import{h as Y,c as k}from"./routeUtils-C6MiLID5.js";import{S as U}from"./SafeLink-CXDUN-Am.js";import{s as N}from"./toastUtils-CQ8tPw7l.js";import{A as G}from"./AuthCard-DdvAJ2xQ.js";import{R as J}from"./RegisterLayout-B-p4LDca.js";import{u as K}from"./useBranding-C98uB2bk.js";import{P as Q}from"./ProgressSteps-CfbD2vVm.js";import{F as V}from"./CheckCircleIcon-CaJShsm_.js";import{i as u}from"./chunk-SQIAVXJX-C5zDfxFa.js";import"./app-BI-xrU3s.js";import"./chunk-AUA5GDXN-DgHZKZnK.js";import"./index-B5MKI_DQ.js";import"./index-Dz459_my.js";import"./chunk-WQVQ7P2I-BXEU6rr0.js";import"./number-CB4zbwAz.js";import"./chunk-LGMZDQT5-BbUrfslF.js";import"./index-lAyyVki8.js";/* empty css                      */import"./MaintenanceModeBanner-CpiCdC4n.js";import"./ArrowLeftIcon-a6q7R3tQ.js";import"./chunk-KQW2TNLT-BxZBj3py.js";import"./useField-CN4URFK6.js";import"./useLabel-BC4q2FsI.js";import"./useLabels-CKC_NELL.js";import"./chunk-ICU6NNET-BuoRM2Mj.js";function Se({steps:S=[],currentStep:C,savedData:R={},accountType:h="company",baseDomain:z="platform.test",existingSubdomain:b=null}){const l=R?.details??{},{data:r,setData:m,processing:X,errors:a,setError:_,clearErrors:$}=F({name:l.name??"",email:l.email??"",phone:l.phone??"",subdomain:l.subdomain??"",team_size:l.team_size??""}),[L,v]=x.useState(!1),[o,n]=x.useState({checking:!1,available:null,message:""}),[j,T]=x.useState(null),{themeSettings:B}=q(),d=B?.mode==="dark",{siteName:E}=K(),p={heading:d?"text-white":"text-slate-900",copy:d?"text-slate-300":"text-slate-600",badge:d?"text-slate-300":"text-slate-500",link:d?"text-white/80 hover:text-white":"text-slate-600 hover:text-slate-900"};x.useEffect(()=>{j&&clearTimeout(j);const s=r.subdomain.trim().toLowerCase();if(!s||s.length<3||!/^[a-z0-9]+(?:-[a-z0-9]+)*$/.test(s)){n({checking:!1,available:null,message:""});return}if(b&&s===b.toLowerCase()){n({checking:!1,available:!0,message:"Reserved for your registration"});return}const c=setTimeout(async()=>{n({checking:!0,available:null,message:""});try{const t=await y.post("/api/platform/v1/check-subdomain",{subdomain:s});n({checking:!1,available:t.data.available,message:t.data.message||(t.data.available?"Subdomain is available":"Subdomain is taken")})}catch{n({checking:!1,available:null,message:""})}},500);return T(c),()=>clearTimeout(c)},[r.subdomain,b]);const I=s=>{if(s.preventDefault(),!Y("platform.register.details.store")){N.error("Registration route not available");return}$(),v(!0);const c=new Promise(async(t,D)=>{try{const i=await y.post(k("platform.register.details.store"),r);(i.status===200||i.status===201)&&(t([i.data.message||"Details saved successfully"]),i.data.redirect?w.visit(i.data.redirect):w.visit(k("platform.register.modules")))}catch(i){if(i.response?.status===422){const g=i.response.data.errors||{};Object.keys(g).forEach(f=>{_(f,g[f][0]||g[f])})}D([i.response?.data?.message||"Failed to save details"])}finally{v(!1)}});N.promise(c,{loading:"Saving details...",success:t=>t[0],error:t=>t[0]})},M=h==="individual"?"Your name":"Organization name",P=s=>s.replace(/[^\d+]/g,"");return e.jsxs(J,{children:[e.jsx(A,{title:`Workspace details - ${E}`}),e.jsxs("section",{className:"max-w-5xl mx-auto px-4 sm:px-6 py-6 sm:py-12 space-y-6 sm:space-y-8",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4 text-center",children:[e.jsx("p",{className:`text-[10px] sm:text-sm uppercase tracking-[0.3em] ${p.badge}`,children:"Step 2"}),e.jsxs("h1",{className:`text-2xl sm:text-4xl font-semibold ${p.heading} px-2`,children:["Tell us about ",h==="individual"?"you":"your company","."]}),e.jsx("p",{className:`${p.copy} text-sm sm:text-base px-2`,children:"We will use this to pre-configure branding, subdomain, and trial communications."})]}),e.jsx(Q,{steps:S,currentStep:C}),e.jsx(G,{children:e.jsxs("form",{onSubmit:I,className:"space-y-4 sm:space-y-5",children:[e.jsx(u,{label:M,placeholder:"Acme Manufacturing",value:r.name,onChange:s=>m("name",s.target.value),isInvalid:!!a.name,errorMessage:a.name,isRequired:!0,classNames:{label:"text-sm sm:text-base",input:"text-sm sm:text-base"}}),e.jsxs("div",{className:"grid gap-3 sm:gap-4 md:grid-cols-2",children:[e.jsx(u,{type:"email",label:"Work email",placeholder:"ops@acme.com",value:r.email,onChange:s=>m("email",s.target.value),isInvalid:!!a.email,errorMessage:a.email,isRequired:!0,classNames:{label:"text-sm sm:text-base",input:"text-sm sm:text-base"}}),e.jsx(u,{label:"Phone (optional)",placeholder:"+1 415 555 0110",value:r.phone,onChange:s=>m("phone",P(s.target.value)),isInvalid:!!a.phone,errorMessage:a.phone,description:"International format recommended (e.g., +1 234 567 8900)",classNames:{label:"text-sm sm:text-base",input:"text-sm sm:text-base",description:"text-xs sm:text-sm"}})]}),e.jsxs("div",{className:"grid gap-3 sm:gap-4 md:grid-cols-[2fr,1fr]",children:[e.jsx(u,{label:"Preferred subdomain",placeholder:"acme",value:r.subdomain,onChange:s=>m("subdomain",s.target.value.toLowerCase()),isInvalid:!!a.subdomain||o.available===!1,errorMessage:a.subdomain||(o.available===!1?o.message:""),description:`Your workspace URL will be https://${r.subdomain||"team"}.${z}`,isRequired:!0,endContent:o.checking?e.jsx(W,{size:"sm"}):o.available===!0?e.jsx(V,{className:"w-5 h-5 text-success"}):o.available===!1?e.jsx(H,{className:"w-5 h-5 text-danger"}):null,classNames:{label:"text-sm sm:text-base",input:"text-sm sm:text-base",description:"text-xs sm:text-sm"}}),e.jsx(u,{type:"number",label:"Team size",placeholder:"120",value:r.team_size,onChange:s=>m("team_size",s.target.value),isInvalid:!!a.team_size,errorMessage:a.team_size,min:1,classNames:{label:"text-sm sm:text-base",input:"text-sm sm:text-base"}})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsx(U,{route:"platform.register.index",className:`text-xs sm:text-sm transition-colors text-center sm:text-left ${p.link}`,children:"‚Üê Back to account type"}),e.jsx(O,{color:"primary",className:"bg-gradient-to-r from-blue-500 to-purple-600 w-full sm:w-auto",type:"submit",isLoading:L,children:"Continue to modules"})]})]})})]})]})}export{Se as default};
