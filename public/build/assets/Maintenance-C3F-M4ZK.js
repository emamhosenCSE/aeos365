import{u as $,r,o as A,j as e,H as D,c as O,b as m,a as U,d as V,F as j,i as T,K as B,p as L}from"./app-D_-WVEdp.js";import{a1 as z,a2 as y,b as G,A as H}from"./App-BUqmM69P.js";import{s as o}from"./toastUtils-ycRu2wJH.js";import{h as K}from"./routeUtils-Ck7DPZCW.js";import{F as q}from"./CheckCircleIcon-C2VXk29s.js";import{F as w}from"./GlobeAltIcon-BVaR4Go0.js";import{F as J}from"./EnvelopeIcon-B5LB3FMs.js";import{F as Q}from"./useMediaQuery-C9RChyNu.js";import{F as X}from"./KeyIcon-D3_yGPtU.js";import{F as Y}from"./CheckCircleIcon-BLFfNgko.js";import{u as Z}from"./index-UttBzQzf.js";import{c as ee}from"./chunk-C6WKGNND-DzOcfHNA.js";import{s as F}from"./chunk-I3A4XRYQ-CJNCN2D_.js";import{t as ae}from"./chunk-WEIB4WXA-Cf-_iQ3U.js";import{i as p}from"./chunk-SQIAVXJX-BbTP8Q49.js";import{t as se}from"./chunk-AUA5GDXN-DN3ZdlyW.js";import{m as te,a as ne,b as re,c as ie}from"./chunk-TW2E3XVA-DRRpZ_vq.js";import{m as le}from"./chunk-5LXTSPS7-BCVKdAIS.js";import"./app-Bq-q9uAS.js";import"./index-C2EWbGBu.js";/* empty css                      */import"./chunk-CV4BWJDJ-ubOVN7k0.js";import"./index-BMj_EV_H.js";import"./index-C-9Wnuxw.js";import"./UserIcon-DG_m3xOa.js";import"./PlusIcon-Wgugrc1t.js";import"./Item-Ch9OZUIQ.js";import"./SelectionManager-CzEWbMHf.js";import"./keyboard-DoUdRS-l.js";import"./index-D0ogoVNn.js";import"./useDialog-Bepqadre.js";import"./VisuallyHidden-CaSP2WVB.js";import"./useLabels-CUZ0Yc-W.js";import"./chunk-WQVQ7P2I-CH5xj4JM.js";import"./number-CB4zbwAz.js";import"./index-DuLqXBZP.js";import"./useSelectableItem-CAanJG1T.js";import"./chunk-IHO36JMK-YsOKRYLU.js";import"./useTreeState-Dj6IqKyS.js";import"./useMenuTriggerState-D2QDUooS.js";import"./chunk-LGMZDQT5-CaoNqm2A.js";import"./Cog6ToothIcon-BzVYBKqR.js";import"./useBranding-FxIvTb8a.js";import"./XMarkIcon-BK1rKcmr.js";import"./MagnifyingGlassIcon-D7Etcgwr.js";import"./chunk-C3QHEOC2-DMWTZzTs.js";import"./chunk-KQW2TNLT-CWiQ5bkd.js";import"./chunk-ICU6NNET-CTByTmgN.js";import"./useLabel-sAk_8DNM.js";import"./chunk-Y5DMIIWQ-BglIhMCb.js";import"./index-BtQx179R.js";import"./chunk-7F3ZLNJ6-DX5LVLf8.js";import"./ShieldCheckIcon-BLU0gJd0.js";import"./AcademicCapIcon-xgHPIwrg.js";import"./IdentificationIcon-Cu2MddKv.js";import"./ArrowLeftIcon-CvMFTAF3.js";import"./ArrowRightIcon-kv-hNwLM.js";import"./BriefcaseIcon-CF6Ga2Jm.js";import"./BuildingOfficeIcon-BrPL7Obv.js";import"./CalendarDaysIcon-Bilw7IDH.js";import"./CalendarIcon-D76uPrFV.js";import"./CircleStackIcon-sq1Godj6.js";import"./ClipboardDocumentCheckIcon-CsJTImGS.js";import"./CogIcon-BM4nqP1_.js";import"./DeviceTabletIcon-bWEFcPGg.js";import"./CpuChipIcon-C7Wik64O.js";import"./CurrencyDollarIcon-BBdTvttm.js";import"./DevicePhoneMobileIcon-B6WELNSk.js";import"./DocumentArrowUpIcon-CNWCHCFU.js";import"./DocumentIcon-DRP7gf4p.js";import"./ExclamationCircleIcon-CbzXbbTB.js";import"./EyeIcon-BZ3EeyCC.js";import"./InformationCircleIcon-BG0xleBU.js";import"./LockClosedIcon-CZ2l7lkR.js";import"./MapPinIcon-DnmorOoN.js";import"./PlusCircleIcon-CkLCtasO.js";import"./PrinterIcon-BDYQGnJT.js";import"./RocketLaunchIcon-BjdNoNLN.js";import"./ShoppingCartIcon-u6hM1Mzd.js";import"./UserCircleIcon-Ht8vglkG.js";import"./UserGroupIcon-DqCPR-Xy.js";import"./MaintenanceModeBanner-Ced2Il-8.js";import"./index-DolG8St_.js";import"./useToggleState-Dg72h8QO.js";const ce={border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',background:`linear-gradient(135deg, 
    var(--theme-content1, #FAFAFA) 20%, 
    var(--theme-content2, #F4F4F5) 10%, 
    var(--theme-content3, #F1F3F4) 20%)`},oe={borderColor:"var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
    color-mix(in srgb, var(--theme-content1) 50%, transparent) 20%, 
    color-mix(in srgb, var(--theme-content2) 30%, transparent) 10%)`},d={background:"color-mix(in srgb, var(--theme-content2) 50%, transparent)",border:"1px solid color-mix(in srgb, var(--theme-content3) 50%, transparent)",borderRadius:"var(--borderRadius, 12px)"},de=()=>{const{title:f="System Maintenance",settings:l={}}=$().props,{isOpen:C,onOpen:b,onClose:x}=Z(),[h,N]=r.useState(""),[v,_]=r.useState(!1),u=A({maintenance_mode:l.maintenance_mode??!1,maintenance_message:l.maintenance_message??"We are currently performing scheduled maintenance. We'll be back shortly.",maintenance_bypass_secret:l.maintenance_bypass_secret??"",maintenance_bypass_ips:l.maintenance_bypass_ips??[],maintenance_allowed_paths:l.maintenance_allowed_paths??["/api/health","/status"],maintenance_ends_at:l.maintenance_ends_at??"",maintenance_skip_verification:l.maintenance_skip_verification??!1}),{data:s,setData:t,processing:R,errors:n}=u,g=s.maintenance_bypass_secret?`${window.location.origin}?bypass=${s.maintenance_bypass_secret}`:"No bypass secret configured",k=r.useCallback(a=>{a?b():t("maintenance_mode",!1)},[b,t]),M=r.useCallback(()=>{h.toUpperCase()==="DOWN"?(t("maintenance_mode",!0),N(""),x()):o.error('Please type "DOWN" to confirm.')},[h,t,x]),S=r.useCallback(async()=>{if(!s.maintenance_bypass_secret){o.error("No bypass secret configured.");return}try{await navigator.clipboard.writeText(g),_(!0),o.success("Bypass URL copied to clipboard!"),setTimeout(()=>_(!1),2e3)}catch{o.error("Failed to copy to clipboard.")}},[g,s.maintenance_bypass_secret]),W=r.useCallback(a=>{if(a.preventDefault(),!K("admin.developer.maintenance.update")){console.error("Route admin.developer.maintenance.update not found"),o.error("Navigation route not found. Please contact support.");return}const i=route("admin.developer.maintenance.update");u.put(i,{preserveScroll:!0,onSuccess:()=>{o.success("Maintenance settings updated successfully.")},onError:c=>{o.error("Failed to update maintenance settings.")}})},[u]),E=r.useCallback(()=>{const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let i="";for(let c=0;c<32;c++)i+=a.charAt(Math.floor(Math.random()*a.length));t("maintenance_bypass_secret",i)},[t]),P=r.useCallback(a=>{const i=a.split(",").map(c=>c.trim()).filter(Boolean);t("maintenance_bypass_ips",i)},[t]),I=r.useCallback(a=>{const i=a.split(",").map(c=>c.trim()).filter(Boolean);t("maintenance_allowed_paths",i)},[t]);return e.jsxs(e.Fragment,{children:[e.jsx(D,{title:`${f} - Admin`}),e.jsx("div",{className:"mx-auto w-full max-w-6xl space-y-6 px-4 py-6 md:px-6",children:e.jsxs(O,{className:"transition-all duration-200",style:ce,children:[e.jsx(ee,{className:"border-b p-0",style:oe,children:e.jsx("div",{className:"p-6 w-full",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl flex items-center justify-center",style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsx(z,{className:"w-8 h-8",style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-2xl font-bold text-foreground",children:"System Maintenance"}),e.jsx("p",{className:"text-sm text-default-500",children:"Control platform-wide maintenance mode and bypass settings."})]})]}),e.jsx("div",{className:"flex gap-3",children:e.jsx(m,{color:"primary",type:"submit",form:"maintenance-form",isLoading:R,children:"Save Settings"})})]})})}),e.jsx(U,{className:"p-6",children:e.jsxs("form",{id:"maintenance-form",onSubmit:W,className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",style:d,children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{className:"w-6 h-6 text-default-500"}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-semibold text-foreground",children:"Maintenance Mode Status"}),e.jsx("p",{className:"text-sm text-default-500",children:"Enable to put the platform in maintenance mode"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{color:s.maintenance_mode?"danger":"success",variant:"flat",startContent:s.maintenance_mode?e.jsx(j,{className:"w-4 h-4"}):e.jsx(q,{className:"w-4 h-4"}),children:s.maintenance_mode?"Down":"Online"}),e.jsx(F,{isSelected:s.maintenance_mode,onValueChange:k,color:"danger",size:"lg"})]})]}),s.maintenance_mode&&e.jsx("div",{className:"mt-4 p-4 bg-danger-50 dark:bg-danger-900/20 border border-danger-200 dark:border-danger-800 rounded-lg",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(T,{className:"w-5 h-5 text-danger shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-danger",children:"Platform is currently in maintenance mode"}),e.jsx("p",{className:"text-xs text-danger/80 mt-1",children:"Only administrators and bypass IPs can access the platform."})]})]})})]})}),e.jsx("div",{className:"space-y-4",style:d,children:e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{className:"w-6 h-6 text-default-500"}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-semibold text-foreground",children:"Maintenance Message"}),e.jsx("p",{className:"text-sm text-default-500",children:"Message displayed to users during maintenance"})]})]}),e.jsx(ae,{value:s.maintenance_message,onValueChange:a=>t("maintenance_message",a),placeholder:"Enter maintenance message...",minRows:3,maxRows:6,isInvalid:!!n.maintenance_message,errorMessage:n.maintenance_message,classNames:{inputWrapper:"bg-default-100"}})]})}),e.jsx("div",{className:"space-y-4",style:d,children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(G,{className:"w-6 h-6 text-default-500"}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-semibold text-foreground",children:"Skip Registration Verification"}),e.jsx("p",{className:"text-sm text-default-500",children:"Allow tenant registration without email/phone verification during maintenance"})]})]}),e.jsx(F,{isSelected:s.maintenance_skip_verification,onValueChange:a=>t("maintenance_skip_verification",a),color:"warning"})]}),s.maintenance_skip_verification&&e.jsx("div",{className:"mt-4 p-4 bg-warning-50 dark:bg-warning-900/20 border border-warning-200 dark:border-warning-800 rounded-lg",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(j,{className:"w-5 h-5 text-warning shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-warning",children:"Verification Override Enabled"}),e.jsx("p",{className:"text-xs text-warning/80 mt-1",children:"New tenants can register without email or phone verification. This is useful for testing and emergency access during maintenance."}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:"Email verification: Skipped"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:"Phone verification: Skipped"})]})]})]})]})})]})}),e.jsx("div",{className:"space-y-4",style:d,children:e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(X,{className:"w-6 h-6 text-default-500"}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-semibold text-foreground",children:"Bypass Secret"}),e.jsx("p",{className:"text-sm text-default-500",children:"Secret key to bypass maintenance mode via URL parameter"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{value:s.maintenance_bypass_secret,onValueChange:a=>t("maintenance_bypass_secret",a),placeholder:"Enter bypass secret or generate one...",isInvalid:!!n.maintenance_bypass_secret,errorMessage:n.maintenance_bypass_secret,classNames:{inputWrapper:"bg-default-100"}}),e.jsx(m,{onPress:E,variant:"flat",color:"primary",children:"Generate"})]}),s.maintenance_bypass_secret&&e.jsx("div",{className:"p-4 bg-default-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-default-500 mb-1",children:"Bypass URL:"}),e.jsx("code",{className:"text-xs text-primary break-all",children:g})]}),e.jsx(se,{content:v?"Copied!":"Copy URL",children:e.jsx(m,{isIconOnly:!0,size:"sm",variant:"flat",onPress:S,children:v?e.jsx(Y,{className:"w-4 h-4 text-success"}):e.jsx(B,{className:"w-4 h-4"})})})]})})]})}),e.jsx("div",{className:"space-y-4",style:d,children:e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{className:"w-6 h-6 text-default-500"}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-semibold text-foreground",children:"Bypass IP Addresses"}),e.jsx("p",{className:"text-sm text-default-500",children:"IP addresses that can bypass maintenance mode (comma-separated)"})]})]}),e.jsx(p,{value:s.maintenance_bypass_ips.join(", "),onValueChange:P,placeholder:"e.g., 192.168.1.1, 10.0.0.5",isInvalid:!!n.maintenance_bypass_ips,errorMessage:n.maintenance_bypass_ips,classNames:{inputWrapper:"bg-default-100"}})]})}),e.jsx("div",{className:"space-y-4",style:d,children:e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{className:"w-6 h-6 text-default-500"}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-semibold text-foreground",children:"Allowed Paths During Maintenance"}),e.jsx("p",{className:"text-sm text-default-500",children:"URL paths accessible during maintenance (comma-separated)"})]})]}),e.jsx(p,{value:s.maintenance_allowed_paths.join(", "),onValueChange:I,placeholder:"e.g., /api/health, /status",isInvalid:!!n.maintenance_allowed_paths,errorMessage:n.maintenance_allowed_paths,classNames:{inputWrapper:"bg-default-100"}})]})}),e.jsx("div",{className:"space-y-4",style:d,children:e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(L,{className:"w-6 h-6 text-default-500"}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-semibold text-foreground",children:"Maintenance End Time"}),e.jsx("p",{className:"text-sm text-default-500",children:"Expected time when maintenance will be completed (optional)"})]})]}),e.jsx(p,{type:"datetime-local",value:s.maintenance_ends_at,onValueChange:a=>t("maintenance_ends_at",a),isInvalid:!!n.maintenance_ends_at,errorMessage:n.maintenance_ends_at,classNames:{inputWrapper:"bg-default-100"}})]})})]})})]})}),e.jsx(te,{isOpen:C,onOpenChange:x,size:"md",children:e.jsxs(ne,{children:[e.jsx(re,{className:"flex flex-col gap-1",children:e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(j,{className:"w-6 h-6 text-danger"}),"Enable Maintenance Mode"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-default-600",children:"This will put the entire platform into maintenance mode. All users will be unable to access the platform except:"}),e.jsxs("ul",{className:"text-sm text-default-600 list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Administrators"}),e.jsx("li",{children:"Users with bypass secret URL"}),e.jsx("li",{children:"Whitelisted IP addresses"})]}),e.jsx("div",{className:"p-3 bg-warning-50 dark:bg-warning-900/20 border border-warning-200 dark:border-warning-800 rounded-lg",children:e.jsxs("p",{className:"text-sm text-warning font-medium",children:["Type ",e.jsx("code",{className:"font-bold",children:"DOWN"})," to confirm"]})}),e.jsx(p,{value:h,onValueChange:N,placeholder:"Type DOWN to confirm",autoFocus:!0,classNames:{inputWrapper:"bg-default-100"}})]})}),e.jsxs(le,{children:[e.jsx(m,{variant:"flat",onPress:x,children:"Cancel"}),e.jsx(m,{color:"danger",onPress:M,isDisabled:h.toUpperCase()!=="DOWN",children:"Enable Maintenance Mode"})]})]})})]})};de.layout=f=>e.jsx(H,{children:f});export{de as default};
