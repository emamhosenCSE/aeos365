import{j as e,c as R,d as D,e as _,i as X,m as Y,r as m,H as Z,b as S,a as F,l as B,n as ee}from"./app-BgLDHKD5.js";import{f as se,C as re,d as te,S as ae,v as ie,u as ne,a as le,D as oe,c as ce,b as de,P as me}from"./sortable.esm-CywiSem2.js";import{ax as xe,H as ue,A as pe}from"./App-BLAqmwS6.js";import{s as E}from"./toastUtils-BNhE9Iis.js";import{F as P}from"./UserIcon-DNXzhSFB.js";import{F as fe}from"./EnvelopeIcon-B2myAiRN.js";import{F as he}from"./useMediaQuery-BCnhnKQl.js";import{F as A}from"./BriefcaseIcon-u73wngdx.js";import{F as je}from"./CurrencyDollarIcon-BAmAi9T-.js";import{a as ge}from"./chunk-CV4BWJDJ-CsOxvlE0.js";import{t as ve}from"./chunk-AUA5GDXN-CAdDS_WJ.js";import{f as ye}from"./formatDistanceToNow-Ctx6mZEP.js";import{c as Ne}from"./chunk-C6WKGNND-CpssHcIg.js";import{e as we,c as be}from"./PlusIcon-D6Tj7H5D.js";import{F as Ce}from"./MagnifyingGlassIcon-Ct6-sQNR.js";import{i as M}from"./chunk-SQIAVXJX-DugKAYQw.js";import{s as _e}from"./chunk-C3QHEOC2-DNZVOdE7.js";import{l as j}from"./chunk-Y5DMIIWQ-2tjh77nl.js";import"./app-C-p_Tn8z.js";import"./index-DI_AwbxB.js";/* empty css                      */import"./Cog6ToothIcon-CsenpQUg.js";import"./GlobeAltIcon-CTxJGQnd.js";import"./useBranding-C65_JTpu.js";import"./useDialog-d0JlCXQo.js";import"./VisuallyHidden-DfcTUDcY.js";import"./keyboard-B-V9b_KK.js";import"./useLabels-DJ0HKh0e.js";import"./index-XHa8MJ7V.js";import"./index-C0LFpLkW.js";import"./XMarkIcon-BLiRCMNE.js";import"./chunk-IHO36JMK-Co593kHn.js";import"./ShieldCheckIcon-CwbA8j02.js";import"./AcademicCapIcon-BlNCJFso.js";import"./IdentificationIcon-DQu_CliU.js";import"./ArrowLeftIcon-DNCnAkQZ.js";import"./ArrowRightIcon-CLIzBL2V.js";import"./BuildingOfficeIcon-CH9whcGy.js";import"./CalendarDaysIcon-DbWkASxK.js";import"./CalendarIcon-B3ZFqrwD.js";import"./CheckCircleIcon-Bx3V6FX_.js";import"./CircleStackIcon-pFM9Df7P.js";import"./ClipboardDocumentCheckIcon-DKBioCS4.js";import"./DeviceTabletIcon-BzdU6r8j.js";import"./CpuChipIcon-CdGZNarJ.js";import"./DevicePhoneMobileIcon-DYfp6LIW.js";import"./DocumentArrowUpIcon-Dpo2QuTi.js";import"./DocumentIcon-BXAJ1SJe.js";import"./EyeIcon-DsMwQBlM.js";import"./InformationCircleIcon-DpkmGhiq.js";import"./KeyIcon-My9tLW6Z.js";import"./LockClosedIcon-Dh0D95DT.js";import"./MapPinIcon-DS6lt_-c.js";import"./PlusCircleIcon-qUA34NMH.js";import"./PrinterIcon-p9n680Io.js";import"./UserCircleIcon-z3spLwac.js";import"./UserGroupIcon-B47M43x5.js";import"./chunk-TW2E3XVA-Cb7yT6qr.js";import"./useHasTabbableChild-D2Pt5zKJ.js";import"./chunk-LGMZDQT5-g02rWVWq.js";import"./useSelectableItem-DlKrrjUl.js";import"./SelectionManager-BeAVY9QI.js";import"./Item-DUISq_BA.js";import"./MaintenanceModeBanner-DDeZw4RE.js";import"./index-gMWORm7q.js";import"./chunk-WQVQ7P2I-BV9sCLVp.js";import"./number-CB4zbwAz.js";import"./index-Cwtf6U0M.js";import"./useTreeState-TZ7jSR0l.js";import"./useMenuTriggerState-Coiprl2o.js";import"./chunk-KQW2TNLT-5PeuWHmZ.js";import"./chunk-ICU6NNET-Cpcb5jR1.js";import"./useLabel-MYEBYnig.js";import"./chunk-7F3ZLNJ6-CFSY3lFt.js";import"./index-BGz-Otn-.js";const I=({application:s,onView:u,isDragging:x=!1,themeRadius:w})=>{const{attributes:b,listeners:p,setNodeRef:d,transform:i,isDragging:h}=se({id:s.id}),t={transform:re.Translate.toString(i),opacity:h?.5:1},f=o=>{try{return ye(new Date(o),{addSuffix:!0})}catch{return o}},k=(o,g="USD")=>o?new Intl.NumberFormat("en-US",{style:"currency",currency:g,minimumFractionDigits:0,maximumFractionDigits:0}).format(o):"Not specified",z=o=>({referral:"success",linkedin:"primary",indeed:"secondary",website:"warning",internal:"default"})[o]||"default";return e.jsx(R,{ref:d,style:t,...b,...p,isPressable:!x,onPress:u,className:`transition-all duration-200 cursor-grab active:cursor-grabbing ${h?"shadow-2xl z-50":"hover:shadow-md"}`,radius:w,children:e.jsxs(D,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx(ge,{name:s.applicant_name,size:"md",src:s.applicant?.avatar,showFallback:!0,fallback:e.jsx(P,{className:"w-5 h-5 text-default-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-semibold text-foreground truncate mb-1",children:s.applicant_name}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.source&&e.jsx(_,{size:"sm",color:z(s.source),variant:"flat",children:s.source}),s.rating&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(xe,{className:"w-3 h-3 text-warning fill-warning"}),e.jsx("span",{className:"text-xs text-default-600",children:s.rating})]})]})]})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[s.email&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-default-600",children:[e.jsx(fe,{className:"w-3.5 h-3.5 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.email})]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-default-600",children:[e.jsx(he,{className:"w-3.5 h-3.5 flex-shrink-0"}),e.jsx("span",{children:s.phone})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[s.experience_years!==null&&e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-primary) 10%, transparent)"},children:[e.jsx(A,{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:"var(--theme-primary)"}}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs font-medium text-foreground",children:[s.experience_years," yrs"]}),e.jsx("div",{className:"text-[10px] text-default-500",children:"Experience"})]})]}),s.expected_salary&&e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-success) 10%, transparent)"},children:[e.jsx(je,{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:"var(--theme-success)"}}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-foreground truncate",children:k(s.expected_salary,s.salary_currency)}),e.jsx("div",{className:"text-[10px] text-default-500",children:"Expected"})]})]})]}),s.skills&&s.skills.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[s.skills.slice(0,3).map((o,g)=>e.jsx(_,{size:"sm",variant:"flat",color:"primary",className:"text-[10px]",children:o},g)),s.skills.length>3&&e.jsxs(_,{size:"sm",variant:"flat",color:"default",className:"text-[10px]",children:["+",s.skills.length-3]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-default-500 pt-2 border-t border-divider",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-3 h-3"}),e.jsxs("span",{children:["Applied ",f(s.application_date||s.created_at)]})]}),s.notice_period!==null&&e.jsx(ve,{content:"Notice Period",children:e.jsxs("span",{className:"text-[10px] text-default-400",children:[s.notice_period," days"]})})]})]})})},Se=({stage:s,color:u,onViewCandidate:x,themeRadius:w})=>{const{setNodeRef:b,isOver:p}=te({id:s.id}),d=s.applications.map(i=>i.id);return e.jsx(Y.div,{layout:!0,className:"flex-shrink-0 w-80",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(R,{ref:b,className:`h-full transition-all duration-200 ${p?"ring-2 ring-primary":""}`,style:{borderRadius:"var(--borderRadius, 12px)",background:p?"color-mix(in srgb, var(--theme-primary) 5%, var(--theme-content1))":"var(--theme-content1)"},children:[e.jsx(Ne,{className:"flex justify-between items-center px-4 py-3 border-b border-divider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:s.name}),e.jsx(ue,{content:s.applications.length,color:u,size:"sm",variant:"flat",children:e.jsx("div",{className:"w-2 h-2"})})]})}),e.jsx(D,{className:"p-3 overflow-y-auto",style:{maxHeight:"calc(100vh - 300px)"},children:e.jsx(ae,{items:d,strategy:ie,children:e.jsx("div",{className:"space-y-3",children:s.applications.length===0?e.jsx("div",{className:"text-center py-8 text-default-400 text-sm",style:{background:"color-mix(in srgb, var(--theme-default-100) 30%, transparent)",borderRadius:"var(--borderRadius, 8px)",border:"2px dashed",borderColor:"var(--theme-default-200)"},children:"Drop candidates here"}):s.applications.map(i=>e.jsx(I,{application:i,onView:()=>x(i),themeRadius:w},i.id))})})})]})})},Fe=({job:s,hiringStages:u,applicationsByStage:x,departments:w,jobTypes:b})=>{const[p,d]=m.useState(null),[i,h]=m.useState([]),[t,f]=m.useState({search:"",source:"",experienceMin:"",experienceMax:"",salaryMin:"",salaryMax:""}),[k,z]=m.useState("kanban"),[o,g]=m.useState(!1),[Me,Re]=m.useState({open:!1,application:null}),[c,V]=m.useState("lg"),L=()=>{if(typeof window>"u")return"lg";const a=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12px",l=parseInt(a);return l===0?"none":l<=4?"sm":l<=8?"md":l<=16?"lg":"full"};m.useEffect(()=>{typeof window<"u"&&V(L())},[]),m.useEffect(()=>{if(u&&x){const r=u.map(a=>({...a,applications:x[a.id]?.applications||[],count:x[a.id]?.count||0}));h(r)}},[u,x]);const T=ne(le(me,{activationConstraint:{distance:8}})),H=r=>{d(r.active.id)},K=async r=>{const{active:a,over:l}=r;if(!l){d(null);return}const v=a.id,y=l.id,C=i.find(n=>n.applications.some(N=>N.id===v));if(!C||C.id===y){d(null);return}const J=i.map(n=>{if(n.id===C.id)return{...n,applications:n.applications.filter(N=>N.id!==v),count:n.count-1};if(n.id===y){const N=C.applications.find(Q=>Q.id===v);return{...n,applications:[...n.applications,{...N,current_stage_id:y}],count:n.count+1}}return n});h(J),d(null);try{await ee.put(route("hr.recruitment.applications.update-stage",{job:s.id,application:v}),{stage_id:y,notes:`Moved to ${i.find(n=>n.id===y)?.name}`}),E.success("Candidate moved successfully")}catch(n){console.error("Error moving candidate:",n),E.error("Failed to move candidate"),h(i)}},O=()=>{d(null)},U=i.map(r=>({...r,applications:r.applications.filter(a=>{if(t.search){const l=t.search.toLowerCase();if(!(a.applicant_name?.toLowerCase().includes(l)||a.email?.toLowerCase().includes(l)||a.phone?.includes(l)))return!1}return!(t.source&&a.source!==t.source||t.experienceMin&&a.experience_years<parseFloat(t.experienceMin)||t.experienceMax&&a.experience_years>parseFloat(t.experienceMax)||t.salaryMin&&a.expected_salary<parseFloat(t.salaryMin)||t.salaryMax&&a.expected_salary>parseFloat(t.salaryMax))})})),$=p?i.flatMap(r=>r.applications).find(r=>r.id===p):null,W=i.reduce((r,a)=>r+a.count,0),q=r=>{F.visit(route("hr.recruitment.applications.show",{job:s.id,application:r.id}))},G=r=>{const a=["default","primary","secondary","warning","success","danger"];return a[r%a.length]||"default"};return e.jsxs(e.Fragment,{children:[e.jsx(Z,{title:`Recruitment Pipeline - ${s.title}`}),e.jsxs("div",{className:"flex flex-col w-full h-full p-4 md:p-6",role:"main",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-foreground mb-2",children:s.title}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-default-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(A,{className:"w-4 h-4"}),s.department?.name]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(P,{className:"w-4 h-4"}),W," candidates"]}),e.jsx(_,{size:"sm",color:s.status==="open"?"success":"default",children:s.status})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{size:"sm",variant:"flat",startContent:e.jsx(B,{className:"w-4 h-4"}),onPress:()=>F.reload(),radius:c,children:"Refresh"}),e.jsx(S,{size:"sm",color:"primary",startContent:e.jsx(we,{className:"w-4 h-4"}),onPress:()=>F.visit(route("hr.recruitment.applications.create",s.id)),radius:c,children:"Add Candidate"})]})]})}),e.jsx(R,{className:"mb-6",radius:c,children:e.jsx(D,{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx(M,{placeholder:"Search candidates...",value:t.search,onValueChange:r=>f({...t,search:r}),startContent:e.jsx(Ce,{className:"w-4 h-4 text-default-400"}),size:"sm",radius:c,className:"md:col-span-2"}),e.jsxs(_e,{placeholder:"Source",selectedKeys:t.source?[t.source]:[],onSelectionChange:r=>f({...t,source:Array.from(r)[0]}),size:"sm",radius:c,children:[e.jsx(j,{children:"All Sources"},""),e.jsx(j,{children:"Referral"},"referral"),e.jsx(j,{children:"LinkedIn"},"linkedin"),e.jsx(j,{children:"Indeed"},"indeed"),e.jsx(j,{children:"Website"},"website"),e.jsx(j,{children:"Other"},"other")]}),e.jsx(M,{type:"number",placeholder:"Min Experience",value:t.experienceMin,onValueChange:r=>f({...t,experienceMin:r}),size:"sm",radius:c,endContent:e.jsx("span",{className:"text-xs text-default-400",children:"yrs"})}),e.jsx(M,{type:"number",placeholder:"Max Experience",value:t.experienceMax,onValueChange:r=>f({...t,experienceMax:r}),size:"sm",radius:c,endContent:e.jsx("span",{className:"text-xs text-default-400",children:"yrs"})}),e.jsx(S,{size:"sm",variant:"flat",startContent:e.jsx(be,{className:"w-4 h-4"}),onPress:()=>f({search:"",source:"",experienceMin:"",experienceMax:"",salaryMin:"",salaryMax:""}),radius:c,children:"Clear"})]})})}),e.jsx("div",{className:"flex-1 overflow-x-auto",children:e.jsxs(oe,{sensors:T,collisionDetection:ce,onDragStart:H,onDragEnd:K,onDragCancel:O,children:[e.jsx("div",{className:"flex gap-4 pb-4 min-w-max",children:U.map((r,a)=>e.jsx(Se,{stage:r,color:G(a),onViewCandidate:q,themeRadius:c},r.id))}),e.jsx(de,{children:$?e.jsx("div",{className:"rotate-3 opacity-90",children:e.jsx(I,{application:$,isDragging:!0,themeRadius:c})}):null})]})})]})]})};Fe.layout=s=>e.jsx(pe,{children:s});export{Fe as default};
