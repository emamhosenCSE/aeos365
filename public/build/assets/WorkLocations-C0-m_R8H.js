import{o as le,r as i,a as de,j as e,b as v,i as $,e as O,l as V,c as D,d as A,F as ce,R as me,H as ue,m as xe}from"./app-B1idACz3.js";import{N as q,z as B,i as W,y as he,A as pe}from"./App-BxA45E4t.js";import{u as S}from"./useMediaQuery-oujQjmbJ.js";import{s as I}from"./toastUtils-CW5B8m6C.js";import{F as P}from"./UserIcon-1qA6iUQn.js";import{F as R}from"./MapPinIcon-CvRrNoqN.js";import{F as X}from"./CheckCircleIcon-znT6UY48.js";import{F as fe}from"./CheckCircleIcon-Dzs_G28W.js";import{F as ge}from"./ExclamationTriangleIcon-BwYwLgrY.js";import{t as H}from"./chunk-AUA5GDXN-Dy7XAS6o.js";import{u as be}from"./chunk-NGIUTAK3-DEWLG6K6.js";import{a as J,s as je}from"./chunk-C3QHEOC2-tt4DAwFy.js";import{t as ve,a as ye,b as Ne,c as we}from"./chunk-F3UDT23P-C-ho-l6F.js";import{t as _e,a as Fe}from"./chunk-YRZGWF2W-DSN9j3G1.js";import{c as ke}from"./chunk-3ZQ3E3XI-CNr1rNkk.js";import{c as Q}from"./chunk-C6WKGNND-DYIi9UqF.js";import{d as Ce,a as Le,b as Se,m as K,F as Re,e as We}from"./PlusIcon-B7YJbjTI.js";import{d as M}from"./chunk-IHO36JMK-_QcGGA4V.js";import{S as Ie}from"./StatsCards-BcTb12h8.js";import{m as G,a as Y,b as Z,c as ee}from"./chunk-TW2E3XVA-DozWYklk.js";import{i as E}from"./chunk-SQIAVXJX-BmeQe73H.js";import{l as Pe}from"./chunk-Y5DMIIWQ-CwpVnCx_.js";import{m as te}from"./chunk-5LXTSPS7-Cw-SP9Ff.js";import{F as $e}from"./MagnifyingGlassIcon-DgboSUq1.js";import"./app-BmhO9GrS.js";import"./index-B22Xm-65.js";/* empty css                      */import"./chunk-CV4BWJDJ-BFly1wX0.js";import"./index-CaNeU5V8.js";import"./index-BvevyAVm.js";import"./Cog6ToothIcon-BTkQVx_H.js";import"./GlobeAltIcon-BXsgRUBL.js";import"./useBranding-BpzGYNdv.js";import"./useDialog-Ch8oEuGx.js";import"./VisuallyHidden-8dXxwzFE.js";import"./keyboard-Ct-gpNNq.js";import"./useLabels-xtEGP3rr.js";import"./index-BvG5LGgQ.js";import"./XMarkIcon-BkS9W9l-.js";import"./ShieldCheckIcon-BVzIZ77z.js";import"./AcademicCapIcon-QvlhCYpE.js";import"./IdentificationIcon-CvziX476.js";import"./ArrowLeftIcon-B39h7gxR.js";import"./ArrowRightIcon-DyVdpuyc.js";import"./BriefcaseIcon-CtncUTGk.js";import"./BuildingOfficeIcon-DRKs9y4o.js";import"./CalendarDaysIcon-CPIWRTu0.js";import"./CalendarIcon-DXmDQodP.js";import"./CircleStackIcon-DdzMQ0P3.js";import"./ClipboardDocumentCheckIcon-DRpcDtD7.js";import"./DeviceTabletIcon--UjnqdVT.js";import"./CpuChipIcon-Czc12K36.js";import"./CurrencyDollarIcon-nhXxeFAs.js";import"./DevicePhoneMobileIcon-BEyIwQb0.js";import"./DocumentArrowUpIcon-1h0_t1N_.js";import"./DocumentIcon-CZnboGRP.js";import"./EnvelopeIcon-B0z_TX9R.js";import"./EyeIcon-Cqrke5l0.js";import"./InformationCircleIcon-DqlZzEsT.js";import"./KeyIcon-EZeCAT5w.js";import"./LockClosedIcon-D4pmCoEC.js";import"./PlusCircleIcon-ChwrtP31.js";import"./PrinterIcon-BAYK2vO7.js";import"./UserCircleIcon-BluwysQc.js";import"./UserGroupIcon-C2aGroqx.js";import"./useHasTabbableChild-D7clvTMF.js";import"./chunk-LGMZDQT5-BFW_lSqD.js";import"./useSelectableItem-2B3SBj_3.js";import"./SelectionManager-CcfpIYkh.js";import"./Item-C3GqwNyW.js";import"./MaintenanceModeBanner-BuwtjklV.js";import"./chunk-WQVQ7P2I-BDe9YmDI.js";import"./number-CB4zbwAz.js";import"./chunk-KQW2TNLT-Cz1cLYHm.js";import"./chunk-ICU6NNET-CXrsm0Bw.js";import"./useLabel-BWLgnRON.js";import"./useMenuTriggerState-ZTP0zge5.js";import"./chunk-7F3ZLNJ6-CMjtQ9ZK.js";import"./chunk-PMMJMDBI-B-BWMVyO.js";import"./useToggleState-DFwZ_RpM.js";import"./index-CcVAKcbs.js";import"./index-BMFea15Y.js";import"./useProgressBar-Bpr0HQnj.js";import"./useNumberFormatter-p89ekOdc.js";import"./NumberFormatter-DNR9MAW-.js";import"./index-BsK0-JqV.js";import"./useTreeState-D7Kaxu17.js";import"./chunk-P7ACKWSP-5o7fRwLF.js";const Ee=({allData:n,setData:y,loading:F,handleClickOpen:c,openModal:s,setCurrentRow:f,users:l,auth:m})=>{const{permissions:u}=le().props.auth;S("(min-width: 1025px)"),S("(min-width: 641px) and (max-width: 1024px)");const N=S("(max-width: 640px)"),x=()=>{if(typeof window>"u")return"lg";const a=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12px",d=parseInt(a);return d===0?"none":d<=4?"sm":d<=8?"md":d<=16?"lg":"full"},w=i.useCallback(()=>{de.reload({only:["jurisdictions"],onSuccess:()=>{I.success("Work locations data refreshed successfully")}})},[]),h=u?.includes("jurisdiction.update")||m?.roles?.includes("Administrator"),g=u?.includes("jurisdiction.delete")||m?.roles?.includes("Administrator"),C=t=>t.incharge_user?{label:"Active",color:"success",icon:e.jsx(fe,{className:"w-3 h-3"})}:{label:"Pending",color:"warning",icon:e.jsx(ge,{className:"w-3 h-3"})},L=({location:t})=>{const a=C(t);return e.jsxs(D,{className:"mb-4 bg-content1/80 backdrop-blur-md",children:[e.jsx(Q,{className:"pb-2",children:e.jsxs("div",{className:"flex items-start justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(R,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h6",{className:"font-semibold text-foreground truncate",children:t.location}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsx(O,{size:"sm",variant:"flat",color:a.color,startContent:a.icon,children:a.label})})]})]}),(h||g)&&e.jsxs(Ce,{placement:"bottom-end",children:[e.jsx(Le,{children:e.jsx(v,{variant:"light",size:"sm",isIconOnly:!0,className:"text-default-400",children:e.jsx(he,{className:"w-4 h-4"})})}),e.jsxs(Se,{"aria-label":"Location actions",children:[h&&e.jsx(K,{startContent:e.jsx(q,{className:"w-4 h-4"}),onPress:()=>{f(t),s("editWorkLocation")},children:"Edit Location"},"edit"),g&&e.jsx(K,{className:"text-danger",color:"danger",startContent:e.jsx(B,{className:"w-4 h-4"}),onPress:()=>c(t.id,"deleteWorkLocation"),children:"Delete Location"},"delete")]})]})]})}),e.jsx(M,{}),e.jsx(A,{className:"pt-3",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4 text-default-400"}),e.jsxs("span",{className:"text-sm text-default-500",children:["Chainage: ",t.start_chainage," - ",t.end_chainage]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4 text-default-400"}),e.jsxs("span",{className:"text-sm text-default-500",children:["Incharge: ",t.incharge_user?.name||"Not assigned"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4 text-default-400"}),e.jsxs("span",{className:"text-sm text-default-500",children:["Created: ",new Date(t.created_at).toLocaleDateString()]})]})]})})]},t.id)},j=[{name:"Location",uid:"location",icon:R,sortable:!0},{name:"Start Chainage",uid:"start_chainage",icon:W,sortable:!0},{name:"End Chainage",uid:"end_chainage",icon:W,sortable:!0},{name:"Incharge",uid:"incharge",icon:P,sortable:!0},{name:"Status",uid:"status",icon:X,sortable:!1},{name:"Created",uid:"created_at",icon:$,sortable:!0},...h||g?[{name:"Actions",uid:"actions",sortable:!1}]:[]],o=i.useCallback((t,a)=>{const d=t[a];switch(a){case"location":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1 rounded bg-primary/10",children:e.jsx(R,{className:"w-3 h-3 text-primary"})}),e.jsx("span",{className:"font-medium text-foreground",children:d})]});case"start_chainage":case"end_chainage":return e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{className:"text-sm font-medium text-foreground",children:d})});case"incharge":return e.jsx("div",{className:"flex items-center gap-2",children:t.incharge_user?e.jsx(be,{name:t.incharge_user.name,description:t.incharge_user.email,avatarProps:{size:"sm",name:t.incharge_user.name,className:"bg-primary/10 text-primary"}}):e.jsxs("div",{className:"flex items-center gap-2 text-default-400",children:[e.jsx(P,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Not assigned"})]})});case"status":const b=C(t);return e.jsx(O,{size:"sm",variant:"flat",color:b.color,startContent:b.icon,children:b.label});case"created_at":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{className:"text-sm text-default-500",children:new Date(d).toLocaleDateString()})]});case"actions":return e.jsxs("div",{className:"flex items-center gap-2",children:[h&&e.jsx(H,{content:"Edit location",children:e.jsx(v,{variant:"light",size:"sm",isIconOnly:!0,onPress:()=>{f(t),s("editWorkLocation")},children:e.jsx(q,{className:"w-4 h-4"})})}),g&&e.jsx(H,{content:"Delete location",color:"danger",children:e.jsx(v,{variant:"light",size:"sm",isIconOnly:!0,color:"danger",onPress:()=>c(t.id,"deleteWorkLocation"),children:e.jsx(B,{className:"w-4 h-4"})})})]});default:return e.jsx("span",{children:d})}},[h,g,f,s,c]);return N?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-default-700",children:"Work Locations"}),e.jsx(v,{variant:"flat",color:"primary",size:"sm",radius:x(),style:{backgroundColor:"rgba(var(--color-primary), 0.1)",borderColor:"rgba(var(--color-primary), 0.3)",color:"var(--color-text)"},onClick:w,startContent:e.jsx(V,{className:"w-4 h-4"}),children:"Refresh"})]}),e.jsx(J,{className:"max-h-[70vh]",children:n?.map(t=>e.jsx(L,{location:t},t.id))})]}):e.jsxs("div",{className:"max-h-[84vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-default-700",children:"Work Locations"}),e.jsx(v,{variant:"flat",color:"primary",size:"sm",radius:x(),style:{backgroundColor:"rgba(var(--color-primary), 0.1)",borderColor:"rgba(var(--color-primary), 0.3)",color:"var(--color-text)"},onClick:w,startContent:e.jsx(V,{className:"w-4 h-4"}),children:"Refresh"})]}),e.jsx(J,{className:"max-h-[70vh]",children:e.jsxs(ve,{isStriped:!0,selectionMode:"none",isCompact:!0,isHeaderSticky:!0,removeWrapper:!0,"aria-label":"Work Locations Management Table",classNames:{wrapper:"min-h-[200px]",table:"min-h-[300px]",thead:"[&>tr]:first:shadow-small bg-default-100/80",tbody:"divide-y divide-default-200/50",tr:"group hover:bg-default-50/50 transition-colors h-12",td:"py-2 px-3 text-sm",th:"py-2 px-3 text-xs font-semibold"},children:[e.jsx(_e,{columns:j,children:t=>e.jsx(Fe,{align:t.uid==="actions"?"center":"start",className:"bg-default-100/80 backdrop-blur-md",children:e.jsxs("div",{className:"flex items-center gap-1",children:[t.icon&&e.jsx(t.icon,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs font-semibold",children:t.name})]})},t.uid)}),e.jsx(ye,{items:n||[],emptyContent:"No work locations found",isLoading:F,loadingContent:e.jsx(ke,{size:40}),children:t=>e.jsx(Ne,{children:a=>e.jsx(we,{children:o(t,a)},a)},t.id)})]})})]})},U=({modalType:n,open:y,closeModal:F,setData:c,currentRow:s,users:f})=>{const[l,m]=i.useState({location:"",start_chainage:"",end_chainage:"",incharge:""}),[u,N]=i.useState(!1),[x,w]=i.useState({}),h=()=>{if(typeof window>"u")return"lg";const t=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12px",a=parseInt(t);return a===0?"none":a<=4?"sm":a<=8?"md":a<=16?"lg":"full"};i.useEffect(()=>{m(n==="update"&&s?{location:s.location||"",start_chainage:s.start_chainage||"",end_chainage:s.end_chainage||"",incharge:s.incharge||""}:{location:"",start_chainage:"",end_chainage:"",incharge:""}),w({})},[n,s,y]);const g=(o,t)=>{m(a=>({...a,[o]:t})),x[o]&&w(a=>({...a,[o]:null}))},C=()=>{const o={};return l.location.trim()||(o.location="Location name is required"),l.start_chainage.trim()||(o.start_chainage="Start chainage is required"),l.end_chainage.trim()||(o.end_chainage="End chainage is required"),l.incharge||(o.incharge="Incharge is required"),w(o),Object.keys(o).length===0},L=async()=>{if(!C())return;N(!0);const o=n==="add"?"/work-locations/add":"/work-locations/update",t="POST",a=n==="update"?{...l,id:s.id}:l;try{const d=await fetch(o,{method:t,headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify(a)}),b=await d.json();d.ok?(c(b.work_locations),I.success(b.message||`Work location ${n==="add"?"added":"updated"} successfully!`),F()):b.error&&typeof b.error=="object"?w(b.error):I.error(b.error||"An error occurred")}catch{I.error("Network error occurred. Please try again.")}finally{N(!1)}},j=()=>{u||F()};return e.jsx(G,{isOpen:y,onClose:j,size:"lg",placement:"center",classNames:{base:"bg-content1",backdrop:"bg-black/50 backdrop-blur-sm",header:"border-b border-divider",footer:"border-t border-divider",closeButton:"hover:bg-default-100 text-default-500 hover:text-default-700"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsx(Y,{children:o=>e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"flex flex-col gap-1",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",color:"var(--theme-primary)"},children:e.jsx(R,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:n==="add"?"Add New Work Location":"Edit Work Location"}),e.jsx("p",{className:"text-sm text-default-500",children:n==="add"?"Create a new work location with jurisdiction details":"Update work location information and assignments"})]})]})}),e.jsx(ee,{className:"py-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground",children:["Location Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(E,{type:"text",placeholder:"Enter work location name",value:l.location,onChange:t=>g("location",t.target.value),variant:"bordered",radius:h(),startContent:e.jsx(R,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                         focus-within:bg-content2/90 border-divider/50 
                                                         hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'},isInvalid:!!x.location,errorMessage:x.location})]}),e.jsx(M,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground",children:["Start Chainage ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(E,{type:"text",placeholder:"e.g., 0+000",value:l.start_chainage,onChange:t=>g("start_chainage",t.target.value),variant:"bordered",radius:h(),startContent:e.jsx(W,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                             focus-within:bg-content2/90 border-divider/50 
                                                             hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'},isInvalid:!!x.start_chainage,errorMessage:x.start_chainage})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground",children:["End Chainage ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(E,{type:"text",placeholder:"e.g., 5+000",value:l.end_chainage,onChange:t=>g("end_chainage",t.target.value),variant:"bordered",radius:h(),startContent:e.jsx(W,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                             focus-within:bg-content2/90 border-divider/50 
                                                             hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")'},isInvalid:!!x.end_chainage,errorMessage:x.end_chainage})]})]}),e.jsx(M,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground",children:["Location Incharge ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(je,{placeholder:"Select an incharge",selectedKeys:l.incharge?[l.incharge.toString()]:[],onSelectionChange:t=>{const a=Array.from(t)[0];g("incharge",a||"")},variant:"bordered",radius:h(),startContent:e.jsx(P,{className:"w-4 h-4 text-default-400"}),classNames:{trigger:`bg-content2/50 hover:bg-content2/70 
                                                     focus-within:bg-content2/90 border-divider/50 
                                                     hover:border-divider data-[focus]:border-primary`,value:"text-foreground"},style:{fontFamily:'var(--fontFamily, "Inter")'},isInvalid:!!x.incharge,errorMessage:x.incharge,children:f?.map(t=>e.jsx(Pe,{value:t.id,textValue:t.name,children:t.name},t.id))})]})]})}),e.jsxs(te,{children:[e.jsx(v,{color:"danger",variant:"light",onPress:j,disabled:u,radius:h(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsx(v,{color:"primary",onPress:L,isLoading:u,radius:h(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:n==="add"?"Add Location":"Update Location"})]})]})})})},De=({open:n,handleClose:y,handleDelete:F})=>{const c=()=>{if(typeof window>"u")return"lg";const l=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12px",m=parseInt(l);return m===0?"none":m<=4?"sm":m<=8?"md":m<=16?"lg":"full"},s=()=>{F(),y()};return e.jsx(G,{isOpen:n,onClose:y,size:"md",placement:"center",classNames:{base:"bg-content1",backdrop:"bg-black/50 backdrop-blur-sm",header:"border-b border-divider",footer:"border-t border-divider",closeButton:"hover:bg-default-100 text-default-500 hover:text-default-700"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsx(Y,{children:f=>e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"flex flex-col gap-1",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-danger/10",children:e.jsx(ce,{className:"w-5 h-5 text-danger"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Delete Work Location"}),e.jsx("p",{className:"text-sm text-default-500",children:"This action cannot be undone"})]})]})}),e.jsx(ee,{className:"py-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-danger/5 border border-danger/20",children:[e.jsx("p",{className:"text-sm text-foreground mb-2",children:"Are you sure you want to delete this work location?"}),e.jsx("p",{className:"text-xs text-default-500",children:"This will permanently remove the work location from the system. Any associated daily works or reports may be affected."})]}),e.jsxs("div",{className:"text-xs text-default-400",children:[e.jsx("strong",{children:"Note:"})," Make sure to reassign any ongoing work or responsibilities before deleting this location."]})]})}),e.jsxs(te,{children:[e.jsx(v,{color:"default",variant:"light",onPress:y,radius:c(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsx(v,{color:"danger",onPress:s,radius:c(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Delete Location"})]})]})})})},Ae=me.memo(({auth:n,title:y,jurisdictions:F,users:c})=>{const s=S("(min-width: 1025px)"),f=S("(min-width: 641px) and (max-width: 1024px)"),l=S("(max-width: 640px)"),m=()=>{if(typeof window>"u")return"lg";const p=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12px",_=parseInt(p);return _===0?"none":_<=4?"sm":_<=8?"md":_<=16?"lg":"full"},[u,N]=i.useState(F||[]),[x,w]=i.useState(!1),[h,g]=i.useState(),[C,L]=i.useState(null),[j,o]=i.useState(null),[t,a]=i.useState(""),d=i.useCallback(r=>{a(r.target.value)},[]),b=()=>{const r=new Promise(async(p,_)=>{try{const k=await fetch("/work-locations/delete",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.head.querySelector('meta[name="csrf-token"]').content},body:JSON.stringify({id:C})});if(k.ok){const ie=await k.json();N(ie.work_locations),p("Work location deleted successfully!")}else _("Failed to delete work location. Please try again.")}catch{_("Failed to delete work location. Please try again.")}});I.promise(r,{pending:"Deleting work location...",success:{render({data:p}){return e.jsx(e.Fragment,{children:p})}},error:{render({data:p}){return e.jsx(e.Fragment,{children:p})}}})},ae=i.useCallback((r,p)=>{L(r),o(p)},[]),re=i.useCallback(()=>{o(null),L(null)},[]),T=i.useCallback(r=>{o(r)},[]),z=i.useCallback(()=>{o(null)},[]),se=i.useMemo(()=>{const r=u.length,p=u.filter(k=>k.incharge_user).length,_=u.filter(k=>!k.incharge_user).length;return[{title:"Total Locations",value:r,icon:e.jsx(Re,{className:"w-5 h-5"}),color:"text-blue-600",description:"All work locations"},{title:"Active",value:p,icon:e.jsx(X,{className:"w-5 h-5"}),color:"text-green-600",description:"With assigned staff"},{title:"Pending",value:_,icon:e.jsx($,{className:"w-5 h-5"}),color:"text-orange-600",description:"Needs assignment"},{title:"Staff",value:c?.length||0,icon:e.jsx(P,{className:"w-5 h-5"}),color:"text-purple-600",description:"Available staff"}]},[u,c]),oe=[...n.roles.includes("Administrator")||n.permissions.includes("jurisdiction.create")?[{label:"Add Location",icon:e.jsx(We,{className:"w-4 h-4"}),onPress:()=>T("addWorkLocation"),className:"bg-linear-to-r from-blue-500 to-purple-500 text-white font-medium"}]:[]],ne=i.useMemo(()=>t?u.filter(r=>r.location?.toLowerCase().includes(t.toLowerCase())||r.start_chainage?.toLowerCase().includes(t.toLowerCase())||r.end_chainage?.toLowerCase().includes(t.toLowerCase())||r.incharge_user?.name?.toLowerCase().includes(t.toLowerCase())):u,[u,t]);return e.jsxs(e.Fragment,{children:[e.jsx(ue,{title:y}),j==="addWorkLocation"&&e.jsx(U,{modalType:"add",open:j==="addWorkLocation",setData:N,closeModal:z,users:c}),j==="editWorkLocation"&&e.jsx(U,{modalType:"update",open:j==="editWorkLocation",currentRow:h,setData:N,closeModal:z,users:c}),j==="deleteWorkLocation"&&e.jsx(De,{open:j==="deleteWorkLocation",handleClose:re,handleDelete:b}),e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full max-w-[2000px]",children:e.jsxs(D,{className:"transition-all duration-200",style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))",background:`linear-gradient(135deg, 
                                var(--theme-content1, #FAFAFA) 20%, 
                                var(--theme-content2, #F4F4F5) 10%, 
                                var(--theme-content3, #F1F3F4) 20%)`},children:[e.jsx(Q,{className:"border-b p-0",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
                                    color-mix(in srgb, var(--theme-content1) 50%, transparent) 20%, 
                                    color-mix(in srgb, var(--theme-content2) 30%, transparent) 10%)`},children:e.jsx("div",{className:`${s?"p-6":f?"p-4":"p-3"} w-full`,children:e.jsx("div",{className:"flex flex-col space-y-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[e.jsx("div",{className:`
                                                    ${s?"p-3":f?"p-2.5":"p-2"} 
                                                    rounded-xl flex items-center justify-center
                                                `,style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsx(R,{className:`
                                                        ${s?"w-8 h-8":f?"w-6 h-6":"w-5 h-5"}
                                                    `,style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:`
                                                        ${s?"text-2xl":f?"text-xl":"text-lg"}
                                                        font-bold text-foreground
                                                        ${s?"":"truncate"}
                                                    `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Work Locations Management"}),e.jsx("p",{className:`
                                                        ${s?"text-sm":"text-xs"} 
                                                        text-default-500
                                                        ${s?"":"truncate"}
                                                    `,style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Manage jurisdictions and work location assignments"})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("div",{className:"flex items-center gap-2",children:oe.map((r,p)=>e.jsx(v,{size:s?"md":"sm",variant:r.variant||"flat",color:r.color||"primary",startContent:r.icon,onPress:r.onPress,className:`${r.className||""} font-medium`,style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)"},children:r.label},p))})})]})})})}),e.jsxs(A,{className:"pt-6",children:[e.jsx(Ie,{stats:se}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"w-full sm:w-auto sm:min-w-[300px]",children:e.jsx(E,{type:"text",placeholder:"Search by location, chainage, or incharge...",value:t,onChange:r=>d(r),variant:"bordered",size:l?"sm":"md",radius:m(),startContent:e.jsx($e,{className:"w-4 h-4 text-default-400"}),classNames:{input:"text-foreground",inputWrapper:`bg-content2/50 hover:bg-content2/70 
                                                         focus-within:bg-content2/90 border-divider/50 
                                                         hover:border-divider data-[focus]:border-primary`},style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)"}})})}),e.jsx(D,{radius:m(),className:"bg-content2/50 backdrop-blur-md border border-divider/30",style:{fontFamily:'var(--fontFamily, "Inter")',borderRadius:"var(--borderRadius, 12px)",backgroundColor:"var(--theme-content2)",borderColor:"var(--theme-divider)"},children:e.jsx(A,{className:"p-4",children:e.jsx(Ee,{allData:ne,setData:N,loading:x,setLoading:w,handleClickOpen:ae,openModal:T,setCurrentRow:g,users:c,auth:n})})})]})]})})})]})});Ae.layout=n=>e.jsx(pe,{children:n});export{Ae as default};
