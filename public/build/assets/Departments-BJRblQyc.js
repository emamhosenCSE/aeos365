import{u as de,r as i,j as e,s as X,b as N,d as P,g as K,e as T,F as Pe,n as Se,H as Ce,m as se,c as re,a as Ie}from"./app-BAXRlJ48.js";import{P as ke}from"./PageHeader-B0Gb2JdX.js";import{S as Re}from"./StatsCards-3BXVjewD.js";import{a0 as A,M as U,v as M,u as Ee,F as J,m as ze,A as Ae,ak as Te,f as Me,L as Oe}from"./App-DPyYvU15.js";import{d as ce}from"./dayjs.min-DcqVRuWz.js";import{N as $e}from"./NoDataMessage-qtBjGr5W.js";import{F as ne}from"./EyeIcon-DAw08-uS.js";import{F as me}from"./CalendarIcon-C7z-hHui.js";import{F as Q}from"./CheckCircleIcon-DpGmT_VL.js";import{F as pe}from"./MapPinIcon-Dwf-7_N3.js";import{F as Be}from"./UserIcon-D4IwKnJn.js";import{F as ue}from"./BuildingOfficeIcon-WjMYh5KD.js";import{t as Le,a as Ye,b as Ve,c as We}from"./chunk-F3UDT23P-CbS6cZJx.js";import{t as He,a as qe}from"./chunk-YRZGWF2W-am2dpIpP.js";import{p as he}from"./chunk-NL7EUJG2-GipAg-Ht.js";import{t as q}from"./chunk-AUA5GDXN-CgSoZYyJ.js";import{d as Ge,a as Ke,b as Ue,m as G,e as Je}from"./PlusIcon-ysjwppa4.js";import{u as le}from"./chunk-NGIUTAK3-BjzX8mQ2.js";import{s as O}from"./toastUtils-CgpXtHQI.js";import{B as ie}from"./building-2-BGpQpPbJ.js";import{B as Qe}from"./briefcase-CJIQFrlD.js";import{m as xe,a as fe,b as ge,c as ve}from"./chunk-TW2E3XVA-YKxZpKyZ.js";import{i as E}from"./chunk-SQIAVXJX-DHcD0NdT.js";import{s as $}from"./chunk-C3QHEOC2-CWWALGR_.js";import{l as S}from"./chunk-Y5DMIIWQ-7yisM25U.js";import{s as Xe}from"./chunk-I3A4XRYQ-CkETcpjJ.js";import{m as be}from"./chunk-5LXTSPS7-D1xxNIgs.js";import{F as Ze}from"./UserGroupIcon-ReqkIs1d.js";import{F as et}from"./MagnifyingGlassIcon-CKEATm1j.js";import{b as tt}from"./chunk-57V4RE7B-DjOoFgxU.js";import"./app-Bq-q9uAS.js";import"./chunk-IHO36JMK-DE6UccOS.js";import"./chunk-P7ACKWSP-D1TjPK16.js";import"./chunk-C6WKGNND-CJZl1JMF.js";import"./index-1fQ0x8g_.js";/* empty css                      */import"./routeUtils-B8YzhDEw.js";import"./chunk-CV4BWJDJ-YDxK8YmD.js";import"./index-BQxk6npT.js";import"./index-D-IZDB6p.js";import"./Cog6ToothIcon-BS9S9AuN.js";import"./GlobeAltIcon-B7g8tGA4.js";import"./useBranding-COW0C88J.js";import"./useDialog-3np8Q49m.js";import"./VisuallyHidden-CG9-RmFy.js";import"./keyboard-oTkO-R2L.js";import"./useLabels-pxb2sUWj.js";import"./index-_s1yLG4v.js";import"./XMarkIcon-CT-5AVBL.js";import"./useMediaQuery-DMFH0ee8.js";import"./ShieldCheckIcon-81Yah9s5.js";import"./AcademicCapIcon-Jeb8Wbls.js";import"./IdentificationIcon-snDdY4-U.js";import"./ArrowLeftIcon-D4-_RCwU.js";import"./ArrowRightIcon-DJMmx1E-.js";import"./BriefcaseIcon-7DLvdql-.js";import"./CalendarDaysIcon-CkNTucfv.js";import"./CircleStackIcon-D6_GwVfd.js";import"./ClipboardDocumentCheckIcon-DYF8QSt6.js";import"./CogIcon-C-fAMeKY.js";import"./DeviceTabletIcon-DGpKNaqu.js";import"./CpuChipIcon-B5kjosh4.js";import"./CurrencyDollarIcon-C8KFUyn1.js";import"./DevicePhoneMobileIcon-0NBhC7WR.js";import"./DocumentArrowUpIcon-BiuaCjv0.js";import"./DocumentIcon-OchpmxNl.js";import"./EnvelopeIcon-oHQ3-eEU.js";import"./ExclamationCircleIcon-_eLwtUSB.js";import"./InformationCircleIcon-BySvtpwC.js";import"./KeyIcon-CdYfCZg4.js";import"./LockClosedIcon-B9yphYj1.js";import"./PlusCircleIcon-CPCIsgiK.js";import"./PrinterIcon-B9IMeb6s.js";import"./RocketLaunchIcon-qQrkTDyk.js";import"./ShoppingCartIcon-Bdub_1jY.js";import"./UserCircleIcon-D9HcMQtS.js";import"./MaintenanceModeBanner-DwAWmFt4.js";import"./useSelectableItem-DMlJJsC7.js";import"./SelectionManager-D9Jz4Bfb.js";import"./chunk-PMMJMDBI-Cn7A2qKu.js";import"./useToggleState-I6NzsThi.js";import"./chunk-ICU6NNET-DodoMyo5.js";import"./index-83xPGo9M.js";import"./chunk-LGMZDQT5-B8Sl4UZV.js";import"./useHasTabbableChild-rX9Jpkgs.js";import"./chunk-7F3ZLNJ6-BNnneC7C.js";import"./index-CzAwltOy.js";import"./index-CokAva9Y.js";import"./chunk-OH2E76JR-BDg-4xQO.js";import"./chunk-WQVQ7P2I-D0_WLrzH.js";import"./number-CB4zbwAz.js";import"./Item-fAa8moyn.js";import"./index-B7eECtKa.js";import"./useTreeState-O2jm2C-5.js";import"./useMenuTriggerState--PujcPTI.js";import"./createLucideIcon-Cg-NULby.js";import"./chunk-KQW2TNLT-B3CXe1GN.js";import"./useLabel-B3fAPYpc.js";const at=({departments:p,onEdit:v,onDelete:_,onView:n,loading:x,isMobile:m,isTablet:u,pagination:y,onPageChange:r,onRowsPerPageChange:h,canEditDepartment:l=!1,canDeleteDepartment:f=!1})=>{const{auth:o}=de().props,F=l||o.permissions?.includes("departments.update")||!1,d=f||o.permissions?.includes("departments.delete")||!1,C=i.useMemo(()=>[{name:"DEPARTMENT",uid:"name"},{name:"CODE",uid:"code",hide:m},{name:"MANAGER",uid:"manager"},{name:"EMPLOYEES",uid:"employees"},{name:"LOCATION",uid:"location",hide:m},{name:"STATUS",uid:"status"},{name:"ESTABLISHED",uid:"established",hide:m||u},{name:"ACTIONS",uid:"actions"}].filter(g=>!g.hide),[m,u]),s=(a,g)=>{switch(g){case"name":return e.jsx(le,{avatarProps:{radius:"lg",fallback:e.jsx(ue,{className:"w-8 h-4"}),size:m?"sm":"md"},name:a.name,description:a.parent?a.parent.name:"Top-level department",classNames:{name:"font-semibold text-foreground text-left",description:"text-default-500 text-left text-xs",wrapper:"justify-start"}});case"code":return e.jsx("div",{children:a.code?e.jsx(P,{size:"sm",variant:"flat",color:"primary",className:"text-xs",children:a.code}):e.jsx("span",{className:"text-default-400 text-xs",children:"-"})});case"manager":return e.jsx("div",{className:"flex items-start ",children:a.manager?e.jsxs(e.Fragment,{children:[e.jsx(le,{avatarProps:{radius:"lg",src:a.manager?.profile_image_url||a.manager?.profile_image,size:"md",fallback:e.jsx(Be,{className:"w-5 h-5"})},classNames:{name:"font-semibold text-foreground text-sm",description:"text-default-500 text-xs"}}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:a.manager.name}),!m&&a.manager.email&&e.jsx("span",{className:"text-xs text-default-400",children:a.manager.email})]})]}):e.jsx("span",{className:"text-default-400 text-xs",children:"Not assigned"})});case"employees":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{children:a.employee_count||0})]});case"location":return e.jsx("div",{className:"flex items-center gap-2",children:a.location?e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{children:a.location})]}):e.jsx("span",{className:"text-default-400 text-xs",children:"-"})});case"status":return e.jsx(P,{size:"sm",variant:a.is_active?"solid":"bordered",color:a.is_active?"success":"danger",startContent:a.is_active?e.jsx(Q,{className:"w-3 h-3"}):e.jsx(K,{className:"w-3 h-3"}),children:a.is_active?"Active":"Inactive"});case"established":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{className:"text-sm",children:a.established_date?ce(a.established_date).format("MMM D, YYYY"):e.jsx("span",{className:"text-default-400 text-xs",children:"-"})})]});case"actions":return e.jsx("div",{className:"flex justify-end items-center",children:m?e.jsxs(Ge,{children:[e.jsx(Ke,{children:e.jsx(N,{isIconOnly:!0,size:"sm",variant:"light",children:e.jsx(Ee,{className:"w-4 h-4"})})}),e.jsxs(Ue,{"aria-label":"Department actions",children:[e.jsx(G,{startContent:e.jsx(ne,{className:"w-4 h-4"}),onPress:()=>n(a),children:"View Details"},"view"),F&&e.jsx(G,{startContent:e.jsx(U,{className:"w-4 h-4"}),onPress:()=>v(a),children:"Edit Department"},"edit"),d&&e.jsx(G,{className:"text-danger",color:"danger",startContent:e.jsx(M,{className:"w-4 h-4"}),isDisabled:a.employee_count>0,onPress:()=>_(a),children:"Delete Department"},"delete")]})]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{content:"View Department",children:e.jsx(N,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground",onPress:()=>n(a),children:e.jsx(ne,{className:"w-4 h-4"})})}),F&&e.jsx(q,{content:"Edit Department",children:e.jsx(N,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-blue-500",onPress:()=>v(a),children:e.jsx(U,{className:"w-4 h-4"})})}),d&&e.jsx(q,{content:a.employee_count>0?"Cannot delete department with employees":"Delete Department",children:e.jsx(N,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-danger",isDisabled:a.employee_count>0,onPress:()=>_(a),children:e.jsx(M,{className:"w-4 h-4"})})})]})});default:return e.jsx("span",{children:a[g]})}},j=()=>!p||!p.data||x?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-white/10",children:[e.jsxs("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(y.currentPage-1)*y.perPage+1," to ",Math.min(y.currentPage*y.perPage,p.total)," of ",p.total," departments"]}),e.jsx(he,{total:Math.ceil(p.total/y.perPage),initialPage:y.currentPage,page:y.currentPage,onChange:r,size:m?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})]});return!x&&(!p||!p.data||p.data.length===0)?e.jsx("div",{className:"w-full",children:e.jsx($e,{message:"No departments found",icon:e.jsx(A,{className:"w-12 h-12 text-default-300"}),description:"Try adjusting your search or filters"})}):e.jsx("div",{className:"w-full",children:e.jsxs(Le,{"aria-label":"Departments table",removeWrapper:!0,classNames:{base:"bg-transparent",th:"bg-white/5 backdrop-blur-md text-default-500 border-b border-white/10 font-medium text-xs",td:"border-b border-white/5 py-3"},bottomContent:j(),children:[e.jsx(He,{columns:C,children:a=>e.jsx(qe,{children:a.name},a.uid)}),e.jsx(Ye,{items:p.data||[],emptyContent:!x&&"No departments found",loadingContent:e.jsx(X,{}),isLoading:x,children:a=>e.jsx(Ve,{children:g=>e.jsx(We,{children:s(a,g)})},a.id)})]})})},oe=({open:p,onClose:v,onSuccess:_,department:n=null,managers:x=[],parentDepartments:m=[]})=>{const[u,y]=i.useState(!1),[r,h]=i.useState({}),l=()=>{if(typeof window>"u")return"lg";const j=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12px",a=parseInt(j);return a===0?"none":a<=4?"sm":a<=8?"md":a<=16?"lg":"full"},f={name:"",code:"",description:"",parent_id:"",manager_id:"",location:"",is_active:!0,established_date:""},[o,F]=i.useState(f);i.useEffect(()=>{F(n?{name:n.name||"",code:n.code||"",description:n.description||"",parent_id:n.parent_id||"",manager_id:n.manager_id||"",location:n.location||"",is_active:n.is_active??!0,established_date:n.established_date||""}:f),h({})},[n,p]);const d=(s,j)=>{F(a=>({...a,[s]:j})),r[s]&&h(a=>({...a,[s]:null}))},C=async s=>{s.preventDefault(),y(!0),h({});const j=new Promise(async(a,g)=>{try{const c={...o,parent_id:o.parent_id||null,manager_id:o.manager_id||null,established_date:o.established_date||null};let w;n?.id?(w=await T.put(`/departments/${n.id}`,c),a([w.data.message||"Department updated successfully"])):(w=await T.post("/departments",c),a([w.data.message||"Department created successfully"])),_(w.data.department),v()}catch(c){if(console.error("Full error object:",c),c.response)if(c.response.status===422){h(c.response.data.errors||{});const w=Object.values(c.response.data.errors||{}).flat();g(w.length>0?w.join(", "):"Validation failed")}else g(`HTTP Error ${c.response.status}: ${c.response.data.message||"An unexpected error occurred"}`);else c.request?g("No response received from the server. Please check your internet connection."):g("An error occurred while setting up the request.")}finally{y(!1)}});O.promise(j,{pending:{render(){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(X,{size:"sm"}),e.jsx("span",{children:"Saving department..."})]})},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}},success:{render({data:a}){return e.jsx(e.Fragment,{children:a.map((g,c)=>e.jsx("div",{children:g},c))})},icon:"ðŸŸ¢",style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}},error:{render({data:a}){return e.jsx(e.Fragment,{children:a})},icon:"ðŸ”´",style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}}})};return e.jsx(xe,{isOpen:p,onOpenChange:u?void 0:v,size:"2xl",radius:l(),scrollBehavior:"inside",classNames:{base:"bg-content1",backdrop:"bg-black/50 backdrop-blur-sm"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(fe,{children:[e.jsxs(ge,{className:"flex gap-3 items-center",style:{fontFamily:'var(--fontFamily, "Inter")',borderBottom:"1px solid var(--theme-divider)"},children:[e.jsx("div",{className:"p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-primary) 20%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsx(ie,{size:20,style:{color:"var(--theme-primary)"}})}),e.jsx("span",{className:"text-lg font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")'},children:n?"Edit Department":"Create New Department"})]}),e.jsxs("form",{onSubmit:C,children:[e.jsx(ve,{className:"py-4 px-4 sm:py-6 sm:px-6",style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx(E,{label:"Department Name",placeholder:"Enter department name",value:o.name,onChange:s=>d("name",s.target.value),isInvalid:!!r.name,errorMessage:r.name?.[0],isRequired:!0,variant:"bordered",size:"sm",radius:l(),startContent:e.jsx(ie,{size:16,className:"text-default-400"}),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx(E,{label:"Department Code",placeholder:"e.g., HR001, FIN002",value:o.code,onChange:s=>d("code",s.target.value),isInvalid:!!r.code,errorMessage:r.code?.[0],variant:"bordered",size:"sm",radius:l(),description:"Unique identifier",classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsx("div",{className:"col-span-2",children:e.jsx(E,{label:"Description",placeholder:"Enter department description",value:o.description,onChange:s=>d("description",s.target.value),isInvalid:!!r.description,errorMessage:r.description?.[0],variant:"bordered",size:"sm",radius:l(),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx($,{label:"Parent Department (Optional)",placeholder:"Select parent department",selectedKeys:o.parent_id?new Set([String(o.parent_id)]):new Set,onSelectionChange:s=>{const j=Array.from(s)[0];d("parent_id",j||"")},isInvalid:!!r.parent_id,errorMessage:r.parent_id?.[0],variant:"bordered",size:"sm",radius:l(),description:"None = Top-Level Department",classNames:{trigger:"min-h-unit-10",value:"text-small"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:m?.filter(s=>n?.id!==s.id).map(s=>e.jsx(S,{value:s.id,children:s.name},String(s.id)))})}),e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx($,{label:"Department Manager (Optional)",placeholder:"Select manager",selectedKeys:o.manager_id?new Set([String(o.manager_id)]):new Set,onSelectionChange:s=>{const j=Array.from(s)[0];d("manager_id",j||"")},isInvalid:!!r.manager_id,errorMessage:r.manager_id?.[0],variant:"bordered",size:"sm",radius:l(),startContent:e.jsx(Qe,{size:16,className:"text-default-400"}),classNames:{trigger:"min-h-unit-10",value:"text-small"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:x?.map(s=>e.jsx(S,{value:s.id,children:s.name},String(s.id)))})}),e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx(E,{label:"Location",placeholder:"Physical location",value:o.location,onChange:s=>d("location",s.target.value),isInvalid:!!r.location,errorMessage:r.location?.[0],variant:"bordered",size:"sm",radius:l(),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx(E,{type:"date",label:"Established Date",value:o.established_date,onChange:s=>d("established_date",s.target.value),isInvalid:!!r.established_date,errorMessage:r.established_date?.[0],variant:"bordered",size:"sm",radius:l(),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsxs("div",{className:"col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:"color-mix(in srgb, var(--theme-content2) 30%, transparent)"},children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Active Status"}),e.jsx("p",{className:"text-xs text-default-500 mt-1",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Active departments can be assigned to employees"})]}),e.jsx(Xe,{isSelected:o.is_active,onValueChange:s=>d("is_active",s),size:"sm",classNames:{wrapper:"group-data-[selected=true]:bg-success"},style:{fontFamily:'var(--fontFamily, "Inter")'}})]}),r.is_active&&e.jsx("p",{className:"text-xs text-danger mt-1",children:r.is_active[0]})]})]})}),e.jsxs(be,{style:{borderTop:"1px solid var(--theme-divider)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(N,{onPress:v,isDisabled:u,variant:"light",radius:l(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsx(N,{type:"submit",color:"primary",isLoading:u,radius:l(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:n?"Update Department":"Create Department"})]})]})]})})},st=({open:p,onClose:v,onSuccess:_,department:n})=>{const[x,m]=i.useState(!1),u=()=>{if(typeof window>"u")return"lg";const h=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12px",l=parseInt(h);return l===0?"none":l<=4?"sm":l<=8?"md":l<=16?"lg":"full"},y=async()=>{if(!n){O.error("Invalid department provided");return}m(!0);const r=new Promise(async(h,l)=>{try{const f=await T.delete(`/departments/${n.id}`);f.status===200&&(_&&_(n,"delete"),h(f.data.message||"Department deleted successfully"))}catch(f){console.error("Error deleting department:",f),f.response?.status===422?l(f.response?.data?.message||"Cannot delete department with active employees"):f.response?.status===404?l("Department not found or already deleted"):f.response?.status===403?l("You do not have permission to delete this department"):l("An error occurred while deleting the department")}finally{m(!1)}});O.promise(r,{pending:{render(){return"Deleting department..."},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}},success:{render({data:h}){return v(),h},icon:"âœ…",style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}},error:{render({data:h}){return h},icon:"âŒ",style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}}})};return n?e.jsx(xe,{isOpen:p,onOpenChange:x?void 0:v,size:"lg",radius:u(),classNames:{base:"bg-content1",backdrop:"bg-black/50 backdrop-blur-sm"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(fe,{children:[e.jsxs(ge,{className:"flex gap-3 items-center",style:{fontFamily:'var(--fontFamily, "Inter")',borderBottom:"1px solid var(--theme-divider)"},children:[e.jsx("div",{className:"p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-danger) 20%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsx(M,{className:"w-5 h-5",style:{color:"var(--theme-danger)"}})}),e.jsx("span",{className:"text-lg font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Delete Department"})]}),e.jsx(ve,{className:"py-6",style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-warning) 10%, transparent)",border:"1px solid color-mix(in srgb, var(--theme-warning) 30%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:[e.jsx(Pe,{className:"w-6 h-6 flex-shrink-0",style:{color:"var(--theme-warning)"}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Are you sure you want to delete this department?"}),e.jsx("p",{className:"text-sm font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")',color:"var(--theme-primary)"},children:n.name})]})]}),n.employee_count>0&&e.jsx("div",{className:"p-4 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-danger) 10%, transparent)",border:"1px solid color-mix(in srgb, var(--theme-danger) 30%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsxs("p",{className:"text-sm",style:{fontFamily:'var(--fontFamily, "Inter")',color:"var(--theme-danger)"},children:["This department has ",e.jsx("strong",{children:n.employee_count})," employees assigned to it. You cannot delete a department with active employees. Please reassign these employees to other departments first."]})}),e.jsx("p",{className:"text-sm text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"This action cannot be undone. All associated data will be permanently removed."})]})}),e.jsxs(be,{style:{borderTop:"1px solid var(--theme-divider)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(N,{onPress:v,isDisabled:x,variant:"light",radius:u(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsx(N,{onPress:y,color:"danger",isDisabled:x||n.employee_count>0,isLoading:x,radius:u(),startContent:!x&&e.jsx(M,{className:"w-4 h-4"}),style:{fontFamily:'var(--fontFamily, "Inter")'},children:x?"Deleting...":"Delete Department"})]})]})}):null},Ka=({title:p,departments:v,managers:_,parentDepartments:n,stats:x,filters:m})=>{const{auth:u}=de().props,{theme:y}=Se(),[r]=i.useState(window.innerWidth<640),[h]=i.useState(window.innerWidth<768),[l,f]=i.useState(v||{data:[]}),[o,F]=i.useState(!1),[d,C]=i.useState({type:null,department:null}),[s,j]=i.useState({search:m?.search||"",status:m?.status||"all",parentDepartment:m?.parentDepartment||"all"}),[a,g]=i.useState(!1),[c,w]=i.useState("table"),[D,B]=i.useState({currentPage:v?.current_page||1,perPage:v?.per_page||10}),[z,ye]=i.useState(x||{total:0,active:0,inactive:0,parent_departments:0}),Z=u.permissions?.includes("departments.create")||!1,L=u.permissions?.includes("departments.update")||!1,Y=u.permissions?.includes("departments.delete")||!1,je=L||u.permissions?.includes("departments.update")||!1;Y||u.permissions?.includes("departments.delete");const V=i.useCallback(async()=>{F(!0);try{const t=await T.get(route("api.departments"),{params:{page:D.currentPage,per_page:D.perPage,search:s.search,status:s.status,parent_department:s.parentDepartment}});f(t.data.departments)}catch(t){console.error("Error fetching departments:",t),O.error("Failed to load departments data")}finally{F(!1)}},[D.currentPage,D.perPage,s.search,s.status,s.parentDepartment]),W=i.useCallback(async()=>{try{const t=await T.get(route("departments.stats"));if(t.status===200){const{stats:b}=t.data;ye(b)}}catch(t){console.error("Error fetching department stats:",t)}},[]);i.useEffect(()=>{V(),W()},[V,W]);const I=(t,b)=>{j(R=>({...R,[t]:b})),B(R=>({...R,currentPage:1}))},ee=t=>{B(b=>({...b,currentPage:t})),window.scrollTo({top:0,behavior:"smooth"})},Ne=t=>{B({currentPage:1,perPage:t})},k=(t,b=null)=>{C({type:t,department:b})},H=()=>{C({type:null,department:null})},te=()=>{V(),W()},we=({department:t,index:b})=>{const R=t.manager,ae=t.parent;return e.jsx(re,{className:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15 transition-all duration-200 cursor-pointer h-full",onPress:()=>k("view_department",t),children:e.jsxs(Ie,{className:"p-4 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3 pb-3 border-b border-white/10",children:[e.jsx("div",{className:"flex justify-center items-center h-10 w-10 rounded-lg bg-primary/20 text-primary shrink-0",children:e.jsx(ue,{className:"w-5 h-5"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground text-sm line-clamp-1",children:t.name}),e.jsx("p",{className:"text-default-500 text-xs",children:t.code||"No Code"})]}),je&&e.jsx(N,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-foreground ml-2",onPress:De=>{De.stopPropagation(),k("edit_department",t)},children:e.jsx(U,{className:"w-4 h-4"})})]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-3",children:[t.location&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(pe,{className:"w-4 h-4 text-default-400 shrink-0"}),e.jsx("span",{className:"text-default-600 text-xs line-clamp-1",children:t.location})]}),t.established_date&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(me,{className:"w-4 h-4 text-default-400 shrink-0"}),e.jsx("span",{className:"text-default-600 text-xs",children:ce(t.established_date).format("MMM D, YYYY")})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(J,{className:"w-4 h-4 text-default-400 shrink-0"}),e.jsxs("span",{className:"text-default-600 text-xs",children:[t.employee_count||0," ",t.employee_count===1?"Employee":"Employees"]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10 flex flex-wrap gap-2",children:[e.jsx(P,{size:"sm",variant:t.is_active?"solid":"bordered",color:t.is_active?"success":"danger",className:"text-xs",startContent:t.is_active?e.jsx(Q,{className:"w-3 h-3"}):e.jsx(K,{className:"w-3 h-3"}),children:t.is_active?"Active":"Inactive"}),ae&&e.jsx(P,{size:"sm",variant:"flat",color:"primary",className:"text-xs",startContent:e.jsx(A,{className:"w-3 h-3"}),children:ae.name}),R&&e.jsx(P,{size:"sm",variant:"flat",color:"secondary",className:"text-xs",startContent:e.jsx(J,{className:"w-3 h-3"}),children:R.name})]})]})})},_e=i.useMemo(()=>[{title:"Total Departments",value:z?.total||0,icon:e.jsx(A,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All departments"},{title:"Active",value:z?.active||0,icon:e.jsx(Q,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:"Active departments"},{title:"Inactive",value:z?.inactive||0,icon:e.jsx(K,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:"Inactive departments"},{title:"Parent Departments",value:z?.parent_departments||0,icon:e.jsx(Ze,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Top-level departments"}],[z]),Fe=i.useMemo(()=>{const t=[];return Z&&t.push({label:r?"Add":"Add Department",icon:e.jsx(Je,{className:"w-4 h-4"}),onPress:()=>k("add_department"),className:"bg-linear-to-r from-(--theme-primary) to-(--theme-secondary) text-white font-medium hover:opacity-90"}),t.push({label:r?"":"Export",isIconOnly:r,icon:e.jsx(ze,{className:"w-4 h-4"}),variant:"bordered",className:"border-[rgba(var(--theme-primary-rgb),0.3)] bg-[rgba(var(--theme-primary-rgb),0.05)] hover:bg-[rgba(var(--theme-primary-rgb),0.1)]"}),t},[Z,r]);return e.jsxs(Ae,{children:[e.jsx(Ce,{title:p}),e.jsx("div",{className:"flex justify-center p-2",children:e.jsx(se.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},children:e.jsx(re,{className:"shadow-lg",children:e.jsx(ke,{title:"Department Management",subtitle:"Manage company departments, hierarchies, and organizational structure",icon:e.jsx(A,{className:"w-8 h-8"}),variant:"default",actionButtons:Fe,children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx(Re,{stats:_e,className:"mb-6"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx(E,{label:"Search Departments",placeholder:"Search by name, code, or location...",value:s.search,onChange:t=>I("search",t.target.value),startContent:e.jsx(et,{className:"w-4 h-4 text-default-400"})})}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs(tt,{variant:"bordered",className:"bg-white/5",children:[e.jsxs(N,{isIconOnly:r,color:c==="table"?"primary":"default",onPress:()=>w("table"),className:c==="table"?"bg-blue-500/20":"",children:[e.jsx(Te,{className:"w-4 h-4"}),!r&&e.jsx("span",{className:"ml-1",children:"Table"})]}),e.jsxs(N,{isIconOnly:r,color:c==="grid"?"primary":"default",onPress:()=>w("grid"),className:c==="grid"?"bg-blue-500/20":"",children:[e.jsx(Me,{className:"w-4 h-4"}),!r&&e.jsx("span",{className:"ml-1",children:"Grid"})]})]}),e.jsxs(N,{isIconOnly:r,variant:"bordered",onPress:()=>g(!a),className:a?"bg-purple-500/20":"bg-white/5",children:[e.jsx(Oe,{className:"w-4 h-4"}),!r&&e.jsx("span",{className:"ml-1",children:"Filters"})]})]})]}),a&&e.jsxs(se.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},className:"mb-6 p-4 bg-white/5 backdrop-blur-md rounded-lg border border-white/10",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs($,{label:"Status",variant:"bordered",selectedKeys:s.status!=="all"?[s.status]:[],onSelectionChange:t=>{const b=Array.from(t)[0]||"all";I("status",b)},classNames:{trigger:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},children:[e.jsx(S,{value:"all",children:"All Statuses"},"all"),e.jsx(S,{value:"active",children:"Active Only"},"active"),e.jsx(S,{value:"inactive",children:"Inactive Only"},"inactive")]}),e.jsxs($,{label:"Parent Department",variant:"bordered",selectedKeys:s.parentDepartment!=="all"?[s.parentDepartment]:[],onSelectionChange:t=>{const b=Array.from(t)[0]||"all";I("parentDepartment",b)},classNames:{trigger:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15"},children:[e.jsx(S,{value:"all",children:"All Parent Departments"},"all"),e.jsx(S,{value:"none",children:"Top-Level Departments"},"none"),n?.map(t=>e.jsx(S,{value:t.id.toString(),children:t.name},t.id.toString()))]})]}),(s.search||s.status!=="all"||s.parentDepartment!=="all")&&e.jsxs("div",{className:"flex flex-wrap gap-2 mt-4 pt-4 border-t border-white/10",children:[s.search&&e.jsxs(P,{variant:"flat",color:"primary",size:"sm",onClose:()=>I("search",""),children:["Search: ",s.search]}),s.status!=="all"&&e.jsxs(P,{variant:"flat",color:"secondary",size:"sm",onClose:()=>I("status","all"),children:["Status: ",s.status==="active"?"Active":"Inactive"]}),s.parentDepartment!=="all"&&e.jsxs(P,{variant:"flat",color:"warning",size:"sm",onClose:()=>I("parentDepartment","all"),children:["Parent: ",s.parentDepartment==="none"?"None (Top-Level)":n?.find(t=>t.id===parseInt(s.parentDepartment))?.name]})]})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-md rounded-lg border border-white/10 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-white/10",children:e.jsxs("h3",{className:"text-lg font-semibold text-foreground",children:[c==="table"?"Department Table":"Department Grid",e.jsxs("span",{className:"text-sm text-default-500 ml-2",children:["(",l.total||0," ",l.total===1?"department":"departments",")"]})]})}),o?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(X,{size:"lg"}),e.jsx("p",{className:"mt-4 text-default-500",children:"Loading departments data..."})]}):c==="table"?e.jsx(at,{departments:l,loading:o,onEdit:L?t=>k("edit_department",t):void 0,onDelete:Y?t=>k("delete_department",t):void 0,onView:t=>k("view_department",t),isMobile:r,isTablet:h,pagination:D,onPageChange:ee,onRowsPerPageChange:Ne,canEditDepartment:L,canDeleteDepartment:Y}):e.jsxs("div",{className:"p-4",children:[l.data&&l.data.length>0?e.jsx("div",{className:`grid gap-4 ${r?"grid-cols-1":h?"grid-cols-2":"grid-cols-3 xl:grid-cols-4"}`,children:l.data.map((t,b)=>e.jsx(we,{department:t,index:b},t.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(A,{className:"w-12 h-12 mx-auto text-default-300 mb-2"}),e.jsx("p",{className:"text-default-500 mb-1",children:"No departments found"}),e.jsx("p",{className:"text-xs text-default-400",children:"Try adjusting your search or filters"})]}),l.data&&l.data.length>0&&e.jsx("div",{className:"flex justify-center mt-6 border-t border-white/10 pt-4",children:e.jsx(he,{total:Math.ceil(l.total/D.perPage),initialPage:D.currentPage,page:D.currentPage,onChange:ee,size:r?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})})]})]})]})})})})}),(d.type==="add_department"||d.type==="edit_department")&&e.jsx(oe,{open:!0,onClose:H,onSuccess:te,department:d.type==="edit_department"?d.department:null,managers:_,parentDepartments:n}),d.type==="delete_department"&&e.jsx(st,{open:!0,onClose:H,onSuccess:te,department:d.department}),d.type==="view_department"&&e.jsx(oe,{open:!0,onClose:H,onSuccess:()=>{},department:d.department,managers:_,parentDepartments:n,readOnly:!0})]})};export{Ka as default};
