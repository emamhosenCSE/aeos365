import{u as $,r,o as A,j as e,H as I,c as B,b as d,d as D,F as _,e as L,i as T,K as w,p as U}from"./app-BkgCtHXO.js";import{a1 as K,a2 as z,A as V}from"./App-Bhfi2s9p.js";import{s as l}from"./toastUtils-x3kUGVfR.js";import{F as G}from"./CheckCircleIcon-BA11f32N.js";import{F as H}from"./GlobeAltIcon-DZrfrxpb.js";import{F as C}from"./KeyIcon-C220HsQ8.js";import{F as Y}from"./CheckCircleIcon-DSwXcUZm.js";import{u as q}from"./index-CPxwW2OQ.js";import{c as J}from"./chunk-C6WKGNND-MUA-e_xI.js";import{s as Q}from"./chunk-I3A4XRYQ-BuuDfAqA.js";import{t as X}from"./chunk-WEIB4WXA-B_Il_D7B.js";import{i as c}from"./chunk-SQIAVXJX-Byw4yFUd.js";import{t as k}from"./chunk-AUA5GDXN-DY9zYzzB.js";import{d as Z}from"./chunk-IHO36JMK-CdY0f3fU.js";import{m as ee,a as ae,b as se,c as te}from"./chunk-TW2E3XVA-BTmTvWaA.js";import{m as re}from"./chunk-5LXTSPS7-_fk4lnb6.js";import"./app-Bq-q9uAS.js";import"./index-B7m8hOZr.js";/* empty css                      */import"./chunk-CV4BWJDJ-Ck1M5KjM.js";import"./index-CDIdcT6N.js";import"./index-n2HRE6J3.js";import"./UserIcon-DhvPAajS.js";import"./PlusIcon-C3pQgqq8.js";import"./Item-K6ZLiQmP.js";import"./SelectionManager-BiHd6T0T.js";import"./keyboard-C-f1CHRW.js";import"./index-Clir5_RS.js";import"./useDialog-Dego46hN.js";import"./VisuallyHidden-CA8GF3km.js";import"./useLabels-4bh2Qhvc.js";import"./chunk-WQVQ7P2I-D-7sv4Ho.js";import"./number-CB4zbwAz.js";import"./index-CQWya27l.js";import"./useSelectableItem-D57jKBOb.js";import"./useTreeState-BV3KnYKM.js";import"./useMenuTriggerState-Dzz21gtA.js";import"./chunk-LGMZDQT5-vmPOWwVV.js";import"./Cog6ToothIcon-Bovovt86.js";import"./useBranding-BXHsi77Q.js";import"./XMarkIcon-CrIhUf5Y.js";import"./MagnifyingGlassIcon-C6KR9V8s.js";import"./useMediaQuery-8d3ZZ2Cv.js";import"./chunk-C3QHEOC2-CNuS3wko.js";import"./chunk-KQW2TNLT-B1u5jByx.js";import"./chunk-ICU6NNET-CIX58cOD.js";import"./useLabel-fBkMOesA.js";import"./chunk-Y5DMIIWQ-Z1JSEJtA.js";import"./index-BwFQKAC4.js";import"./chunk-7F3ZLNJ6-7HIsgfq8.js";import"./ShieldCheckIcon-D6DEfedi.js";import"./AcademicCapIcon-BCaVBDQF.js";import"./IdentificationIcon-Ds-4Nu7-.js";import"./ArrowLeftIcon-rtMO2lqZ.js";import"./ArrowRightIcon-0qM22t_E.js";import"./BriefcaseIcon-ks4a8w4L.js";import"./BuildingOfficeIcon-C8dMXtOE.js";import"./CalendarDaysIcon-CRjROwRX.js";import"./CalendarIcon-epWelskZ.js";import"./CircleStackIcon-CjgcQrbr.js";import"./ClipboardDocumentCheckIcon-BCkrSIkK.js";import"./CogIcon-qMWpeldL.js";import"./DeviceTabletIcon-CPRGFXWS.js";import"./CpuChipIcon-CHy-cAwa.js";import"./CurrencyDollarIcon-mNQeyjyS.js";import"./DevicePhoneMobileIcon-DSPuvI2c.js";import"./DocumentArrowUpIcon-D0Jllwfs.js";import"./DocumentIcon-Bcf4PBRj.js";import"./EnvelopeIcon-C0cG5D_W.js";import"./ExclamationCircleIcon-CNYB3GSb.js";import"./EyeIcon-DxZ2jGeX.js";import"./InformationCircleIcon-CSPAZcgc.js";import"./LockClosedIcon-DdTWPNy3.js";import"./MapPinIcon-DZZHyKyI.js";import"./PlusCircleIcon-C1Rly6an.js";import"./PrinterIcon-D0f-Na_H.js";import"./RocketLaunchIcon-DLpA5P5J.js";import"./ShoppingCartIcon-BqiFuyws.js";import"./UserCircleIcon-BqKUdOjE.js";import"./UserGroupIcon-BJ49WXv1.js";import"./MaintenanceModeBanner-BPpiQYbG.js";import"./index-DGbB7juJ.js";import"./useToggleState-DSM3ZxzH.js";const ne={border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',background:`linear-gradient(135deg, 
    var(--theme-content1, #FAFAFA) 20%, 
    var(--theme-content2, #F4F4F5) 10%, 
    var(--theme-content3, #F1F3F4) 20%)`},ie={borderColor:"var(--theme-divider, #E4E4E7)",background:`linear-gradient(135deg, 
    color-mix(in srgb, var(--theme-content1) 50%, transparent) 20%, 
    color-mix(in srgb, var(--theme-content2) 30%, transparent) 10%)`},b={background:"color-mix(in srgb, var(--theme-content2) 50%, transparent)",border:"1px solid color-mix(in srgb, var(--theme-content3) 50%, transparent)",borderRadius:"var(--borderRadius, 12px)"},oe=()=>{const{title:u="System Maintenance",settings:i={}}=$().props,{isOpen:F,onOpen:j,onClose:m}=q(),[p,x]=r.useState(""),[h,y]=r.useState(!1),g=A({maintenance_mode:i.maintenance_mode??!1,maintenance_message:i.maintenance_message??"We are currently performing scheduled maintenance. We'll be back shortly.",maintenance_bypass_secret:i.maintenance_bypass_secret??"",maintenance_bypass_ips:i.maintenance_bypass_ips??[],maintenance_allowed_paths:i.maintenance_allowed_paths??["/api/health","/status"],maintenance_ends_at:i.maintenance_ends_at??""}),{data:a,setData:t,processing:R,errors:v}=g,f=a.maintenance_bypass_secret?`${window.location.origin}?bypass=${a.maintenance_bypass_secret}`:"No bypass secret configured",S=r.useCallback(s=>{s?j():t("maintenance_mode",!1)},[j,t]),N=r.useCallback(()=>{p.toUpperCase()==="DOWN"?(t("maintenance_mode",!0),x(""),m()):l.error('Please type "DOWN" to confirm.')},[p,t,m]),M=r.useCallback(async()=>{if(!a.maintenance_bypass_secret){l.error("No bypass secret configured.");return}try{await navigator.clipboard.writeText(f),y(!0),l.success("Bypass URL copied to clipboard!"),setTimeout(()=>y(!1),2e3)}catch{l.error("Failed to copy to clipboard.")}},[f,a.maintenance_bypass_secret]),W=r.useCallback(s=>{s.preventDefault(),g.put(route("admin.settings.maintenance.update"),{preserveScroll:!0,onSuccess:()=>{l.success("Maintenance settings updated successfully.")},onError:n=>{l.error("Failed to update maintenance settings.")}})},[g]),P=r.useCallback(()=>{const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let n="";for(let o=0;o<32;o++)n+=s.charAt(Math.floor(Math.random()*s.length));t("maintenance_bypass_secret",n)},[t]),E=r.useCallback(s=>{const n=s.split(",").map(o=>o.trim()).filter(Boolean);t("maintenance_bypass_ips",n)},[t]),O=r.useCallback(s=>{const n=s.split(",").map(o=>o.trim()).filter(Boolean);t("maintenance_allowed_paths",n)},[t]);return e.jsxs(e.Fragment,{children:[e.jsx(I,{title:`${u} - Admin`}),e.jsx("div",{className:"mx-auto w-full max-w-6xl space-y-6 px-4 py-6 md:px-6",children:e.jsxs(B,{className:"transition-all duration-200",style:ne,children:[e.jsx(J,{className:"border-b p-0",style:ie,children:e.jsx("div",{className:"p-6 w-full",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl flex items-center justify-center",style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 25%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 12px)"},children:e.jsx(K,{className:"w-8 h-8",style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-2xl font-bold text-foreground",children:"System Maintenance"}),e.jsx("p",{className:"text-sm text-default-500",children:"Control platform-wide maintenance mode and bypass settings."})]})]}),e.jsx("div",{className:"flex gap-3",children:e.jsx(d,{color:"primary",type:"submit",form:"maintenance-form",isLoading:R,children:"Save Settings"})})]})})}),e.jsxs(D,{className:"p-6 space-y-6",children:[e.jsx("div",{className:`p-6 rounded-xl border-2 transition-all duration-300 ${a.maintenance_mode?"bg-danger-50 border-danger-200 dark:bg-danger-900/20 dark:border-danger-800":"bg-success-50 border-success-200 dark:bg-success-900/20 dark:border-success-800"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-4 rounded-full ${a.maintenance_mode?"bg-danger-100 dark:bg-danger-900/40":"bg-success-100 dark:bg-success-900/40"}`,children:a.maintenance_mode?e.jsx(_,{className:"w-10 h-10 text-danger-600 dark:text-danger-400"}):e.jsx(G,{className:"w-10 h-10 text-success-600 dark:text-success-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-2xl font-bold ${a.maintenance_mode?"text-danger-700 dark:text-danger-400":"text-success-700 dark:text-success-400"}`,children:a.maintenance_mode?"Maintenance Mode Active":"System is Live"}),e.jsx("p",{className:`text-sm ${a.maintenance_mode?"text-danger-600/80 dark:text-danger-400/80":"text-success-600/80 dark:text-success-400/80"}`,children:a.maintenance_mode?"All users will see the maintenance page. Only bypassed IPs/secrets can access.":"Platform is fully operational and accessible to all users."})]})]}),e.jsx(L,{size:"lg",variant:"flat",color:a.maintenance_mode?"danger":"success",startContent:a.maintenance_mode?e.jsx(T,{className:"w-4 h-4"}):e.jsx(H,{className:"w-4 h-4"}),children:a.maintenance_mode?"OFFLINE":"ONLINE"})]})}),e.jsxs("form",{id:"maintenance-form",onSubmit:W,className:"space-y-6",children:[e.jsx("div",{className:"p-6 rounded-xl",style:b,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-xl",style:{background:"color-mix(in srgb, var(--theme-danger) 15%, transparent)"},children:e.jsx(z,{className:"w-6 h-6 text-danger"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-semibold text-foreground",children:"Maintenance Kill Switch"}),e.jsx("p",{className:"text-sm text-default-500",children:"Enable to immediately put the platform into maintenance mode."})]})]}),e.jsx(Q,{size:"lg",color:"danger",isSelected:a.maintenance_mode,onValueChange:S,classNames:{wrapper:"group-data-[selected=true]:bg-danger"}})]})}),e.jsxs("div",{className:"p-6 rounded-xl space-y-4",style:b,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2.5 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-primary) 15%, transparent)"},children:e.jsx(w,{className:"w-5 h-5",style:{color:"var(--theme-primary)"}})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-base font-semibold text-foreground",children:"Public Message"}),e.jsx("p",{className:"text-xs text-default-500",children:"This message will be displayed to users during maintenance."})]})]}),e.jsx(X,{label:"Maintenance Message",labelPlacement:"outside",placeholder:"Enter the message users will see during maintenance...",value:a.maintenance_message,onValueChange:s=>t("maintenance_message",s),minRows:3,maxRows:6,description:"Supports plain text. Keep it concise and informative.",isInvalid:!!v.maintenance_message,errorMessage:v.maintenance_message,classNames:{inputWrapper:"bg-default-100"}}),e.jsx(c,{type:"datetime-local",label:"Estimated End Time (Optional)",labelPlacement:"outside",placeholder:"When do you expect maintenance to end?",value:a.maintenance_ends_at?a.maintenance_ends_at.slice(0,16):"",onChange:s=>t("maintenance_ends_at",s.target.value),startContent:e.jsx(U,{className:"w-4 h-4 text-default-400"}),description:"Users will see a countdown if this is set.",classNames:{inputWrapper:"bg-default-100"}})]}),e.jsxs("div",{className:"p-6 rounded-xl space-y-4",style:b,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2.5 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-warning) 15%, transparent)"},children:e.jsx(C,{className:"w-5 h-5 text-warning-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-base font-semibold text-foreground",children:"Bypass Configuration"}),e.jsx("p",{className:"text-xs text-default-500",children:"Configure how admins can bypass maintenance mode for testing."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:"Bypass Secret"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{readOnly:!0,value:a.maintenance_bypass_secret,placeholder:"No bypass secret configured",startContent:e.jsx(C,{className:"w-4 h-4 text-default-400"}),classNames:{inputWrapper:"bg-default-100",input:"font-mono text-sm"}}),e.jsx(k,{content:"Generate new secret",children:e.jsx(d,{isIconOnly:!0,variant:"flat",color:"primary",onPress:P,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:"Bypass URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{readOnly:!0,value:f,classNames:{inputWrapper:"bg-default-100",input:"font-mono text-sm text-default-500"}}),e.jsx(k,{content:h?"Copied!":"Copy URL",children:e.jsx(d,{isIconOnly:!0,variant:"flat",color:h?"success":"default",onPress:M,children:h?e.jsx(Y,{className:"w-5 h-5"}):e.jsx(w,{className:"w-5 h-5"})})})]}),e.jsxs("p",{className:"text-xs text-default-400",children:["Add this URL parameter to bypass maintenance mode: ",e.jsx("code",{className:"bg-default-100 px-1 rounded",children:"?bypass=YOUR_SECRET"})]})]}),e.jsx(Z,{className:"my-4"}),e.jsx(c,{label:"Bypass IP Addresses",labelPlacement:"outside",placeholder:"127.0.0.1, 192.168.1.100",value:(a.maintenance_bypass_ips||[]).join(", "),onChange:s=>E(s.target.value),description:"Comma-separated list of IP addresses that can bypass maintenance mode.",classNames:{inputWrapper:"bg-default-100"}}),e.jsx(c,{label:"Allowed Paths",labelPlacement:"outside",placeholder:"/api/health, /status, /webhook/*",value:(a.maintenance_allowed_paths||[]).join(", "),onChange:s=>O(s.target.value),description:"Comma-separated list of paths accessible during maintenance. Supports wildcards (*).",classNames:{inputWrapper:"bg-default-100"}})]})]})]})]})}),e.jsx(ee,{isOpen:F,onClose:()=>{x(""),m()},size:"md",backdrop:"blur",children:e.jsxs(ae,{children:[e.jsx(se,{className:"flex flex-col gap-1",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-danger-100 dark:bg-danger-900/40",children:e.jsx(_,{className:"w-6 h-6 text-danger"})}),e.jsx("span",{children:"Confirm Maintenance Mode"})]})}),e.jsx(te,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-default-600",children:"You are about to put the entire platform into maintenance mode. This will:"}),e.jsxs("ul",{className:"list-disc list-inside text-sm text-default-500 space-y-1",children:[e.jsx("li",{children:"Show a maintenance page to all users"}),e.jsx("li",{children:"Block access to all routes except bypassed ones"}),e.jsx("li",{children:"Log out active sessions (users will need to re-authenticate)"})]}),e.jsxs("div",{className:"p-4 bg-danger-50 dark:bg-danger-900/20 rounded-lg border border-danger-200 dark:border-danger-800",children:[e.jsxs("p",{className:"text-sm text-danger-700 dark:text-danger-400 font-medium mb-2",children:["Type ",e.jsx("span",{className:"font-bold font-mono bg-danger-100 dark:bg-danger-900/40 px-2 py-0.5 rounded",children:"DOWN"})," to confirm:"]}),e.jsx(c,{placeholder:"Type DOWN to confirm",value:p,onValueChange:x,autoFocus:!0,classNames:{inputWrapper:"bg-white dark:bg-default-100",input:"font-mono text-center uppercase"},onKeyDown:s=>{s.key==="Enter"&&N()}})]})]})}),e.jsxs(re,{children:[e.jsx(d,{variant:"light",onPress:()=>{x(""),m()},children:"Cancel"}),e.jsx(d,{color:"danger",onPress:N,isDisabled:p.toUpperCase()!=="DOWN",children:"Enable Maintenance Mode"})]})]})})]})};oe.layout=u=>e.jsx(V,{children:u});export{oe as default};
