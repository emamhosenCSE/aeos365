import{j as e,c as M,a as R,d as _,p as X,m as Y,r as m,H as Z,b as S,h as B,f as ee,e as se}from"./app-DLWZL5EI.js";import{s as $}from"./routeUtils-C6MiLID5.js";import{f as re,C as te,d as ae,S as ie,v as ne,u as le,a as oe,D as ce,c as de,b as me,P as xe}from"./sortable.esm-BRqbnuxL.js";import{ak as pe,w as ue,A as fe}from"./App-CPiN04Y0.js";import{s as E}from"./toastUtils-CQ8tPw7l.js";import{F as P}from"./UserIcon-DiPxEy9e.js";import{F as he}from"./EnvelopeIcon-BNQywoLu.js";import{F as je}from"./useMediaQuery-CZ_V8brP.js";import{F as A}from"./BriefcaseIcon-CunjT5yU.js";import{F as ge}from"./CurrencyDollarIcon-DK6JNn4H.js";import{a as ve}from"./chunk-CV4BWJDJ-C645uC3W.js";import{t as ye}from"./chunk-AUA5GDXN-DgHZKZnK.js";import{f as Ne}from"./formatDistanceToNow-Ctx6mZEP.js";import{c as we}from"./chunk-C6WKGNND-Dq1nEPC1.js";import{F as be}from"./PlusIcon-CgcHryUb.js";import{F as Ce}from"./MagnifyingGlassIcon-C9l2NPQE.js";import{F as _e}from"./FunnelIcon-D8WHt0li.js";import{i as F}from"./chunk-SQIAVXJX-C5zDfxFa.js";import{s as Se}from"./chunk-C3QHEOC2-Bmp2Jpe_.js";import{l as j}from"./chunk-Y5DMIIWQ-zhqLBGLU.js";import"./app-BI-xrU3s.js";import"./index-lAyyVki8.js";/* empty css                      */import"./Cog6ToothIcon-CI3NiAkm.js";import"./GlobeAltIcon-CFAl4tmE.js";import"./useBranding-C98uB2bk.js";import"./useDialog-LKdJQ55I.js";import"./getScrollParent-B27hviGV.js";import"./keyboard-CSKkBtIV.js";import"./useLabels-CKC_NELL.js";import"./VisuallyHidden-Dslt4DE9.js";import"./index-B5MKI_DQ.js";import"./index-Dz459_my.js";import"./XMarkIcon-C9tv-sqJ.js";import"./chunk-IHO36JMK-DYeauZfe.js";import"./ShieldCheckIcon-BxwQA0uM.js";import"./AcademicCapIcon-Bs9t2qow.js";import"./IdentificationIcon-6E2VOCK1.js";import"./ArrowLeftIcon-a6q7R3tQ.js";import"./ArrowRightIcon-BZNmx9ah.js";import"./UsersIcon-CpsA-xGl.js";import"./BoltIcon-BRTqiOqL.js";import"./BuildingOfficeIcon-BJoAl2gF.js";import"./CalendarDaysIcon-BR4QgBq8.js";import"./CalendarIcon-BTj7Nn7B.js";import"./ChartBarIcon-CnSK0enl.js";import"./CheckCircleIcon-CaJShsm_.js";import"./CircleStackIcon-20fpj2M5.js";import"./ClipboardDocumentCheckIcon-Bwahsg1t.js";import"./CogIcon-CQIGGanJ.js";import"./DeviceTabletIcon-CR6eyvHQ.js";import"./CpuChipIcon-Dkmm6hKt.js";import"./DevicePhoneMobileIcon-DzKKUXAD.js";import"./DocumentArrowUpIcon-CdnT1l-_.js";import"./PencilIcon-Da-ZoIco.js";import"./TrashIcon-C6DesZfk.js";import"./DocumentIcon-YVJ_odhG.js";import"./ExclamationCircleIcon-D-5waelr.js";import"./EyeSlashIcon-C7uJqcIF.js";import"./EyeIcon-Ds6DAjR7.js";import"./InformationCircleIcon-2sIUPx4E.js";import"./KeyIcon-Dl6jmBIi.js";import"./LockClosedIcon-DWSbAAT6.js";import"./MapPinIcon-CoSq0ZKP.js";import"./PlusCircleIcon-borTRmVT.js";import"./PrinterIcon-jsVlFWpL.js";import"./RocketLaunchIcon-C1ofXZeY.js";import"./ShoppingCartIcon-DijpYrUE.js";import"./UserCircleIcon-D9Bl7hMN.js";import"./UserGroupIcon-DLyCB4U6.js";import"./chunk-TW2E3XVA-dNGvEz5r.js";import"./chunk-I3A4XRYQ-CbmreU5k.js";import"./chunk-LGMZDQT5-BbUrfslF.js";import"./useToggleState-C1tJJPv7.js";import"./chunk-ICU6NNET-BuoRM2Mj.js";import"./MaintenanceModeBanner-CpiCdC4n.js";import"./index-DD7PnbC4.js";import"./chunk-WQVQ7P2I-BXEU6rr0.js";import"./number-CB4zbwAz.js";import"./Item-hnCJOaQ5.js";import"./SelectionManager-UhxaObWG.js";import"./index-D3fxkw17.js";import"./useSelectableItem-Qild1lMf.js";import"./useTreeState-CsNDLaZy.js";import"./useMenuTriggerState-CpMESG3a.js";import"./chunk-KQW2TNLT-BxZBj3py.js";import"./useField-CN4URFK6.js";import"./useLabel-BC4q2FsI.js";import"./chunk-7F3ZLNJ6-BH294qJ7.js";import"./index-CGn2JJsk.js";const I=({application:s,onView:p,isDragging:x=!1,themeRadius:w})=>{const{attributes:b,listeners:u,setNodeRef:d,transform:i,isDragging:h}=re({id:s.id}),t={transform:te.Translate.toString(i),opacity:h?.5:1},f=o=>{try{return Ne(new Date(o),{addSuffix:!0})}catch{return o}},D=(o,g="USD")=>o?new Intl.NumberFormat("en-US",{style:"currency",currency:g,minimumFractionDigits:0,maximumFractionDigits:0}).format(o):"Not specified",k=o=>({referral:"success",linkedin:"primary",indeed:"secondary",website:"warning",internal:"default"})[o]||"default";return e.jsx(M,{ref:d,style:t,...b,...u,isPressable:!x,onPress:p,className:`transition-all duration-200 cursor-grab active:cursor-grabbing ${h?"shadow-2xl z-50":"hover:shadow-md"}`,radius:w,children:e.jsxs(R,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx(ve,{name:s.applicant_name,size:"md",src:s.applicant?.avatar,showFallback:!0,fallback:e.jsx(P,{className:"w-5 h-5 text-default-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-semibold text-foreground truncate mb-1",children:s.applicant_name}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.source&&e.jsx(_,{size:"sm",color:k(s.source),variant:"flat",children:s.source}),s.rating&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3 h-3 text-warning fill-warning"}),e.jsx("span",{className:"text-xs text-default-600",children:s.rating})]})]})]})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[s.email&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-default-600",children:[e.jsx(he,{className:"w-3.5 h-3.5 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.email})]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-default-600",children:[e.jsx(je,{className:"w-3.5 h-3.5 flex-shrink-0"}),e.jsx("span",{children:s.phone})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[s.experience_years!==null&&e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-primary) 10%, transparent)"},children:[e.jsx(A,{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:"var(--theme-primary)"}}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs font-medium text-foreground",children:[s.experience_years," yrs"]}),e.jsx("div",{className:"text-[10px] text-default-500",children:"Experience"})]})]}),s.expected_salary&&e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-success) 10%, transparent)"},children:[e.jsx(ge,{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:"var(--theme-success)"}}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-foreground truncate",children:D(s.expected_salary,s.salary_currency)}),e.jsx("div",{className:"text-[10px] text-default-500",children:"Expected"})]})]})]}),s.skills&&s.skills.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[s.skills.slice(0,3).map((o,g)=>e.jsx(_,{size:"sm",variant:"flat",color:"primary",className:"text-[10px]",children:o},g)),s.skills.length>3&&e.jsxs(_,{size:"sm",variant:"flat",color:"default",className:"text-[10px]",children:["+",s.skills.length-3]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-default-500 pt-2 border-t border-divider",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-3 h-3"}),e.jsxs("span",{children:["Applied ",f(s.application_date||s.created_at)]})]}),s.notice_period!==null&&e.jsx(ye,{content:"Notice Period",children:e.jsxs("span",{className:"text-[10px] text-default-400",children:[s.notice_period," days"]})})]})]})})},Fe=({stage:s,color:p,onViewCandidate:x,themeRadius:w})=>{const{setNodeRef:b,isOver:u}=ae({id:s.id}),d=s.applications.map(i=>i.id);return e.jsx(Y.div,{layout:!0,className:"flex-shrink-0 w-80",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(M,{ref:b,className:`h-full transition-all duration-200 ${u?"ring-2 ring-primary":""}`,style:{borderRadius:"var(--borderRadius, 12px)",background:u?"color-mix(in srgb, var(--theme-primary) 5%, var(--theme-content1))":"var(--theme-content1)"},children:[e.jsx(we,{className:"flex justify-between items-center px-4 py-3 border-b border-divider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:s.name}),e.jsx(ue,{content:s.applications.length,color:p,size:"sm",variant:"flat",children:e.jsx("div",{className:"w-2 h-2"})})]})}),e.jsx(R,{className:"p-3 overflow-y-auto",style:{maxHeight:"calc(100vh - 300px)"},children:e.jsx(ie,{items:d,strategy:ne,children:e.jsx("div",{className:"space-y-3",children:s.applications.length===0?e.jsx("div",{className:"text-center py-8 text-default-400 text-sm",style:{background:"color-mix(in srgb, var(--theme-default-100) 30%, transparent)",borderRadius:"var(--borderRadius, 8px)",border:"2px dashed",borderColor:"var(--theme-default-200)"},children:"Drop candidates here"}):s.applications.map(i=>e.jsx(I,{application:i,onView:()=>x(i),themeRadius:w},i.id))})})})]})})},Me=({job:s,hiringStages:p,applicationsByStage:x,departments:w,jobTypes:b})=>{const[u,d]=m.useState(null),[i,h]=m.useState([]),[t,f]=m.useState({search:"",source:"",experienceMin:"",experienceMax:"",salaryMin:"",salaryMax:""}),[D,k]=m.useState("kanban"),[o,g]=m.useState(!1),[Re,De]=m.useState({open:!1,application:null}),[c,V]=m.useState("lg"),L=()=>{if(typeof window>"u")return"lg";const a=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12px",l=parseInt(a);return l===0?"none":l<=4?"sm":l<=8?"md":l<=16?"lg":"full"};m.useEffect(()=>{typeof window<"u"&&V(L())},[]),m.useEffect(()=>{if(p&&x){const r=p.map(a=>({...a,applications:x[a.id]?.applications||[],count:x[a.id]?.count||0}));h(r)}},[p,x]);const T=le(oe(xe,{activationConstraint:{distance:8}})),H=r=>{d(r.active.id)},K=async r=>{const{active:a,over:l}=r;if(!l){d(null);return}const v=a.id,y=l.id,C=i.find(n=>n.applications.some(N=>N.id===v));if(!C||C.id===y){d(null);return}const J=i.map(n=>{if(n.id===C.id)return{...n,applications:n.applications.filter(N=>N.id!==v),count:n.count-1};if(n.id===y){const N=C.applications.find(Q=>Q.id===v);return{...n,applications:[...n.applications,{...N,current_stage_id:y}],count:n.count+1}}return n});h(J),d(null);try{await se.put(route("hr.recruitment.applications.update-stage",{job:s.id,application:v}),{stage_id:y,notes:`Moved to ${i.find(n=>n.id===y)?.name}`}),E.success("Candidate moved successfully")}catch(n){console.error("Error moving candidate:",n),E.error("Failed to move candidate"),h(i)}},O=()=>{d(null)},U=i.map(r=>({...r,applications:r.applications.filter(a=>{if(t.search){const l=t.search.toLowerCase();if(!(a.applicant_name?.toLowerCase().includes(l)||a.email?.toLowerCase().includes(l)||a.phone?.includes(l)))return!1}return!(t.source&&a.source!==t.source||t.experienceMin&&a.experience_years<parseFloat(t.experienceMin)||t.experienceMax&&a.experience_years>parseFloat(t.experienceMax)||t.salaryMin&&a.expected_salary<parseFloat(t.salaryMin)||t.salaryMax&&a.expected_salary>parseFloat(t.salaryMax))})})),z=u?i.flatMap(r=>r.applications).find(r=>r.id===u):null,W=i.reduce((r,a)=>r+a.count,0),q=r=>{$("hr.recruitment.applications.show",{job:s.id,application:r.id})},G=r=>{const a=["default","primary","secondary","warning","success","danger"];return a[r%a.length]||"default"};return e.jsxs(e.Fragment,{children:[e.jsx(Z,{title:`Recruitment Pipeline - ${s.title}`}),e.jsxs("div",{className:"flex flex-col w-full h-full p-4 md:p-6",role:"main",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-foreground mb-2",children:s.title}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-default-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(A,{className:"w-4 h-4"}),s.department?.name]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(P,{className:"w-4 h-4"}),W," candidates"]}),e.jsx(_,{size:"sm",color:s.status==="open"?"success":"default",children:s.status})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{size:"sm",variant:"flat",startContent:e.jsx(ee,{className:"w-4 h-4"}),onPress:()=>B.reload(),radius:c,children:"Refresh"}),e.jsx(S,{size:"sm",color:"primary",startContent:e.jsx(be,{className:"w-4 h-4"}),onPress:()=>$("hr.recruitment.applications.create",s.id),radius:c,children:"Add Candidate"})]})]})}),e.jsx(M,{className:"mb-6",radius:c,children:e.jsx(R,{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx(F,{placeholder:"Search candidates...",value:t.search,onValueChange:r=>f({...t,search:r}),startContent:e.jsx(Ce,{className:"w-4 h-4 text-default-400"}),size:"sm",radius:c,className:"md:col-span-2"}),e.jsxs(Se,{placeholder:"Source",selectedKeys:t.source?[t.source]:[],onSelectionChange:r=>f({...t,source:Array.from(r)[0]}),size:"sm",radius:c,children:[e.jsx(j,{children:"All Sources"},""),e.jsx(j,{children:"Referral"},"referral"),e.jsx(j,{children:"LinkedIn"},"linkedin"),e.jsx(j,{children:"Indeed"},"indeed"),e.jsx(j,{children:"Website"},"website"),e.jsx(j,{children:"Other"},"other")]}),e.jsx(F,{type:"number",placeholder:"Min Experience",value:t.experienceMin,onValueChange:r=>f({...t,experienceMin:r}),size:"sm",radius:c,endContent:e.jsx("span",{className:"text-xs text-default-400",children:"yrs"})}),e.jsx(F,{type:"number",placeholder:"Max Experience",value:t.experienceMax,onValueChange:r=>f({...t,experienceMax:r}),size:"sm",radius:c,endContent:e.jsx("span",{className:"text-xs text-default-400",children:"yrs"})}),e.jsx(S,{size:"sm",variant:"flat",startContent:e.jsx(_e,{className:"w-4 h-4"}),onPress:()=>f({search:"",source:"",experienceMin:"",experienceMax:"",salaryMin:"",salaryMax:""}),radius:c,children:"Clear"})]})})}),e.jsx("div",{className:"flex-1 overflow-x-auto",children:e.jsxs(ce,{sensors:T,collisionDetection:de,onDragStart:H,onDragEnd:K,onDragCancel:O,children:[e.jsx("div",{className:"flex gap-4 pb-4 min-w-max",children:U.map((r,a)=>e.jsx(Fe,{stage:r,color:G(a),onViewCandidate:q,themeRadius:c},r.id))}),e.jsx(me,{children:z?e.jsx("div",{className:"rotate-3 opacity-90",children:e.jsx(I,{application:z,isDragging:!0,themeRadius:c})}):null})]})})]})]})};Me.layout=s=>e.jsx(fe,{children:s});export{Me as default};
