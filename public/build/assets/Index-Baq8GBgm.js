import{r as x,a as c,j as e,H as se,b as d,l as te,M as E,F as ae,i as P,J as z,c as p,d as m,s as re,n as k,e as o,K as le}from"./app-CUKgmgkQ.js";import{A as ne,z as ie}from"./App-CvOoorjt.js";import{s as S}from"./toastUtils-BCw-PFPF.js";import{F as w}from"./CheckCircleIcon-BtkCgu8m.js";import{F as I}from"./DevicePhoneMobileIcon-BGVJ6NhH.js";import{F as de}from"./MagnifyingGlassIcon-Cas8aWJF.js";import{F as oe}from"./XMarkIcon-D9mnutVy.js";import{F as ce}from"./EyeIcon-BkMrBF9T.js";import{F as me}from"./GlobeAltIcon-DWEN_FH4.js";import{F as xe}from"./DeviceTabletIcon-ymOs6GC-.js";import{u as pe}from"./index--igxkbxI.js";import{i as he}from"./chunk-SQIAVXJX-BSDoHEaZ.js";import{s as R}from"./chunk-C3QHEOC2-CBY11Hc6.js";import{l as _}from"./chunk-Y5DMIIWQ-QT1gUwpI.js";import{t as ue,a as fe,b as je,c as ge}from"./chunk-F3UDT23P-B6ABEQDZ.js";import{t as ve,a as be}from"./chunk-YRZGWF2W-Bx4wDt5g.js";import{c as T}from"./chunk-PMMJMDBI-BZw8GU_o.js";import{p as _e}from"./chunk-NL7EUJG2-f92Tm8j5.js";import{t as C}from"./chunk-AUA5GDXN-C46Yqs3E.js";import{m as Ne,a as ye,b as we,c as Fe}from"./chunk-TW2E3XVA-COE9AJJ7.js";import{d as N}from"./chunk-IHO36JMK-Da6CysX7.js";import{m as ke}from"./chunk-5LXTSPS7-CZ21ezR9.js";import"./app-C-p_Tn8z.js";import"./index-Dzu-b3U6.js";/* empty css                      */import"./chunk-CV4BWJDJ-BhkohVh_.js";import"./index-Ci2maQVh.js";import"./index-NVAh7aiH.js";import"./UserIcon-8pNwIG1U.js";import"./PlusIcon-B8O-76eD.js";import"./Item-Bua0SRf7.js";import"./SelectionManager-B6ixbygR.js";import"./keyboard-DlCYvvGr.js";import"./index-cKZ86Ybs.js";import"./useDialog-DySdyj_3.js";import"./VisuallyHidden-CHV9OSia.js";import"./useLabels-BrQlrx-g.js";import"./chunk-WQVQ7P2I-BPjo0fU9.js";import"./number-CB4zbwAz.js";import"./index-DFJtv7Cd.js";import"./useSelectableItem-l0pHZh0p.js";import"./useTreeState-CSPYaXmS.js";import"./useMenuTriggerState-B-lXHpyB.js";import"./chunk-LGMZDQT5-BUrMXbuP.js";import"./Cog6ToothIcon-Bd2U0cAU.js";import"./useBranding-pYw2Hzzv.js";import"./useMediaQuery-D1T4P2tz.js";import"./ShieldCheckIcon-BLPk1DHg.js";import"./AcademicCapIcon-oebKVwHX.js";import"./IdentificationIcon-C8gDKdht.js";import"./ArrowLeftIcon-Dj3RuXoT.js";import"./ArrowRightIcon-BJjTlz_O.js";import"./BriefcaseIcon-Bgg5MBD1.js";import"./BuildingOfficeIcon-CH8PKk1B.js";import"./CalendarDaysIcon-BYBK8ahe.js";import"./CalendarIcon-Csr73T5I.js";import"./CircleStackIcon-BW9xW7cx.js";import"./ClipboardDocumentCheckIcon-DWTU-LPH.js";import"./CpuChipIcon-mcbXnAg0.js";import"./CurrencyDollarIcon-CnTYtBXi.js";import"./DocumentArrowUpIcon-i_-dGzbv.js";import"./DocumentIcon-H6SY8Apv.js";import"./EnvelopeIcon-F7b6B4-f.js";import"./InformationCircleIcon-BJy93gUz.js";import"./KeyIcon-B79OyKRq.js";import"./LockClosedIcon-HF4CRMyG.js";import"./MapPinIcon-BCZPO731.js";import"./PlusCircleIcon-DZoA9ZJ-.js";import"./PrinterIcon-o8fN_3io.js";import"./UserCircleIcon-CZfyut7Z.js";import"./UserGroupIcon-BOh_uzO9.js";import"./useHasTabbableChild-CGrbfQoB.js";import"./MaintenanceModeBanner-C_ymobah.js";import"./index-4Gv1aAW-.js";import"./chunk-KQW2TNLT-BJ9m50sz.js";import"./chunk-ICU6NNET-7RZ9nPEr.js";import"./useLabel-BCvojCgc.js";import"./chunk-7F3ZLNJ6-DjpfC3pM.js";import"./index-9IyGFsSn.js";import"./useToggleState-D0KmqrFs.js";import"./chunk-OH2E76JR-CEiKCNOE.js";const g=({title:t,value:v,icon:h,color:i="default"})=>{const l={default:"bg-default-100 text-default-600",danger:"bg-danger-100 text-danger-600",success:"bg-success-100 text-success-600",warning:"bg-warning-100 text-warning-600",primary:"bg-primary-100 text-primary-600"};return e.jsx(p,{className:"transition-all duration-200",style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",background:`linear-gradient(135deg, 
                    var(--theme-content1, #FAFAFA) 20%, 
                    var(--theme-content2, #F4F4F5) 10%, 
                    var(--theme-content3, #F1F3F4) 20%)`},children:e.jsxs(m,{className:"flex flex-row items-center gap-4 py-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${l[i]}`,children:e.jsx(h,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-default-500",children:t}),e.jsx("p",{className:"text-2xl font-bold",children:v})]})]})})},Se=({errorLog:t,isOpen:v,onClose:h,onResolve:i})=>{const[l,b]=x.useState(!1);if(!t)return null;const u=()=>{navigator.clipboard.writeText(t.trace_id),b(!0),setTimeout(()=>b(!1),2e3)};return e.jsx(Ne,{isOpen:v,onClose:h,size:"3xl",scrollBehavior:"inside",children:e.jsxs(ye,{children:[e.jsxs(we,{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-5 h-5 text-danger"}),"Error Details"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm font-mono bg-danger-100 dark:bg-danger-900/30 text-danger px-2 py-1 rounded",children:t.trace_id}),e.jsx(d,{size:"sm",variant:"flat",isIconOnly:!0,onPress:u,children:e.jsx(le,{className:"w-4 h-4"})}),l&&e.jsx("span",{className:"text-xs text-success",children:"Copied!"})]})]}),e.jsx(Fe,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx(o,{color:t.resolved_at?"success":"danger",variant:"flat",children:t.resolved_at?"Resolved":"Unresolved"}),e.jsx(o,{color:"primary",variant:"flat",children:t.error_type}),e.jsx(o,{color:t.origin==="frontend"?"warning":"secondary",variant:"flat",startContent:t.origin==="frontend"?e.jsx(I,{className:"w-3 h-3"}):e.jsx(z,{className:"w-3 h-3"}),children:t.origin}),t.http_code>0&&e.jsxs(o,{color:"default",variant:"bordered",children:["HTTP ",t.http_code]})]}),e.jsx(N,{}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-default-500 uppercase mb-2 block",children:"Error Message"}),e.jsx(p,{className:"bg-danger-50 dark:bg-danger-900/20",children:e.jsx(m,{children:e.jsx("p",{className:"text-sm font-mono whitespace-pre-wrap break-all",children:t.error_message})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(me,{className:"w-4 h-4 text-default-400 mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{className:"text-xs text-default-500",children:"Request URL"}),e.jsx("p",{className:"text-sm break-all",children:t.request_url||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(P,{className:"w-4 h-4 text-default-400 mt-1"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-default-500",children:"Occurred At"}),e.jsx("p",{className:"text-sm",children:new Date(t.created_at).toLocaleString()})]})]})]}),t.request_method&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{size:"sm",variant:"bordered",children:t.request_method}),e.jsx("span",{className:"text-sm text-default-500",children:"Request Method"})]}),t.user_agent&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-default-400 mt-1"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("label",{className:"text-xs text-default-500",children:"User Agent"}),e.jsx("p",{className:"text-xs text-default-600 break-all",children:t.user_agent})]})]}),t.stack_trace&&e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-default-500 uppercase mb-2 block",children:"Stack Trace"}),e.jsx(p,{children:e.jsx(m,{className:"p-0",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap overflow-auto max-h-64 p-4 bg-default-100 dark:bg-default-800 rounded-lg font-mono",children:t.stack_trace})})})]})]}),t.request_payload&&Object.keys(t.request_payload).length>0&&e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-default-500 uppercase mb-2 block",children:"Request Payload"}),e.jsx(p,{children:e.jsx(m,{children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap overflow-auto max-h-48 font-mono",children:JSON.stringify(t.request_payload,null,2)})})})]})]}),t.context&&Object.keys(t.context).length>0&&e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-default-500 uppercase mb-2 block",children:"Context"}),e.jsx(p,{children:e.jsx(m,{children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap overflow-auto max-h-48 font-mono",children:JSON.stringify(t.context,null,2)})})})]})]}),t.tenant_id&&e.jsxs(e.Fragment,{children:[e.jsx(N,{}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-default-500",children:"Tenant ID:"}),e.jsx("code",{className:"text-xs font-mono bg-default-100 px-2 py-1 rounded",children:t.tenant_id})]})]})]})}),e.jsxs(ke,{children:[!t.resolved_at&&e.jsx(d,{color:"success",variant:"flat",startContent:e.jsx(w,{className:"w-4 h-4"}),onPress:()=>{i(t.id),h()},children:"Mark Resolved"}),e.jsx(d,{variant:"light",onPress:h,children:"Close"})]})]})})};function st({errorLogs:t={data:[],meta:{}},errorTypes:v=[],httpCodes:h=[],stats:i={},filters:l={}}){const[b,u]=x.useState(!1),[y,A]=x.useState(l.search||""),[D,q]=x.useState(null),[a,f]=x.useState([]),{isOpen:M,onOpen:U,onClose:H}=pe(),[n,$]=x.useState({error_type:l.error_type||"",http_code:l.http_code||"",origin:l.origin||"",resolved:l.resolved||"",start_date:l.start_date||"",end_date:l.end_date||""}),B=x.useCallback(s=>{A(s);const r=setTimeout(()=>{c.get(route("admin.error-logs.index"),{...n,search:s},{preserveState:!0,preserveScroll:!0})},500);return()=>clearTimeout(r)},[n]),F=(s,r)=>{const j={...n,[s]:r};$(j),c.get(route("admin.error-logs.index"),{...j,search:y},{preserveState:!0,preserveScroll:!0,onStart:()=>u(!0),onFinish:()=>u(!1)})},V=()=>{$({error_type:"",http_code:"",origin:"",resolved:"",start_date:"",end_date:""}),A(""),c.get(route("admin.error-logs.index"),{},{preserveState:!0,preserveScroll:!0})},W=s=>{q(s),U()},O=async s=>{const r=k.post(route("admin.error-logs.resolve",s));S.promise(r,{loading:"Marking as resolved...",success:"Error marked as resolved",error:"Failed to resolve error"}),r.then(()=>{c.reload({only:["errorLogs","stats"]})})},J=async()=>{if(a.length===0)return;const s=k.post(route("admin.error-logs.bulk-resolve"),{ids:a});S.promise(s,{loading:`Resolving ${a.length} errors...`,success:`${a.length} errors marked as resolved`,error:"Failed to resolve errors"}),s.then(()=>{f([]),c.reload({only:["errorLogs","stats"]})})},K=async()=>{if(a.length===0)return;const s=k.post(route("admin.error-logs.bulk-destroy"),{ids:a});S.promise(s,{loading:`Deleting ${a.length} errors...`,success:`${a.length} errors deleted`,error:"Failed to delete errors"}),s.then(()=>{f([]),c.reload({only:["errorLogs","stats"]})})},Q=s=>{c.get(route("admin.error-logs.index"),{...n,search:y,page:s},{preserveState:!0,preserveScroll:!0,onStart:()=>u(!0),onFinish:()=>u(!1)})},G=s=>{f(s?t.data.map(r=>r.id):[])},X=(s,r)=>{f(r?[...a,s]:a.filter(j=>j!==s))},Y=Object.values(n).some(s=>s)||y,Z=[{key:"select",label:""},{key:"trace_id",label:"Error Code"},{key:"error_type",label:"Type"},{key:"http_code",label:"HTTP"},{key:"error_message",label:"Message"},{key:"origin",label:"Origin"},{key:"created_at",label:"Occurred"},{key:"status",label:"Status"},{key:"actions",label:"Actions"}],L=s=>!s||s===0?"default":s>=500?"danger":s>=400?"warning":s>=300?"primary":"success",ee=(s,r)=>{switch(r){case"select":return e.jsx(T,{isSelected:a.includes(s.id),onValueChange:j=>X(s.id,j)});case"trace_id":return e.jsxs("code",{className:"text-xs font-mono bg-default-100 px-2 py-1 rounded",children:[s.trace_id?.substring(0,16),"..."]});case"error_type":return e.jsx(o,{size:"sm",variant:"flat",color:"primary",children:s.error_type||"Unknown"});case"http_code":return s.http_code>0?e.jsx(o,{size:"sm",variant:"flat",color:L(s.http_code),children:s.http_code}):e.jsx("span",{className:"text-default-400",children:"-"});case"error_message":return e.jsx(C,{content:s.error_message,placement:"top",delay:500,children:e.jsxs("span",{className:"text-sm max-w-xs truncate block",children:[s.error_message?.substring(0,50),s.error_message?.length>50?"...":""]})});case"origin":return e.jsx(o,{size:"sm",variant:"dot",color:s.origin==="frontend"?"warning":"secondary",children:s.origin});case"created_at":return e.jsx("span",{className:"text-sm text-default-500",children:new Date(s.created_at).toLocaleString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})});case"status":return e.jsx(o,{size:"sm",variant:"flat",color:s.resolved_at?"success":"danger",children:s.resolved_at?"Resolved":"Open"});case"actions":return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(C,{content:"View Details",children:e.jsx(d,{isIconOnly:!0,size:"sm",variant:"light",onPress:()=>W(s),children:e.jsx(ce,{className:"w-4 h-4"})})}),!s.resolved_at&&e.jsx(C,{content:"Mark Resolved",children:e.jsx(d,{isIconOnly:!0,size:"sm",variant:"light",color:"success",onPress:()=>O(s.id),children:e.jsx(w,{className:"w-4 h-4"})})})]});default:return s[r]}};return e.jsxs(ne,{children:[e.jsx(se,{title:"Error Logs"}),e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Error Logs"}),e.jsx("p",{className:"text-default-500 mt-1",children:"Monitor and manage application errors"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(d,{isIconOnly:!0,variant:"flat",onPress:()=>c.reload({only:["errorLogs","stats"]}),isLoading:b,children:e.jsx(te,{className:"w-4 h-4"})})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6",children:[e.jsx(g,{title:"Total Errors",value:i.total||0,icon:E,color:"default"}),e.jsx(g,{title:"Unresolved",value:i.unresolved||0,icon:ae,color:"danger"}),e.jsx(g,{title:"Resolved",value:i.resolved||0,icon:w,color:"success"}),e.jsx(g,{title:"Today",value:i.today||0,icon:P,color:"warning"}),e.jsx(g,{title:"Frontend",value:i.frontend||0,icon:I,color:"primary"}),e.jsx(g,{title:"Backend",value:i.backend||0,icon:z,color:"default"})]}),e.jsx(p,{className:"mb-6",style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",background:`linear-gradient(135deg, 
                                var(--theme-content1, #FAFAFA) 20%, 
                                var(--theme-content2, #F4F4F5) 10%, 
                                var(--theme-content3, #F1F3F4) 20%)`},children:e.jsx(m,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(he,{placeholder:"Search by trace ID, message, URL...",value:y,onValueChange:B,startContent:e.jsx(de,{className:"w-4 h-4 text-default-400"}),className:"flex-1",classNames:{inputWrapper:"bg-default-100"}}),e.jsx(R,{placeholder:"Error Type",selectedKeys:n.error_type?[n.error_type]:[],onSelectionChange:s=>F("error_type",Array.from(s)[0]||""),className:"w-full sm:w-48",classNames:{trigger:"bg-default-100"},children:v.map(s=>e.jsx(_,{children:s},s))}),e.jsxs(R,{placeholder:"Origin",selectedKeys:n.origin?[n.origin]:[],onSelectionChange:s=>F("origin",Array.from(s)[0]||""),className:"w-full sm:w-36",classNames:{trigger:"bg-default-100"},children:[e.jsx(_,{children:"Frontend"},"frontend"),e.jsx(_,{children:"Backend"},"backend")]}),e.jsxs(R,{placeholder:"Status",selectedKeys:n.resolved?[n.resolved]:[],onSelectionChange:s=>F("resolved",Array.from(s)[0]||""),className:"w-full sm:w-36",classNames:{trigger:"bg-default-100"},children:[e.jsx(_,{children:"Unresolved"},"unresolved"),e.jsx(_,{children:"Resolved"},"resolved")]}),Y&&e.jsx(d,{variant:"flat",color:"danger",startContent:e.jsx(oe,{className:"w-4 h-4"}),onPress:V,children:"Clear"})]}),a.length>0&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-primary-50 dark:bg-primary-900/20 rounded-lg",children:[e.jsxs("span",{className:"text-sm font-medium",children:[a.length," selected"]}),e.jsx(d,{size:"sm",color:"success",variant:"flat",startContent:e.jsx(w,{className:"w-4 h-4"}),onPress:J,children:"Resolve Selected"}),e.jsx(d,{size:"sm",color:"danger",variant:"flat",startContent:e.jsx(ie,{className:"w-4 h-4"}),onPress:K,children:"Delete Selected"})]})]})})}),e.jsxs(p,{style:{border:"var(--borderWidth, 2px) solid transparent",borderRadius:"var(--borderRadius, 12px)",background:`linear-gradient(135deg, 
                                var(--theme-content1, #FAFAFA) 20%, 
                                var(--theme-content2, #F4F4F5) 10%, 
                                var(--theme-content3, #F1F3F4) 20%)`},children:[e.jsx(m,{className:"p-0",children:e.jsxs(ue,{"aria-label":"Error logs table",isHeaderSticky:!0,classNames:{wrapper:"shadow-none",th:"bg-default-100 text-default-600 font-semibold",td:"py-3"},children:[e.jsx(ve,{columns:Z,children:s=>e.jsx(be,{width:s.key==="select"?40:void 0,children:s.key==="select"?e.jsx(T,{isSelected:a.length===t.data?.length&&t.data?.length>0,isIndeterminate:a.length>0&&a.length<t.data?.length,onValueChange:G}):s.label},s.key)}),e.jsx(fe,{items:t.data||[],emptyContent:"No errors found",isLoading:b,loadingContent:e.jsx(re,{}),children:s=>e.jsx(je,{children:r=>e.jsx(ge,{children:ee(s,r)})},s.id)})]})}),t.meta&&t.meta.last_page>1&&e.jsx(m,{className:"border-t border-divider",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-default-500",children:["Showing ",t.meta.from," to ",t.meta.to," of ",t.meta.total," errors"]}),e.jsx(_e,{total:t.meta.last_page,page:t.meta.current_page,onChange:Q,showControls:!0})]})})]})]})}),e.jsx(Se,{errorLog:D,isOpen:M,onClose:H,onResolve:O})]})}export{st as default};
