import{r as j,j as e,c as y,d as m,m as b,A as N}from"./app-D_-WVEdp.js";import{d as w,S as v,v as _}from"./sortable.esm-ClQuBHuG.js";import S from"./DealCard-BnV-oG1O.js";import{F as n}from"./DocumentIcon-DRP7gf4p.js";import{F as D}from"./CurrencyDollarIcon-BBdTvttm.js";import{c as F}from"./chunk-C6WKGNND-DzOcfHNA.js";import{p as k}from"./chunk-VFIJPDYX-BIb_-4ja.js";import{s as R}from"./chunk-P7ACKWSP-BuXM4uR7.js";import"./app-Bq-q9uAS.js";import"./UserIcon-DG_m3xOa.js";import"./CalendarDaysIcon-Bilw7IDH.js";import"./chunk-AUA5GDXN-DN3ZdlyW.js";import"./index-D0ogoVNn.js";import"./index-C-9Wnuxw.js";import"./chunk-WQVQ7P2I-CH5xj4JM.js";import"./number-CB4zbwAz.js";import"./chunk-LGMZDQT5-CaoNqm2A.js";import"./chunk-CV4BWJDJ-ubOVN7k0.js";import"./index-BMj_EV_H.js";import"./useProgressBar-DIVFXVmB.js";import"./useLabel-sAk_8DNM.js";import"./useLabels-CUZ0Yc-W.js";import"./useNumberFormatter-DMU-5BZ9.js";import"./NumberFormatter-DNR9MAW-.js";const ae=j.memo(function({stage:a,deals:s=[],isLoading:c=!1,formatCurrency:r}){const{setNodeRef:d,isOver:i}=w({id:`stage-${a.id}`,data:{type:"stage",stage:a}}),x=s.map(t=>t.id),p=s.reduce((t,g)=>t+(g.value||0),0),f=t=>r?r(t):new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0,notation:t>=1e6?"compact":"standard"}).format(t),u=()=>{const t=a.color||"#6366f1";return{borderTopColor:t,"--stage-color":t}},l=(()=>{switch(a.stage_type){case"won":return{color:"success",label:"Won"};case"lost":return{color:"danger",label:"Lost"};default:return null}})(),o=a.max_deals&&s.length>=a.max_deals,h=a.max_deals?s.length/a.max_deals*100:0;return e.jsxs("div",{className:"flex flex-col h-full min-w-[300px] max-w-[320px] shrink-0",children:[e.jsx(y,{className:`
                    mb-3 border-t-4 transition-all duration-200
                    ${i?"ring-2 ring-primary-500 shadow-lg":"shadow-sm"}
                `,style:u(),children:e.jsxs(F,{className:"pb-2 pt-3 px-4 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:a.name}),l&&e.jsx(m,{size:"sm",variant:"flat",color:l.color,className:"text-tiny",children:l.label})]}),e.jsxs(m,{size:"sm",variant:"flat",color:o?"warning":"default",className:"text-tiny",children:[e.jsx(n,{className:"w-3 h-3 mr-1"}),s.length,a.max_deals&&`/${a.max_deals}`]})]}),e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-default-500",children:[e.jsx(D,{className:"w-4 h-4 text-success-500"}),e.jsx("span",{className:"text-sm font-semibold text-success-600 dark:text-success-400",children:f(p)})]}),e.jsxs("span",{className:"text-xs text-default-400",children:[a.probability,"% probability"]})]}),a.max_deals&&e.jsx(k,{size:"sm",value:h,color:o?"warning":"primary",className:"mt-1","aria-label":"Stage capacity"})]})}),e.jsx("div",{ref:d,className:`
                    flex-1 overflow-y-auto px-1 py-2 rounded-lg
                    transition-all duration-200 min-h-[200px]
                    ${i?"bg-primary-100/50 dark:bg-primary-900/20 ring-2 ring-dashed ring-primary-400":"bg-default-100/50 dark:bg-default-50/5"}
                `,children:c?e.jsx("div",{className:"space-y-2 p-2",children:[1,2,3].map(t=>e.jsx(R,{className:"rounded-lg",children:e.jsx("div",{className:"h-28 rounded-lg bg-default-200"})},t))}):s.length===0?e.jsxs(b.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col items-center justify-center h-full text-center p-4",children:[e.jsx(n,{className:"w-10 h-10 text-default-300 mb-2"}),e.jsx("p",{className:"text-sm text-default-400",children:"No deals in this stage"}),e.jsx("p",{className:"text-xs text-default-300 mt-1",children:"Drag deals here to move them"})]}):e.jsx(v,{items:x,strategy:_,children:e.jsx(N,{mode:"popLayout",children:s.map(t=>e.jsx(S,{deal:t,formatCurrency:r},t.id))})})})]})});export{ae as default};
