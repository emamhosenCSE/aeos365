import{R as ye,u as be,r as o,j as e,F as z,p as A,e as $,m as we,c as b,a as Ne,d as D,b as F,s as je,S as ke,f as ee}from"./app-C5lQX7UO.js";import{s as f}from"./toastUtils-FOPlT_v5.js";import{as as Ce,ag as Fe,C as Pe,at as Ie,au as te}from"./App-b0cSRXv4.js";import{F as Se}from"./BuildingOfficeIcon-DHDfq3Il.js";import{F as M}from"./MapPinIcon-C1ZKJRuX.js";import{F as Te}from"./ShieldCheckIcon-Lr4RcW0o.js";import{F as re}from"./InformationCircleIcon-CvrzIYvC.js";import{F as Re}from"./CalendarIcon-DLOXfZsM.js";import{F as ae}from"./CheckCircleIcon-BDeABBju.js";import{F as _e}from"./GlobeAltIcon-DSSOsrBF.js";import{t as H}from"./chunk-AUA5GDXN-BfGxDRDE.js";import{a as De,b as Ee}from"./chunk-HAJUSXOG-CoVI4beT.js";import{m as se,a as oe,b as ne,c as ie}from"./chunk-TW2E3XVA-BpqqyJRF.js";import{m as le}from"./chunk-5LXTSPS7-5Ebaxja-.js";import"./app-Bq-q9uAS.js";import"./index-BeiV6kVn.js";/* empty css                      */import"./routeUtils-Dar4FrIb.js";import"./chunk-CV4BWJDJ-C2siGNsy.js";import"./index-DhmF-6Cs.js";import"./index-BXRhekn9.js";import"./UserIcon-Bny3-uxA.js";import"./PlusIcon-hCCa9Avo.js";import"./Item-Cf2efc_s.js";import"./SelectionManager-DOykb5Zn.js";import"./keyboard-BROQwhc4.js";import"./index-CZEthvtF.js";import"./useDialog-CPcCu8EE.js";import"./VisuallyHidden-BIYdY5qX.js";import"./useLabels-BSPM8vAp.js";import"./chunk-WQVQ7P2I-Das5P9Cf.js";import"./number-CB4zbwAz.js";import"./index-DuvEf_dB.js";import"./useSelectableItem-D9HgBYPJ.js";import"./chunk-IHO36JMK-C2CY5vR0.js";import"./useTreeState-7-jX6Eit.js";import"./useMenuTriggerState-Bm6SXfn-.js";import"./chunk-LGMZDQT5-JOtjRivx.js";import"./Cog6ToothIcon-BxIVzCrx.js";import"./useBranding-BdLeVaZK.js";import"./XMarkIcon-67ql1OSv.js";import"./chunk-SQIAVXJX-JCrnSLUk.js";import"./chunk-KQW2TNLT-FgiaJ7J5.js";import"./chunk-ICU6NNET-KTThvCTm.js";import"./useLabel-BcTiTZIt.js";import"./MagnifyingGlassIcon-FD9b4416.js";import"./useMediaQuery-DKZmmC24.js";import"./chunk-C3QHEOC2-C4U64fsk.js";import"./chunk-Y5DMIIWQ-CcWrQJnK.js";import"./index-DeaY2kDj.js";import"./chunk-7F3ZLNJ6-DwE1PLMW.js";import"./AcademicCapIcon-qLTocPBU.js";import"./IdentificationIcon-DDN2LgD3.js";import"./ArrowLeftIcon-CEF9dMYC.js";import"./ArrowRightIcon-D5L4KbEU.js";import"./BriefcaseIcon-MCw9JH5Q.js";import"./CalendarDaysIcon-B0vwq9qL.js";import"./CircleStackIcon-Bn_usKCe.js";import"./ClipboardDocumentCheckIcon-DbCJJdKR.js";import"./CogIcon-Bp9coc2a.js";import"./DeviceTabletIcon-DzmMmOeR.js";import"./CpuChipIcon-Do_08dh9.js";import"./CurrencyDollarIcon-BeQq8PBJ.js";import"./DevicePhoneMobileIcon-CaXezoVt.js";import"./DocumentArrowUpIcon-CUP7Txvb.js";import"./DocumentIcon-BaxxzUaB.js";import"./EnvelopeIcon-BV7JE3W8.js";import"./ExclamationCircleIcon-FoF6j9gu.js";import"./EyeIcon-1Rngeclu.js";import"./KeyIcon-BkwPixaL.js";import"./LockClosedIcon-CBY3J_Eq.js";import"./PlusCircleIcon-BOXDRGJR.js";import"./PrinterIcon-BkL3DXP0.js";import"./RocketLaunchIcon-oIcFgtS_.js";import"./ShoppingCartIcon-CTTedb3q.js";import"./UserCircleIcon-CGukKXVi.js";import"./UserGroupIcon-BUxfF95Y.js";import"./chunk-I3A4XRYQ-DAco9gg9.js";import"./useToggleState-BJ_Q2hhA.js";import"./MaintenanceModeBanner-WmsYYFVK.js";import"./chunk-OH2E76JR-CNd1Dliv.js";const Le=(R,x)=>{let j;return function(...a){const h=()=>{clearTimeout(j),R(...a)};clearTimeout(j),j=setTimeout(h,x)}},Oe=()=>{const[R,x]=o.useState({isMobile:!1,isTablet:!1,isDesktop:!1}),j=o.useCallback(()=>{const w=window.innerWidth,a={isMobile:w<=768,isTablet:w>768&&w<=1024,isDesktop:w>1024};x(h=>JSON.stringify(h)!==JSON.stringify(a)?a:h)},[]);return o.useEffect(()=>{j();const w=Le(j,150);return window.addEventListener("resize",w),()=>window.removeEventListener("resize",w)},[j]),R},c={CHECKING:"checking",ACTIVE:"active",DENIED:"denied",INACTIVE:"inactive"},We=ye.memo(()=>{const{auth:R}=be().props,x=R.user,{isMobile:j,isTablet:w}=Oe(),[a,h]=o.useState({currentStatus:null,todayPunches:[],totalWorkTime:"00:00:00",realtimeWorkTime:"00:00:00",userOnLeave:null,loading:!1,lastRefresh:null}),[l,P]=o.useState({status:c.CHECKING,coordinates:null,error:null,lastUpdate:null}),[ce,U]=o.useState({sessionDialogOpen:!1,expandedSections:{punches:!1,stats:!1,validation:!1}}),[C,E]=o.useState({currentTime:new Date,connectionStatus:{network:!0,device:!0},sessionInfo:{ip:"Unknown",accuracy:"N/A",timestamp:null}}),[i,g]=o.useState({isOpen:!1,capturedPhoto:null,isCapturing:!1,stream:null,pendingPunchData:null,facingMode:"user",isSwitching:!1}),N=o.useRef(null),G=o.useRef(null),B=o.useMemo(()=>{const t=x?.attendance_type;if(!t?.slug)return!1;const r=t.slug.replace(/_\d+$/,"");return["geo_polygon","route_waypoint"].includes(r)},[x?.attendance_type]),I=o.useCallback(()=>new Promise((t,r)=>{if(!navigator.geolocation){r(new Error("Geolocation is not supported by this browser"));return}const s={enableHighAccuracy:!0,timeout:15e3,maximumAge:3e4};navigator.geolocation.getCurrentPosition(n=>{const m={latitude:n.coords.latitude,longitude:n.coords.longitude,accuracy:n.coords.accuracy,timestamp:new Date(n.timestamp)};t(m)},n=>{let m="Location unavailable";switch(n.code){case 1:m="Location access denied. Please allow location permission in your browser settings.";break;case 2:m="Location unavailable. Please ensure GPS is enabled.";break;case 3:m="Location request timed out. Please try again.";break;default:m="Unable to retrieve location. Please try again."}r(new Error(m))},s)}),[]),_=o.useCallback(async()=>{P(t=>({...t,status:c.CHECKING,error:null}));try{const t=await I();P({status:c.ACTIVE,coordinates:t,error:null,lastUpdate:new Date})}catch(t){const r=t.message.includes("denied")||t.message.includes("Permission");P({status:r?c.DENIED:c.INACTIVE,coordinates:null,error:t.message,lastUpdate:new Date})}},[I]),K=o.useCallback(async()=>{if(l.status===c.DENIED)try{P(r=>({...r,status:c.CHECKING,error:null}));const t=await I();P({status:c.ACTIVE,coordinates:t,error:null,lastUpdate:new Date}),f.success("Location access granted successfully!",{style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-success)",color:"var(--theme-success-foreground)"}})}catch{P(r=>({...r,status:c.DENIED,error:"Location access still denied. Please check your browser settings."})),f.error("Please enable location in your browser settings manually.",{style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-danger)",color:"var(--theme-danger-foreground)"}})}},[l.status,I]),v=o.useMemo(()=>{if(a.userOnLeave)return{color:"warning",text:"On Leave",action:"On Leave",icon:e.jsx(z,{className:"w-4 h-4"})};switch(a.currentStatus){case"punched_in":return{color:"success",text:"Checked In",action:"Check Out",icon:e.jsx(Fe,{className:"w-4 h-4"})};case"punched_out":return{color:"primary",text:"Checked Out",action:"Check In",icon:e.jsx(Ce,{className:"w-4 h-4"})};default:return{color:"primary",text:"Ready to Check In",action:"Check In",icon:e.jsx(A,{className:"w-4 h-4"})}}},[a.currentStatus,a.userOnLeave]),Y=o.useMemo(()=>({sessionsToday:a.todayPunches.length,averageSessionTime:a.todayPunches.length>0?Math.round(parseFloat(a.realtimeWorkTime.split(":")[0])/a.todayPunches.length*100)/100:0,productivity:Math.min(100,parseFloat(a.realtimeWorkTime.split(":")[0])/8*100)}),[a.todayPunches,a.realtimeWorkTime]),k=o.useMemo(()=>{switch(l.status){case c.CHECKING:return{color:"default",variant:"flat",text:"Checking",clickable:!1,tooltip:"Checking location permissions..."};case c.ACTIVE:return{color:"success",variant:"flat",text:"GPS",clickable:!1,tooltip:`Location: Active (¬±${Math.round(l.coordinates?.accuracy||0)}m)`};case c.DENIED:return{color:"danger",variant:"bordered",text:"GPS",clickable:!0,tooltip:"Location access denied. Click to retry."};case c.INACTIVE:return{color:"warning",variant:"bordered",text:"GPS",clickable:!0,tooltip:"Location unavailable. Click to retry."};default:return{color:"default",variant:"flat",text:"GPS",clickable:!1,tooltip:"Location status unknown"}}},[l.status,l.coordinates?.accuracy]),q=o.useCallback(()=>{const t=new Date;let r=0,s=!1;if(a.todayPunches.forEach(d=>{if(d.punchin_time){let S;try{if(S=new Date(d.punchin_time),isNaN(S.getTime())||typeof d.punchin_time=="string"&&d.punchin_time.includes(":")&&!d.punchin_time.includes("T")){const p=new Date,[W,T,V]=d.punchin_time.split(":");S=new Date(p.getFullYear(),p.getMonth(),p.getDate(),parseInt(W),parseInt(T),parseInt(V||0))}}catch{console.warn("Invalid punch in time format:",d.punchin_time);return}if(isNaN(S.getTime()))return;if(d.punchout_time){let p;try{if(p=new Date(d.punchout_time),isNaN(p.getTime())||typeof d.punchout_time=="string"&&d.punchout_time.includes(":")&&!d.punchout_time.includes("T")){const T=new Date,[V,ge,ve]=d.punchout_time.split(":");p=new Date(T.getFullYear(),T.getMonth(),T.getDate(),parseInt(V),parseInt(ge),parseInt(ve||0))}}catch{console.warn("Invalid punch out time format:",d.punchout_time);return}if(isNaN(p.getTime()))return;const W=Math.floor((p-S)/1e3);W>0&&(r+=W)}else{s=!0;const p=Math.floor((t-S)/1e3);p>0&&(r+=p)}}}),!s&&a.totalWorkTime&&a.totalWorkTime!=="00:00:00"){h(d=>({...d,realtimeWorkTime:a.totalWorkTime}));return}(isNaN(r)||r<0)&&(r=0);const n=Math.floor(r/3600),m=Math.floor(r%3600/60),u=r%60,xe=`${n.toString().padStart(2,"0")}:${m.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`;h(d=>({...d,realtimeWorkTime:xe}))},[a.todayPunches,a.totalWorkTime]),y=o.useCallback(async()=>{try{const r=(await $.get(route("attendance.current-user-punch"),{params:{t:Date.now()}})).data;h(s=>({...s,todayPunches:r.punches||[],totalWorkTime:r.total_production_time||"00:00:00",realtimeWorkTime:r.total_production_time||"00:00:00",userOnLeave:r.isUserOnLeave,lastRefresh:new Date,currentStatus:r.punches&&r.punches.length>0?r.punches[r.punches.length-1].punchout_time?"punched_out":"punched_in":"not_punched"}))}catch(t){console.error("Error fetching current status:",t),f.error("Failed to fetch attendance status")}},[]),J=o.useCallback(()=>{const t=document.createElement("canvas"),r=t.getContext("2d");return r.textBaseline="top",r.font="14px Arial",r.fillText("Device fingerprint",2,2),{userAgent:navigator.userAgent,screen:`${screen.width}x${screen.height}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,language:navigator.language,canvasFingerprint:t.toDataURL(),timestamp:Date.now()}},[]),L=o.useCallback(async(t="user")=>{try{i.stream&&i.stream.getTracks().forEach(s=>s.stop());const r=await navigator.mediaDevices.getUserMedia({video:{facingMode:t,width:{ideal:1280},height:{ideal:720}}});N.current&&(N.current.srcObject=r,await N.current.play()),g(s=>({...s,stream:r,isCapturing:!1,isSwitching:!1,facingMode:t}))}catch(r){console.error("Camera access error:",r);try{const s=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720}}});N.current&&(N.current.srcObject=s,await N.current.play()),g(n=>({...n,stream:s,isCapturing:!1,isSwitching:!1}))}catch{f.error("Unable to access camera. Please check permissions."),g(n=>({...n,isOpen:!1,isSwitching:!1}))}}},[i.stream]),de=o.useCallback(async()=>{const t=i.facingMode==="environment"?"user":"environment";g(r=>({...r,isSwitching:!0})),await L(t)},[i.facingMode,L]),O=o.useCallback(()=>{i.stream&&i.stream.getTracks().forEach(t=>t.stop()),g(t=>({...t,stream:null,isOpen:!1,capturedPhoto:null,facingMode:"user",isSwitching:!1}))},[i.stream]),me=o.useCallback(async()=>{if(!(!N.current||!G.current)){g(t=>({...t,isCapturing:!0}));try{const t=N.current,r=G.current,s=r.getContext("2d");r.width=t.videoWidth,r.height=t.videoHeight,s.drawImage(t,0,0);const n=l.coordinates;if(n){const u=`üìç ${n.latitude.toFixed(6)}, ${n.longitude.toFixed(6)} | ${new Date().toLocaleString()}`;s.fillStyle="rgba(0, 0, 0, 0.7)",s.fillRect(0,r.height-40,r.width,40),s.fillStyle="#ffffff",s.font="bold 16px Arial",s.textBaseline="middle",s.fillText(u,10,r.height-20)}const m=r.toDataURL("image/jpeg",.85);g(u=>({...u,capturedPhoto:m,isCapturing:!1})),f.success("Photo captured successfully!")}catch(t){console.error("Photo capture error:",t),f.error("Failed to capture photo. Please try again."),g(r=>({...r,isCapturing:!1}))}}},[l.coordinates]),ue=o.useCallback(()=>{g(t=>({...t,capturedPhoto:null}))},[]),he=o.useCallback(async()=>{if(!i.capturedPhoto||!i.pendingPunchData){f.error("Please capture a photo first.");return}h(t=>({...t,loading:!0})),O();try{const t={...i.pendingPunchData,photo:i.capturedPhoto},r=await $.post(route("attendance.punch"),t);r.data.status==="success"?(U(s=>({...s,sessionDialogOpen:!0})),setTimeout(()=>{y()},500)):f.error(r.data.message)}catch(t){console.error("Punch operation failed:",t);const r=t.response?.data?.message||"Unable to record attendance. Please try again.";f.error(r)}finally{h(t=>({...t,loading:!1})),g(t=>({...t,pendingPunchData:null,capturedPhoto:null}))}},[i.capturedPhoto,i.pendingPunchData,O,y]),X=o.useCallback(async t=>{g(r=>({...r,isOpen:!0,pendingPunchData:t,capturedPhoto:null})),setTimeout(()=>L(),300)},[L]),pe=o.useCallback(async()=>{if(a.userOnLeave){f.warning("You are on leave today. Cannot punch in/out.");return}if(l.status!==c.ACTIVE){f.error("Location access required for attendance. Please enable GPS and try again.");return}h(t=>({...t,loading:!0}));try{const t=await I(),r=J();let s="Unknown";try{s=(await $.get(route("getClientIp"))).data.ip}catch(u){console.warn("Could not fetch IP address:",u)}E(u=>({...u,sessionInfo:{ip:s,accuracy:t.accuracy?`${Math.round(t.accuracy)}m`:"N/A",timestamp:new Date().toLocaleString()}}));const n={lat:t.latitude,lng:t.longitude,accuracy:t.accuracy,ip:s,wifi_ssid:"Unknown",device_fingerprint:JSON.stringify(r),user_agent:navigator.userAgent,timestamp:new Date().toISOString()};if(B){h(u=>({...u,loading:!1})),X(n);return}const m=await $.post(route("attendance.punch"),n);m.data.status==="success"?(U(u=>({...u,sessionDialogOpen:!0})),setTimeout(()=>{y()},500)):f.error(m.data.message)}catch(t){console.error("Punch operation failed:",t);const r=t.response?.data?.message||"Unable to record attendance. Please try again.";f.error(r,{style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-danger)",color:"var(--theme-danger-foreground)"}})}finally{h(t=>({...t,loading:!1}))}},[a.userOnLeave,l.status,I,J,y,B,X]),fe=o.useCallback(()=>{k.clickable&&(l.status===c.DENIED?K():l.status===c.INACTIVE&&_())},[k.clickable,l.status,K,_]),Z=o.useCallback(t=>{if(!t)return"--:--";try{let r;if(typeof t=="string"&&t.includes(":")&&!t.includes("T")){const s=new Date,[n,m,u]=t.split(":");r=new Date(s.getFullYear(),s.getMonth(),s.getDate(),parseInt(n),parseInt(m),parseInt(u||0))}else r=new Date(t);return isNaN(r.getTime())?"--:--":r.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"})}catch{return"--:--"}},[]),Q=o.useCallback(t=>{if(!t)return"Location not available";try{if(typeof t=="object"&&t.lat&&t.lng)return t.address?.trim()?t.address.substring(0,30):`${t.lat.toFixed(4)}, ${t.lng.toFixed(4)}`;if(typeof t=="string")try{const r=JSON.parse(t);if(r.lat&&r.lng)return r.address?.trim()?r.address.substring(0,30):`${r.lat.toFixed(4)}, ${r.lng.toFixed(4)}`}catch{return t.substring(0,30)}return"Location not available"}catch{return"Location not available"}},[]);return o.useEffect(()=>{const t=setInterval(()=>{E(r=>({...r,currentTime:new Date})),a.currentStatus==="punched_in"&&a.todayPunches.length>0&&q()},1e3);return()=>clearInterval(t)},[a.currentStatus,a.todayPunches.length,q]),o.useEffect(()=>{y(),_();const t=()=>{E(n=>({...n,connectionStatus:{...n.connectionStatus,network:!0}})),y()},r=()=>{E(n=>({...n,connectionStatus:{...n.connectionStatus,network:!1}}))},s=()=>{y(),_()};return window.addEventListener("online",t),window.addEventListener("offline",r),window.addEventListener("focus",s),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",r),window.removeEventListener("focus",s)}},[y,_]),o.useEffect(()=>{const t=setInterval(()=>{y()},3e4);return()=>clearInterval(t)},[y]),e.jsxs("div",{className:"flex flex-col w-full h-full p-4",children:[e.jsx(we.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex flex-col h-full",children:e.jsx(b,{className:"flex flex-col h-full backdrop-blur-md",style:{background:`linear-gradient(to bottom right, 
                            var(--theme-content1, #FAFAFA) 20%, 
                            var(--theme-content2, #F4F4F5) 10%, 
                            var(--theme-content3, #F1F3F4) 20%)`,borderColor:"var(--theme-divider, #E4E4E7)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 8px)",fontFamily:"var(--fontFamily, 'Inter')",opacity:a.loading?"var(--disabledOpacity, 0.5)":"1"},children:e.jsxs(Ne,{className:"flex flex-col flex-1 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx(Pe,{content:"",color:v.color,placement:"bottom-right",shape:"circle",className:"border-2 border-white",children:e.jsx(Ie,{src:x?.profile_image_url||x?.profile_image,name:x?.name,className:"w-12 h-12"})}),e.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-sm truncate notranslate",style:{color:"var(--theme-foreground)"},"data-name":"true",children:x?.name}),e.jsxs("p",{className:"text-xs notranslate",style:{color:"var(--theme-foreground-600)"},"data-no-translate":"true",children:["ID: ",x?.employee_id||x?.id]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-light leading-none",style:{background:"linear-gradient(135deg, var(--theme-primary), var(--theme-secondary))",backgroundClip:"text",WebkitBackgroundClip:"text",color:"transparent"},children:C.currentTime.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}),e.jsx("div",{className:"text-xs",style:{color:"var(--theme-foreground-600)"},children:C.currentTime.toLocaleDateString("en-US",{weekday:"short",day:"numeric"})})]})]}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(D,{color:v.color,variant:"flat",startContent:v.icon,className:"px-4 py-2 font-semibold text-sm",style:{background:"color-mix(in srgb, var(--theme-primary) 10%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 20%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 8px)",fontFamily:"var(--fontFamily, 'Inter')"},children:v.text})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs(b,{className:"p-3 text-center",style:{background:"color-mix(in srgb, var(--theme-primary) 10%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 20%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 8px)",fontFamily:"var(--fontFamily, 'Inter')"},children:[e.jsx(A,{className:"w-5 h-5 mx-auto mb-1",style:{color:"var(--theme-primary)"}}),e.jsx("div",{className:"text-sm font-bold font-mono tracking-wide",style:{color:"var(--theme-primary)"},children:a.realtimeWorkTime}),e.jsx("div",{className:"text-xs",style:{color:"var(--theme-foreground-600)"},children:"Hours Today"})]}),e.jsxs(b,{className:"p-3 text-center",style:{background:"color-mix(in srgb, var(--theme-secondary) 10%, transparent)",borderColor:"color-mix(in srgb, var(--theme-secondary) 20%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 8px)",fontFamily:"var(--fontFamily, 'Inter')"},children:[e.jsx(Se,{className:"w-5 h-5 mx-auto mb-1",style:{color:"var(--theme-secondary)"}}),e.jsx("div",{className:"text-sm font-bold",style:{color:"var(--theme-secondary)"},children:Y.sessionsToday}),e.jsx("div",{className:"text-xs",style:{color:"var(--theme-foreground-600)"},children:"Sessions"})]})]}),e.jsx(F,{color:v.color,variant:"shadow",size:"lg",fullWidth:!0,onPress:pe,isDisabled:a.loading||a.userOnLeave||l.status!==c.ACTIVE,isLoading:a.loading,startContent:!a.loading&&v.icon,className:"mb-4 font-semibold",style:{background:a.userOnLeave||l.status!==c.ACTIVE?"var(--theme-default, #71717A)":v.color==="primary"?"linear-gradient(135deg, var(--theme-primary, #006FEE), var(--theme-primary-600, #005BC4))":v.color==="success"?"linear-gradient(135deg, var(--theme-success, #17C964), var(--theme-success-600, #12A150))":v.color==="warning"?"linear-gradient(135deg, var(--theme-warning, #F5A524), var(--theme-warning-600, #C4841D))":"linear-gradient(135deg, var(--theme-primary, #006FEE), var(--theme-primary-600, #005BC4))",color:"white",borderRadius:"var(--borderRadius, 8px)",borderWidth:"var(--borderWidth, 2px)",fontFamily:"var(--fontFamily, 'Inter')",opacity:a.loading||a.userOnLeave||l.status!==c.ACTIVE?"var(--disabledOpacity, 0.5)":"1"},children:a.loading?"Processing...":v.action}),e.jsxs("div",{className:"flex justify-center gap-2 mb-4",children:[e.jsx(H,{content:k.tooltip,children:e.jsx(D,{size:"sm",variant:k.variant,color:k.color,startContent:l.status===c.CHECKING?e.jsx(je,{size:"sm",className:"w-3 h-3"}):e.jsx(M,{className:"w-3 h-3"}),className:`text-xs transition-all ${k.clickable?"cursor-pointer hover:scale-105":""}`,style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:"var(--fontFamily, 'Inter')"},onClick:k.clickable?fe:void 0,children:k.text})}),e.jsx(H,{content:`Network: ${C.connectionStatus.network?"Online":"Offline"}`,children:e.jsx(D,{size:"sm",variant:"flat",color:C.connectionStatus.network?"success":"default",startContent:e.jsx(ke,{className:"w-3 h-3"}),className:"text-xs",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:"var(--fontFamily, 'Inter')"},children:"Net"})}),e.jsx(H,{content:"Device Security",children:e.jsx(D,{size:"sm",variant:"flat",color:"success",startContent:e.jsx(Te,{className:"w-3 h-3"}),className:"text-xs",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:"var(--fontFamily, 'Inter')"},children:"Secure"})})]}),l.error&&l.status!==c.ACTIVE&&e.jsx(b,{className:"p-3 mb-4",style:{background:"color-mix(in srgb, var(--theme-danger) 10%, transparent)",borderColor:"color-mix(in srgb, var(--theme-danger) 20%, transparent)",borderWidth:"var(--borderWidth, 1px)",borderRadius:"var(--borderRadius, 8px)",fontFamily:"var(--fontFamily, 'Inter')"},children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(z,{className:"w-4 h-4 mt-0.5 flex-shrink-0",style:{color:"var(--theme-danger)"}}),e.jsx("div",{className:"text-xs",style:{color:"var(--theme-danger-foreground)"},children:l.error})]})}),a.userOnLeave&&e.jsx(b,{className:"p-3 mb-4",style:{background:"color-mix(in srgb, var(--theme-warning) 15%, transparent)",borderColor:"color-mix(in srgb, var(--theme-warning) 30%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 8px)",fontFamily:"var(--fontFamily, 'Inter')"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5",style:{color:"var(--theme-warning)"}}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-sm",style:{color:"var(--theme-warning-foreground)"},children:["On ",a.userOnLeave.leave_type," Leave"]}),e.jsxs("div",{className:"text-xs",style:{color:"var(--theme-warning-foreground-600)"},children:[new Date(a.userOnLeave.from_date).toLocaleDateString()," - ",new Date(a.userOnLeave.to_date).toLocaleDateString()]})]})]})}),e.jsx("div",{className:"border-t border-divider",children:e.jsx(De,{children:e.jsx(Ee,{"aria-label":"Today's Activity",startContent:e.jsx(Re,{className:"w-5 h-5",style:{color:"var(--theme-primary)"}}),title:e.jsx("span",{className:"font-semibold text-sm",style:{color:"var(--theme-foreground)"},children:"Today's Activity"}),subtitle:e.jsxs("span",{className:"text-xs",style:{color:"var(--theme-foreground-600)"},children:[Y.sessionsToday," sessions ‚Ä¢ ",a.realtimeWorkTime]}),children:e.jsx("div",{className:"space-y-2",children:a.todayPunches.length>0?a.todayPunches.map((t,r)=>e.jsx(b,{className:"p-3",style:{background:"color-mix(in srgb, var(--theme-primary) 10%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 20%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 8px)",fontFamily:"var(--fontFamily, 'Inter')"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-success",style:{backgroundColor:"var(--theme-success)"}}),e.jsx("span",{className:"text-xs font-semibold",style:{color:"var(--theme-success)"},children:"Check In"})]}),e.jsxs("div",{className:"pl-4 space-y-1",children:[e.jsx("div",{className:"text-sm font-mono font-medium",style:{color:"var(--theme-foreground)"},children:Z(t.punchin_time)}),e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx(M,{className:"w-3 h-3 mt-0.5 flex-shrink-0",style:{color:"var(--theme-foreground-500)"}}),e.jsx("span",{className:"text-xs leading-tight",style:{color:"var(--theme-foreground-600)"},children:Q(t.punchin_location)})]})]})]}),t.punchout_time?e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:"var(--theme-primary)"}}),e.jsx("span",{className:"text-xs font-semibold",style:{color:"var(--theme-primary)"},children:"Check Out"})]}),e.jsxs("div",{className:"pl-4 space-y-1",children:[e.jsx("div",{className:"text-sm font-mono font-medium",style:{color:"var(--theme-foreground)"},children:Z(t.punchout_time)}),e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx(M,{className:"w-3 h-3 mt-0.5 flex-shrink-0",style:{color:"var(--theme-foreground-500)"}}),e.jsx("span",{className:"text-xs leading-tight",style:{color:"var(--theme-foreground-600)"},children:Q(t.punchout_location)})]})]})]}):e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full border-2",style:{borderColor:"var(--theme-warning)"}}),e.jsx("span",{className:"text-xs font-semibold",style:{color:"var(--theme-warning)"},children:"Active Session"})]}),e.jsxs("div",{className:"pl-4 space-y-1",children:[e.jsx("div",{className:"text-sm font-mono font-medium",style:{color:"var(--theme-warning)"},children:"--:--"}),e.jsxs("div",{className:"flex items-start gap-1",children:[e.jsx(A,{className:"w-3 h-3 mt-0.5 flex-shrink-0",style:{color:"var(--theme-warning)"}}),e.jsx("span",{className:"text-xs leading-tight",style:{color:"var(--theme-warning-600)"},children:"In progress"})]})]})]})]})}),t.duration&&e.jsx(D,{size:"sm",color:"primary",variant:"flat",className:"text-xs",children:t.duration})]})},r)):e.jsxs(b,{className:"p-4 text-center",style:{background:"color-mix(in srgb, var(--theme-primary) 10%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 20%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 8px)",fontFamily:"var(--fontFamily, 'Inter')"},children:[e.jsx(re,{className:"w-8 h-8 mx-auto mb-2",style:{color:"var(--theme-primary)"}}),e.jsx("div",{className:"text-sm",style:{color:"var(--theme-foreground-600)"},children:"No activity recorded today"})]})})},"activity")})})]})})}),e.jsx(se,{isOpen:ce.sessionDialogOpen,onOpenChange:t=>U(r=>({...r,sessionDialogOpen:t})),size:"sm",backdrop:"blur",classNames:{backdrop:"backdrop-blur-md",base:"border border-default-200",header:"border-b-[1px] border-divider",footer:"border-t-[1px] border-divider"},style:{background:"color-mix(in srgb, var(--theme-primary) 10%, transparent)",borderColor:"color-mix(in srgb, var(--theme-primary) 20%, transparent)",borderWidth:"var(--borderWidth, 2px)",borderRadius:"var(--borderRadius, 8px)",fontFamily:"var(--fontFamily, 'Inter')"},children:e.jsx(oe,{children:t=>e.jsxs(e.Fragment,{children:[e.jsxs(ne,{className:"flex flex-col gap-1 text-center",children:[e.jsx(ae,{className:"w-8 h-8 mx-auto mb-2",style:{color:"var(--theme-success)"}}),e.jsx("h3",{className:"font-bold text-lg",children:"Attendance Recorded"}),e.jsx("p",{className:"text-sm font-normal opacity-70",children:"Your attendance has been successfully captured"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(b,{className:"p-3 text-center",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:"var(--fontFamily, 'Inter')"},children:[e.jsx(_e,{className:"w-6 h-6 mx-auto mb-2",style:{color:"var(--theme-primary)"}}),e.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--theme-primary)"},children:C.sessionInfo.ip}),e.jsx("div",{className:"text-xs",style:{color:"var(--theme-foreground-600)"},children:"IP Address"})]}),e.jsxs(b,{className:"p-3 text-center",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:"var(--fontFamily, 'Inter')"},children:[e.jsx(M,{className:"w-6 h-6 mx-auto mb-2",style:{color:"var(--theme-success)"}}),e.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--theme-success)"},children:C.sessionInfo.accuracy}),e.jsx("div",{className:"text-xs",style:{color:"var(--theme-foreground-600)"},children:"GPS Accuracy"})]})]}),e.jsx(b,{className:"p-3 mt-4",style:{background:"color-mix(in srgb, var(--theme-success) 10%, transparent)",borderRadius:"var(--borderRadius, 8px)",fontFamily:"var(--fontFamily, 'Inter')"},children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs",children:[e.jsx(A,{className:"w-4 h-4"}),e.jsxs("span",{children:["Recorded at: ",C.sessionInfo.timestamp]})]})})]}),e.jsx(le,{children:e.jsx(F,{color:"primary",variant:"shadow",fullWidth:!0,onPress:t,className:"font-semibold",style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:"var(--fontFamily, 'Inter')"},children:"Continue"})})]})})}),e.jsx(se,{isOpen:i.isOpen,onClose:O,size:"lg",classNames:{backdrop:"bg-black/80",base:"bg-content1"},style:{borderRadius:"var(--borderRadius, 12px)",fontFamily:"var(--fontFamily, 'Inter')"},children:e.jsxs(oe,{children:[e.jsxs(ne,{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5 text-primary"}),e.jsx("span",{children:"Capture Attendance Photo"})]}),e.jsx("p",{className:"text-sm text-default-500 font-normal",children:"Take a photo for verification. Location coordinates will be added automatically."})]}),e.jsxs(ie,{className:"p-4",children:[e.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-black",children:[i.capturedPhoto?e.jsx("img",{src:i.capturedPhoto,alt:"Captured",className:"w-full h-auto max-h-[400px] object-contain"}):e.jsxs(e.Fragment,{children:[e.jsx("video",{ref:N,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-auto max-h-[400px] object-contain",style:{transform:i.facingMode==="user"?"scaleX(-1)":"none"}}),e.jsx(F,{isIconOnly:!0,size:"sm",variant:"flat",className:"absolute top-3 right-3 bg-black/50 text-white hover:bg-black/70",onPress:de,isLoading:i.isSwitching,isDisabled:!i.stream||i.isSwitching,style:{borderRadius:"50%"},children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx("div",{className:"absolute top-3 left-3 px-2 py-1 rounded-full text-xs text-white bg-black/50",children:i.facingMode==="user"?"ü§≥ Front":"üì∑ Back"})]}),e.jsx("canvas",{ref:G,className:"hidden"}),l.coordinates&&e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-2 text-white text-xs",style:{background:"rgba(0,0,0,0.7)"},children:["üìç ",l.coordinates.latitude.toFixed(6),", ",l.coordinates.longitude.toFixed(6)]})]}),e.jsx("div",{className:"mt-3 p-3 rounded-lg text-sm",style:{background:"color-mix(in srgb, var(--theme-primary) 10%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4 text-primary"}),i.capturedPhoto?"Review your photo. You can retake if needed.":"Position yourself clearly in the frame and capture the photo."]})})]}),e.jsxs(le,{className:"flex gap-2",children:[e.jsx(F,{color:"danger",variant:"light",onPress:O,style:{fontFamily:"var(--fontFamily, 'Inter')"},children:"Cancel"}),i.capturedPhoto?e.jsxs(e.Fragment,{children:[e.jsx(F,{color:"secondary",variant:"flat",onPress:ue,startContent:e.jsx(ee,{className:"w-4 h-4"}),style:{fontFamily:"var(--fontFamily, 'Inter')"},children:"Retake"}),e.jsxs(F,{color:"success",variant:"shadow",onPress:he,isLoading:a.loading,startContent:!a.loading&&e.jsx(ae,{className:"w-4 h-4"}),style:{fontFamily:"var(--fontFamily, 'Inter')"},children:["Confirm & ",v.action]})]}):e.jsx(F,{color:"primary",variant:"shadow",onPress:me,isLoading:i.isCapturing,isDisabled:!i.stream,startContent:!i.isCapturing&&e.jsx(te,{className:"w-4 h-4"}),style:{fontFamily:"var(--fontFamily, 'Inter')"},children:"Capture Photo"})]})]})})]})});We.displayName="PunchStatusCard";export{We as default};
