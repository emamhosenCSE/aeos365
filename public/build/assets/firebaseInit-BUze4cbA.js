import{_ as f,n as l}from"./app-B1idACz3.js";import"./app-BmhO9GrS.js";let s=!1;const m=async()=>{if(!s)try{const{onMessageListener:t,requestNotificationPermission:a}=await f(async()=>{const{onMessageListener:e,requestNotificationPermission:o}=await import("./firebase-config--JNkgBdL.js");return{onMessageListener:e,requestNotificationPermission:o}},[]),i=await a();if(i){localStorage.setItem("fcm_token",i);try{const e=await l.post(route("updateFcmToken"),{fcm_token:i});e.status===200&&console.log("FCM Token Updated:",e.data.fcm_token)}catch(e){console.error("Failed to update FCM token:",e)}}else console.warn("Notification permission denied or no token retrieved.");const n=t().then(e=>{console.log("Message received:",e);const{title:o,body:r,icon:c}=e.notification;Notification.permission==="granted"&&new Notification(o,{body:r,icon:c}),alert(`${o}: ${r}`)}).catch(e=>console.error("onMessageListener error:",e));return s=!0,()=>{n&&typeof n=="function"&&n()}}catch(t){console.error("Firebase initialization error:",t)}};export{m as initFirebase};
