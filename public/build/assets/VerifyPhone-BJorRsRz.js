import{r as i,n as Y,f as C,j as e,H as q,b as h,F as H,a as $}from"./app-Dl9IyCSr.js";import{A as K}from"./AuthCard-BnZV9etI.js";import{R as M}from"./RegisterLayout-W26iSC8K.js";import{u as z}from"./useBranding-BCNrtX7h.js";import{s as m}from"./toastUtils-CLIL57nf.js";import{P as W}from"./ProgressSteps-BwcKwfyi.js";import G from"./CancelRegistrationButton-sVHAi0Jt.js";import{F as J}from"./DevicePhoneMobileIcon-CbRNMx85.js";import{u as Q}from"./index-Xidjn7UE.js";import{m as U,a as X,b as Z,c as ee}from"./chunk-TW2E3XVA-DtgLl7Jw.js";import{m as se}from"./chunk-5LXTSPS7-DlGepOai.js";import"./app-Bq-q9uAS.js";import"./index-CTFU2EL9.js";/* empty css                      */import"./MaintenanceModeBanner-DherX2Hq.js";import"./chunk-AUA5GDXN-Cad1HwkM.js";import"./index-Tq9ucszV.js";import"./index-CUhURnVS.js";import"./chunk-WQVQ7P2I-BiptAxDY.js";import"./number-CB4zbwAz.js";import"./chunk-LGMZDQT5-BjFVj_G8.js";import"./ArrowLeftIcon-CUEJy8gC.js";import"./index-BszNIda9.js";import"./useDialog-DuOQxqXI.js";import"./VisuallyHidden-Cr3of3YJ.js";import"./keyboard-BDXbbW6H.js";import"./useLabels-BHV0yBRh.js";function Ve({steps:D=[],currentStep:R,savedData:te={},phone:V="",companyName:re=""}){const[c,y]=i.useState(["","","","","",""]),[p,N]=i.useState(!1),[g,w]=i.useState(!1),[n,k]=i.useState(0),f=i.useRef([]),P=i.useRef(!1),{isOpen:_,onOpen:E,onClose:j}=Q(),{themeSettings:I}=Y(),u=I?.mode==="dark",{siteName:T}=z(),o={heading:u?"text-white":"text-slate-900",copy:u?"text-slate-300":"text-slate-600",badge:u?"text-slate-300":"text-slate-500",link:u?"text-primary-400 hover:text-primary-300":"text-primary-600 hover:text-primary-700"};i.useEffect(()=>{P.current||(P.current=!0,v())},[]),i.useEffect(()=>{if(n>0){const s=setTimeout(()=>k(n-1),1e3);return()=>clearTimeout(s)}},[n]);const v=async()=>{if(!(n>0)){w(!0);try{const s=await C.post(route("platform.register.verify-phone.send"));m.success(s.data.message||"Verification code sent to your phone"),k(60)}catch(s){console.error("Failed to send code:",s);let r="Failed to send verification code";if(s.response){const t=s.response.status,a=s.response.data;t===429?r=a.message||"Too many attempts. Please wait before trying again.":t===500?r=a.message||"Server error occurred. Please try again later.":t===422?r=a.message||"Validation error. Please check your information.":r=a.message||r}else s.request&&(r="No response from server. Please check your connection.");m.error(r)}finally{w(!1)}}},F=(s,r)=>{if(r&&!/^\d$/.test(r))return;const t=[...c];t[s]=r,y(t),r&&s<5&&f.current[s+1]?.focus(),t.every(a=>a!=="")&&s===5&&b(t.join(""))},O=(s,r)=>{r.key==="Backspace"&&!c[s]&&s>0&&f.current[s-1]?.focus()},A=s=>{s.preventDefault();const t=s.clipboardData.getData("text").slice(0,6).split("").filter(a=>/^\d$/.test(a));if(t.length>0){const a=[...c];t.forEach((x,S)=>{S<6&&(a[S]=x)}),y(a);const l=a.findIndex(x=>x===""),d=l===-1?5:l;f.current[d]?.focus(),a.every(x=>x!=="")&&b(a.join(""))}},b=async s=>{const r=s||c.join("");if(r.length!==6){m.error("Please enter the complete 6-digit code");return}N(!0);try{const t=await C.post(route("platform.register.verify-phone.verify"),{code:r});m.success(t.data.message||"Phone verified successfully"),setTimeout(()=>{$.visit(route("platform.register.plan"))},500)}catch(t){console.error("Verification failed:",t);let a="Invalid verification code";if(t.response){const l=t.response.status,d=t.response.data;l===429?a=d.message||"Too many attempts. Please wait before trying again.":l===422?a=d.message||"Invalid or expired verification code":l===500?a=d.message||"Server error occurred. Please try again.":a=d.message||a}else t.request&&(a="No response from server. Please check your connection.");m.error(a),y(["","","","","",""]),f.current[0]?.focus()}finally{N(!1)}},B=()=>{E()},L=()=>{j(),m.info("Phone verification skipped. You can verify later from settings."),$.visit(route("platform.register.plan"))};return e.jsxs(M,{children:[e.jsx(q,{title:`Verify Company Phone - ${T}`}),e.jsxs("section",{className:"max-w-5xl mx-auto px-4 sm:px-6 py-6 sm:py-12 space-y-6 sm:space-y-8",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4 text-center",children:[e.jsx("p",{className:`text-[10px] sm:text-sm uppercase tracking-[0.3em] ${o.badge}`,children:"Step 5"}),e.jsx("h1",{className:`text-2xl sm:text-4xl font-semibold ${o.heading} px-2`,children:"Verify Company Phone"}),e.jsxs("p",{className:`${o.copy} text-sm sm:text-base px-2`,children:["We've sent a 6-digit verification code to your company phone ",e.jsx("strong",{className:o.heading,children:V})]}),e.jsx("p",{className:`${o.copy} text-xs sm:text-sm px-2 italic`,children:"Note: You'll create your admin account after completing registration"})]}),e.jsx(W,{steps:D,currentStep:R}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 rounded-2xl border-2 border-primary/30 -m-3 pointer-events-none animate-pulse-subtle",children:e.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 w-0.5 h-16 bg-gradient-to-b from-primary/60 to-transparent"})}),e.jsx(K,{children:e.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(J,{className:"w-8 h-8 text-primary"})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-center",children:e.jsx("p",{className:`text-sm ${o.copy} mb-4`,children:"Enter the verification code"})}),e.jsx("div",{className:"flex justify-center gap-2 sm:gap-3",onPaste:A,children:c.map((s,r)=>e.jsx("input",{ref:t=>f.current[r]=t,type:"text",inputMode:"numeric",maxLength:1,value:s,onChange:t=>F(r,t.target.value),onKeyDown:t=>O(r,t),className:`w-10 h-12 sm:w-12 sm:h-14 text-center text-xl sm:text-2xl font-semibold border-2 rounded-lg transition-all
                      ${s?"border-primary bg-primary/5":"border-default-300"}
                      ${u?"bg-default-100 text-white":"bg-white text-slate-900"}
                      focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary`,disabled:p},r))}),e.jsx("div",{className:"text-center",children:n>0?e.jsxs("p",{className:`text-sm ${o.copy}`,children:["Resend code in ",e.jsxs("strong",{children:[n,"s"]})]}):e.jsx("button",{type:"button",onClick:v,disabled:g,className:`text-sm ${o.link} font-medium disabled:opacity-50`,children:g?"Sending...":"Resend verification code"})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(h,{color:"default",variant:"bordered",onPress:B,className:"w-full sm:w-auto",isDisabled:p,children:"Skip for now"}),e.jsx(h,{color:"primary",onPress:()=>b(),className:"w-full",isLoading:p,isDisabled:c.some(s=>s==="")||p,children:p?"Verifying...":"Verify Company Phone"})]}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsxs("p",{className:`text-xs ${o.copy}`,children:["Didn't receive the code?"," ",e.jsx("button",{onClick:v,disabled:n>0||g,className:o.link,children:"Resend it"})]}),e.jsx("div",{className:"pt-2 border-t border-divider",children:e.jsx(G,{variant:"light",size:"sm"})})]})]})})]})]}),e.jsx(U,{isOpen:_,onOpenChange:j,classNames:{base:"bg-content1",header:"border-b border-divider",body:"py-6",footer:"border-t border-divider"},children:e.jsxs(X,{children:[e.jsxs(Z,{className:"flex gap-2 items-center",children:[e.jsx(H,{className:"w-5 h-5 text-warning"}),e.jsx("span",{children:"Skip Phone Verification?"})]}),e.jsx(ee,{children:e.jsx("p",{className:o.copy,children:"Are you sure you want to skip phone verification? You will need to verify your phone number later from your account settings."})}),e.jsxs(se,{children:[e.jsx(h,{variant:"flat",onPress:j,children:"Cancel"}),e.jsx(h,{color:"warning",onPress:L,children:"Skip Verification"})]})]})})]})}export{Ve as default};
