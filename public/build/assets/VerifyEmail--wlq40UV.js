import{r as i,n as q,f as $,j as e,H as B,b as L,a as M}from"./app-BkgCtHXO.js";import{A as H}from"./AuthCard-Cm0S0G04.js";import{R as K}from"./RegisterLayout-BV7Zgjkr.js";import{u as _}from"./useBranding-BXHsi77Q.js";import{s as x}from"./toastUtils-x3kUGVfR.js";import{P as z}from"./ProgressSteps-DLxfHkif.js";import W from"./CancelRegistrationButton-BXMa10um.js";import{F as Y}from"./EnvelopeIcon-C0cG5D_W.js";import"./app-Bq-q9uAS.js";import"./index-B7m8hOZr.js";/* empty css                      */import"./MaintenanceModeBanner-BPpiQYbG.js";import"./chunk-AUA5GDXN-DY9zYzzB.js";import"./index-Clir5_RS.js";import"./index-n2HRE6J3.js";import"./chunk-WQVQ7P2I-D-7sv4Ho.js";import"./number-CB4zbwAz.js";import"./chunk-LGMZDQT5-vmPOWwVV.js";import"./ArrowLeftIcon-rtMO2lqZ.js";import"./index-CPxwW2OQ.js";import"./index-DGbB7juJ.js";import"./chunk-TW2E3XVA-BTmTvWaA.js";import"./useDialog-Dego46hN.js";import"./VisuallyHidden-CA8GF3km.js";import"./keyboard-C-f1CHRW.js";import"./useLabels-4bh2Qhvc.js";import"./chunk-5LXTSPS7-_fk4lnb6.js";function Ne({steps:E=[],currentStep:P,savedData:G={},email:D="",companyName:J=""}){const[c,h]=i.useState(["","","","","",""]),[y,v]=i.useState(!1),[g,N]=i.useState(!1),[n,w]=i.useState(0),[l,C]=i.useState(600),p=i.useRef([]),S=i.useRef(!1),{themeSettings:R}=q(),f=R?.mode==="dark",{siteName:V}=_(),o={heading:f?"text-white":"text-slate-900",copy:f?"text-slate-300":"text-slate-600",badge:f?"text-slate-300":"text-slate-500",link:f?"text-primary-400 hover:text-primary-300":"text-primary-600 hover:text-primary-700"};i.useEffect(()=>{S.current||(S.current=!0,j())},[]),i.useEffect(()=>{if(n>0){const t=setTimeout(()=>w(n-1),1e3);return()=>clearTimeout(t)}},[n]),i.useEffect(()=>{if(l>0){const t=setTimeout(()=>C(l-1),1e3);return()=>clearTimeout(t)}},[l]);const T=t=>{const r=Math.floor(t/60),s=t%60;return`${r}:${s.toString().padStart(2,"0")}`},j=async()=>{if(!(n>0)){N(!0);try{const t=await $.post(route("platform.register.verify-email.send"));x.success(t.data.message||"Verification code sent to your email"),w(60),C(600)}catch(t){console.error("Failed to send code:",t);let r="Failed to send verification code";if(t.response){const s=t.response.status,a=t.response.data;s===429?r=a.message||"Too many attempts. Please wait before trying again.":s===500?r=a.message||"Server error occurred. Please try again later.":s===422?r=a.message||"Validation error. Please check your information.":r=a.message||r}else t.request&&(r="No response from server. Please check your connection.");x.error(r)}finally{N(!1)}}},I=(t,r)=>{if(r&&!/^\d$/.test(r))return;const s=[...c];s[t]=r,h(s),r&&t<5&&p.current[t+1]?.focus(),s.every(a=>a!=="")&&t===5&&b(s.join(""))},A=(t,r)=>{r.key==="Backspace"&&!c[t]&&t>0&&p.current[t-1]?.focus()},F=t=>{t.preventDefault();const s=t.clipboardData.getData("text").slice(0,6).split("").filter(a=>/^\d$/.test(a));if(s.length>0){const a=[...c];s.forEach((u,k)=>{k<6&&(a[k]=u)}),h(a);const m=a.findIndex(u=>u===""),d=m===-1?5:m;p.current[d]?.focus(),a.every(u=>u!=="")&&b(a.join(""))}},b=async t=>{const r=t||c.join("");if(r.length!==6){x.error("Please enter the complete 6-digit code");return}v(!0);try{const s=await $.post(route("platform.register.verify-email.verify"),{code:r});x.success(s.data.message||"Email verified successfully"),setTimeout(()=>{M.visit(route("platform.register.verify-phone"))},500)}catch(s){console.error("Verification failed:",s);let a="Invalid verification code";if(s.response){const m=s.response.status,d=s.response.data;m===429?a=d.message||"Too many attempts. Please wait before trying again.":m===422?a=d.message||"Invalid or expired verification code":m===500?a=d.message||"Server error occurred. Please try again.":a=d.message||a}else s.request&&(a="No response from server. Please check your connection.");x.error(a),h(["","","","","",""]),p.current[0]?.focus()}finally{v(!1)}};return e.jsxs(K,{children:[e.jsx(B,{title:`Verify Company Email - ${V}`}),e.jsxs("section",{className:"max-w-5xl mx-auto px-4 sm:px-6 py-6 sm:py-12 space-y-6 sm:space-y-8",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4 text-center",children:[e.jsx("p",{className:`text-[10px] sm:text-sm uppercase tracking-[0.3em] ${o.badge}`,children:"Step 4"}),e.jsx("h1",{className:`text-2xl sm:text-4xl font-semibold ${o.heading} px-2`,children:"Verify Company Email"}),e.jsxs("p",{className:`${o.copy} text-sm sm:text-base px-2`,children:["We've sent a 6-digit verification code to your company email ",e.jsx("strong",{className:o.heading,children:D})]}),e.jsx("p",{className:`${o.copy} text-xs sm:text-sm px-2 italic`,children:"Note: You'll create your admin account after completing registration"})]}),e.jsx(z,{steps:E,currentStep:P}),e.jsx(H,{children:e.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(Y,{className:"w-8 h-8 text-primary"})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-center",children:e.jsx("p",{className:`text-sm ${o.copy} mb-4`,children:"Enter the verification code"})}),e.jsx("div",{className:"flex justify-center gap-2 sm:gap-3",onPaste:F,children:c.map((t,r)=>e.jsx("input",{ref:s=>p.current[r]=s,type:"text",inputMode:"numeric",maxLength:1,value:t,onChange:s=>I(r,s.target.value),onKeyDown:s=>A(r,s),className:`w-10 h-12 sm:w-12 sm:h-14 text-center text-xl sm:text-2xl font-semibold border-2 rounded-lg transition-all
                      ${t?"border-primary bg-primary/5":"border-default-300"}
                      ${f?"bg-default-100 text-white":"bg-white text-slate-900"}
                      focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary`,disabled:y},r))}),e.jsxs("div",{className:"text-center space-y-2",children:[l>0?e.jsxs("p",{className:`text-xs ${l<60?"text-warning":o.copy}`,children:["Code expires in ",e.jsx("strong",{children:T(l)})]}):e.jsx("p",{className:"text-xs text-danger",children:"Code has expired. Please request a new one."}),n>0?e.jsxs("p",{className:`text-sm ${o.copy}`,children:["Resend code in ",e.jsxs("strong",{children:[n,"s"]})]}):e.jsx("button",{type:"button",onClick:j,disabled:g,className:`text-sm ${o.link} font-medium disabled:opacity-50`,children:g?"Sending...":"Resend verification code"})]})]}),e.jsx(L,{color:"primary",onPress:()=>b(),className:"w-full",isLoading:y,isDisabled:c.some(t=>t==="")||y,children:y?"Verifying...":"Verify Company Email"}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsxs("p",{className:`text-xs ${o.copy}`,children:["Didn't receive the code? Check your spam folder or"," ",e.jsx("button",{onClick:j,disabled:n>0||g,className:o.link,children:"resend it"})]}),e.jsxs("p",{className:`text-xs ${o.copy} bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg border border-blue-200 dark:border-blue-800`,children:["ðŸ’¡ ",e.jsx("strong",{children:"Next Step:"})," After verification, you'll create your admin account on your workspace subdomain"]}),e.jsx("div",{className:"pt-2 border-t border-divider",children:e.jsx(W,{variant:"light",size:"sm"})})]})]})})]})]})}export{Ne as default};
