import{u as te,r as n,j as e,s as ae,b as I,d as J,g as re,e as k,F as ge,H as xe,m as ve,c as ye}from"./app-BAXRlJ48.js";import{P as be}from"./PageHeader-B0Gb2JdX.js";import{S as je}from"./StatsCards-3BXVjewD.js";import{a0 as H,M as Q,v as M,u as _e,F as we,A as Ne}from"./App-DPyYvU15.js";import{N as Fe}from"./NoDataMessage-qtBjGr5W.js";import{F as se}from"./CheckCircleIcon-DpGmT_VL.js";import{t as De,a as Se,b as Ce,c as Pe}from"./chunk-F3UDT23P-CbS6cZJx.js";import{t as Ie,a as Ee}from"./chunk-YRZGWF2W-am2dpIpP.js";import{p as Re}from"./chunk-NL7EUJG2-GipAg-Ht.js";import{t as X}from"./chunk-AUA5GDXN-CgSoZYyJ.js";import{d as ke,a as Ae,b as ze,m as Z,e as Me}from"./PlusIcon-ysjwppa4.js";import{s as T}from"./toastUtils-CgpXtHQI.js";import{B as ee}from"./briefcase-CJIQFrlD.js";import{B as Te}from"./building-2-BGpQpPbJ.js";import{m as ie,a as ne,b as oe,c as le}from"./chunk-TW2E3XVA-YKxZpKyZ.js";import{i as W}from"./chunk-SQIAVXJX-DHcD0NdT.js";import{s as B}from"./chunk-C3QHEOC2-CWWALGR_.js";import{l as P}from"./chunk-Y5DMIIWQ-7yisM25U.js";import{s as Be}from"./chunk-I3A4XRYQ-CkETcpjJ.js";import{m as de}from"./chunk-5LXTSPS7-D1xxNIgs.js";import{F as Le}from"./UserGroupIcon-ReqkIs1d.js";import{F as $e}from"./MagnifyingGlassIcon-CKEATm1j.js";import"./app-Bq-q9uAS.js";import"./chunk-IHO36JMK-DE6UccOS.js";import"./chunk-P7ACKWSP-D1TjPK16.js";import"./chunk-C6WKGNND-CJZl1JMF.js";import"./index-1fQ0x8g_.js";/* empty css                      */import"./routeUtils-B8YzhDEw.js";import"./chunk-CV4BWJDJ-YDxK8YmD.js";import"./index-BQxk6npT.js";import"./index-D-IZDB6p.js";import"./UserIcon-D4IwKnJn.js";import"./Cog6ToothIcon-BS9S9AuN.js";import"./GlobeAltIcon-B7g8tGA4.js";import"./useBranding-COW0C88J.js";import"./useDialog-3np8Q49m.js";import"./VisuallyHidden-CG9-RmFy.js";import"./keyboard-oTkO-R2L.js";import"./useLabels-pxb2sUWj.js";import"./index-_s1yLG4v.js";import"./XMarkIcon-CT-5AVBL.js";import"./useMediaQuery-DMFH0ee8.js";import"./ShieldCheckIcon-81Yah9s5.js";import"./AcademicCapIcon-Jeb8Wbls.js";import"./IdentificationIcon-snDdY4-U.js";import"./ArrowLeftIcon-D4-_RCwU.js";import"./ArrowRightIcon-DJMmx1E-.js";import"./BriefcaseIcon-7DLvdql-.js";import"./BuildingOfficeIcon-WjMYh5KD.js";import"./CalendarDaysIcon-CkNTucfv.js";import"./CalendarIcon-C7z-hHui.js";import"./CircleStackIcon-D6_GwVfd.js";import"./ClipboardDocumentCheckIcon-DYF8QSt6.js";import"./CogIcon-C-fAMeKY.js";import"./DeviceTabletIcon-DGpKNaqu.js";import"./CpuChipIcon-B5kjosh4.js";import"./CurrencyDollarIcon-C8KFUyn1.js";import"./DevicePhoneMobileIcon-0NBhC7WR.js";import"./DocumentArrowUpIcon-BiuaCjv0.js";import"./DocumentIcon-OchpmxNl.js";import"./EnvelopeIcon-oHQ3-eEU.js";import"./ExclamationCircleIcon-_eLwtUSB.js";import"./EyeIcon-DAw08-uS.js";import"./InformationCircleIcon-BySvtpwC.js";import"./KeyIcon-CdYfCZg4.js";import"./LockClosedIcon-B9yphYj1.js";import"./MapPinIcon-Dwf-7_N3.js";import"./PlusCircleIcon-CPCIsgiK.js";import"./PrinterIcon-B9IMeb6s.js";import"./RocketLaunchIcon-qQrkTDyk.js";import"./ShoppingCartIcon-Bdub_1jY.js";import"./UserCircleIcon-D9HcMQtS.js";import"./MaintenanceModeBanner-DwAWmFt4.js";import"./useSelectableItem-DMlJJsC7.js";import"./SelectionManager-D9Jz4Bfb.js";import"./chunk-PMMJMDBI-Cn7A2qKu.js";import"./useToggleState-I6NzsThi.js";import"./chunk-ICU6NNET-DodoMyo5.js";import"./index-83xPGo9M.js";import"./chunk-LGMZDQT5-B8Sl4UZV.js";import"./useHasTabbableChild-rX9Jpkgs.js";import"./chunk-7F3ZLNJ6-BNnneC7C.js";import"./index-CzAwltOy.js";import"./index-CokAva9Y.js";import"./chunk-OH2E76JR-BDg-4xQO.js";import"./chunk-WQVQ7P2I-D0_WLrzH.js";import"./number-CB4zbwAz.js";import"./Item-fAa8moyn.js";import"./index-B7eECtKa.js";import"./useTreeState-O2jm2C-5.js";import"./useMenuTriggerState--PujcPTI.js";import"./createLucideIcon-Cg-NULby.js";import"./chunk-KQW2TNLT-B3CXe1GN.js";import"./useLabel-B3fAPYpc.js";const Oe=({designations:u,onEdit:b,onDelete:j,onView:s,loading:v,isMobile:w,isTablet:y,pagination:c,onPageChange:N,onRowsPerPageChange:l,canEditDesignation:o=!1,canDeleteDesignation:m=!1})=>{const{auth:i}=te().props,f=o||i.permissions?.includes("designations.update")||!1,F=m||i.permissions?.includes("designations.delete")||!1,D=n.useMemo(()=>[{name:"TITLE",uid:"title"},{name:"DEPARTMENT",uid:"department_name"},{name:"HIERARCHY",uid:"hierarchy_level"},{name:"EMPLOYEES",uid:"employee_count"},{name:"STATUS",uid:"status"},{name:"ACTIONS",uid:"actions"}],[]),g=(a,r)=>{switch(r){case"title":return e.jsx("span",{className:"font-semibold text-foreground",children:a.title});case"department_name":return e.jsx("span",{className:"text-default-500",children:a.department_name||"-"});case"hierarchy_level":const S={1:"primary",2:"secondary",3:"success",4:"warning",5:"danger"},h=a.hierarchy_level||1,x=h<=5?h:"default";return e.jsxs(J,{size:"sm",variant:"flat",color:S[x]||"default",startContent:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),children:["Level ",h]});case"employee_count":return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4 text-default-400"}),e.jsx("span",{children:a.employee_count||0})]});case"status":return e.jsx(J,{size:"sm",variant:a.is_active?"solid":"bordered",color:a.is_active?"success":"danger",startContent:a.is_active?e.jsx(se,{className:"w-3 h-3"}):e.jsx(re,{className:"w-3 h-3"}),children:a.is_active?"Active":"Inactive"});case"actions":return e.jsx("div",{className:"flex justify-end items-center",children:w?e.jsxs(ke,{children:[e.jsx(Ae,{children:e.jsx(I,{isIconOnly:!0,size:"sm",variant:"light",children:e.jsx(_e,{className:"w-4 h-4"})})}),e.jsxs(ze,{"aria-label":"Designation actions",children:[f&&e.jsx(Z,{startContent:e.jsx(Q,{className:"w-4 h-4"}),onPress:()=>b(a),children:"Edit Designation"},"edit"),F&&e.jsx(Z,{className:"text-danger",color:"danger",startContent:e.jsx(M,{className:"w-4 h-4"}),isDisabled:a.employee_count>0,onPress:()=>j(a),children:"Delete Designation"},"delete")]})]}):e.jsxs(e.Fragment,{children:[f&&e.jsx(X,{content:"Edit Designation",children:e.jsx(I,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-blue-500",onPress:()=>b(a),children:e.jsx(Q,{className:"w-4 h-4"})})}),F&&e.jsx(X,{content:a.employee_count>0?"Cannot delete designation with employees":"Delete Designation",children:e.jsx(I,{isIconOnly:!0,size:"sm",variant:"light",className:"text-default-400 hover:text-danger",isDisabled:a.employee_count>0,onPress:()=>j(a),children:e.jsx(M,{className:"w-4 h-4"})})})]})});default:return e.jsx("span",{children:a[r]})}},p=()=>!u||!u.data||v?null:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between px-4 py-2 border-t border-white/10",children:[e.jsxs("span",{className:"text-xs text-default-400 mb-3 sm:mb-0",children:["Showing ",(c.currentPage-1)*c.perPage+1," to ",Math.min(c.currentPage*c.perPage,u.total)," of ",u.total," designations"]}),e.jsx(Re,{total:Math.ceil(u.total/c.perPage),initialPage:c.currentPage,page:c.currentPage,onChange:N,size:w?"sm":"md",variant:"bordered",showControls:!0,classNames:{item:"bg-white/10 backdrop-blur-md border-white/20 hover:bg-white/15",cursor:"bg-white/20 backdrop-blur-md border-white/20"}})]});return!v&&(!u||!u.data||u.data.length===0)?e.jsx("div",{className:"w-full",children:e.jsx(Fe,{message:"No designations found",icon:e.jsx(H,{className:"w-12 h-12 text-default-300"}),description:"Try adjusting your search or filters"})}):e.jsx("div",{className:"w-full",children:e.jsxs(De,{"aria-label":"Designations table",removeWrapper:!0,classNames:{base:"bg-transparent",th:"bg-white/5 backdrop-blur-md text-default-500 border-b border-white/10 font-medium text-xs",td:"border-b border-white/5 py-3"},bottomContent:p(),children:[e.jsx(Ie,{columns:D,children:a=>e.jsx(Ee,{children:a.name},a.uid)}),e.jsx(Se,{items:u.data||[],emptyContent:!v&&"No designations found",loadingContent:e.jsx(ae,{}),isLoading:v,children:a=>e.jsx(Ce,{children:r=>e.jsx(Pe,{children:g(a,r)})},a.id)})]})})},Ve=({open:u,onClose:b,onSuccess:j,designation:s=null,departments:v=[],designations:w=[]})=>{const y=()=>{if(typeof window>"u")return"lg";const a=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12px",r=parseInt(a);return r===0?"none":r<=4?"sm":r<=8?"md":r<=16?"lg":"full"},[c,N]=n.useState(!1),[l,o]=n.useState({}),m={title:"",department_id:"",hierarchy_level:1,parent_id:"",is_active:!0},[i,f]=n.useState(m);n.useEffect(()=>{f(s?{title:s.title||"",department_id:s.department_id||"",hierarchy_level:s.hierarchy_level||1,parent_id:s.parent_id||"",is_active:s.is_active??!0}:m),o({})},[s,u]);const F=w?.filter(p=>!(s?.id&&p.id===s.id||i.department_id&&p.department_id!==parseInt(i.department_id)||i.hierarchy_level&&p.hierarchy_level>=i.hierarchy_level))||[],D=(p,a)=>{f(r=>({...r,[p]:a})),l[p]&&o(r=>({...r,[p]:null})),p==="department_id"&&a!==i.department_id&&f(r=>({...r,parent_id:""})),p==="hierarchy_level"&&a===1&&f(r=>({...r,parent_id:""}))},g=async p=>{p.preventDefault(),N(!0),o({});const a=new Promise(async(r,S)=>{try{const h={...i,parent_id:i.hierarchy_level===1?null:i.parent_id||null};let x;s?.id?(x=await k.put(`/designations/${s.id}`,h),r([x.data.message||"Designation updated successfully"])):(x=await k.post("/designations",h),r([x.data.message||"Designation created successfully"])),j(x.data.designation),b()}catch(h){if(console.error("Full error object:",h),h.response)if(h.response.status===422){o(h.response.data.errors||{});const x=Object.values(h.response.data.errors||{}).flat();S(x.length>0?x.join(", "):"Validation failed")}else S(`HTTP Error ${h.response.status}: ${h.response.data.message||"An unexpected error occurred"}`);else h.request?S("No response received from the server. Please check your internet connection."):S("An error occurred while setting up the request.")}finally{N(!1)}});T.promise(a,{pending:`${s?"Updating":"Creating"} designation...`,success:{render({data:r}){return r.join(", ")}},error:{render({data:r}){return r}}})};return e.jsx(ie,{isOpen:u,onClose:c?void 0:b,size:"2xl",radius:y(),scrollBehavior:"inside",classNames:{base:"backdrop-blur-md mx-2 my-2 sm:mx-4 sm:my-8 max-h-[95vh]",backdrop:"bg-black/50 backdrop-blur-sm",header:"border-b border-divider",body:"overflow-y-auto",footer:"border-t border-divider",closeButton:"hover:bg-white/5 active:bg-white/10"},style:{border:"var(--borderWidth, 2px) solid var(--theme-divider, #E4E4E7)",borderRadius:"var(--borderRadius, 12px)",fontFamily:'var(--fontFamily, "Inter")',transform:"scale(var(--scale, 1))"},children:e.jsx(ne,{children:p=>e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"flex flex-col gap-1",style:{borderColor:"var(--theme-divider, #E4E4E7)",fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{size:20,style:{color:"var(--theme-primary)"}}),e.jsx("span",{className:"text-lg font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")'},children:s?"Edit Designation":"Create New Designation"})]})}),e.jsxs("form",{onSubmit:g,children:[e.jsx(le,{className:"py-4 px-4 sm:py-6 sm:px-6",style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[e.jsx("div",{className:"col-span-2",children:e.jsx(W,{label:"Designation Title",placeholder:"Enter designation title",value:i.title,onChange:a=>D("title",a.target.value),isInvalid:!!l.title,errorMessage:l.title?.[0],isRequired:!0,variant:"bordered",size:"sm",radius:y(),startContent:e.jsx(ee,{size:16,className:"text-default-400"}),classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx(B,{label:"Department",placeholder:"Select Department",selectedKeys:i.department_id?new Set([String(i.department_id)]):new Set,onSelectionChange:a=>{const r=Array.from(a)[0];D("department_id",r||"")},isInvalid:!!l.department_id,errorMessage:l.department_id?.[0],isRequired:!0,variant:"bordered",size:"sm",radius:y(),startContent:e.jsx(Te,{size:16,className:"text-default-400"}),classNames:{trigger:"min-h-unit-10",value:"text-small"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:v?.map(a=>e.jsx(P,{value:a.id,children:a.name},a.id))})}),e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx(W,{type:"number",label:"Hierarchy Level",placeholder:"Enter hierarchy level",value:String(i.hierarchy_level),onChange:a=>D("hierarchy_level",parseInt(a.target.value)||1),isInvalid:!!l.hierarchy_level,errorMessage:l.hierarchy_level?.[0],min:1,max:10,isRequired:!0,variant:"bordered",size:"sm",radius:y(),description:"1 = Highest (CEO/Director), 2 = Manager, 3+ = Staff levels",classNames:{input:"text-small",inputWrapper:"min-h-unit-10"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),i.hierarchy_level>1&&e.jsx("div",{className:"col-span-2",children:e.jsx(B,{label:"Parent Designation (Optional)",placeholder:i.department_id?F.length===0?"No higher-level designations available":"Select parent designation":"Select department first",selectedKeys:i.parent_id?new Set([String(i.parent_id)]):new Set,onSelectionChange:a=>{const r=Array.from(a)[0];D("parent_id",r||"")},isInvalid:!!l.parent_id,errorMessage:l.parent_id?.[0],isDisabled:!i.department_id||F.length===0,variant:"bordered",size:"sm",radius:y(),description:"Parent must be a higher-level designation in the same department",classNames:{trigger:"min-h-unit-10",value:"text-small"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:F?.map(a=>e.jsxs(P,{value:a.id,children:[a.title," (Level ",a.hierarchy_level,")"]},String(a.id)))})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border",style:{borderColor:"var(--theme-divider, #E4E4E7)",background:"color-mix(in srgb, var(--theme-content2) 30%, transparent)"},children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Active Status"}),e.jsx("p",{className:"text-xs text-default-500 mt-1",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Active designations can be assigned to employees"})]}),e.jsx(Be,{isSelected:i.is_active,onValueChange:a=>D("is_active",a),color:i.is_active?"success":"default",size:"sm"})]})})]})}),e.jsxs(de,{className:"flex justify-between px-4 sm:px-6 py-3 sm:py-4",style:{borderColor:"var(--theme-divider, #E4E4E7)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(I,{variant:"light",onPress:p,isDisabled:c,radius:y(),style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsx(I,{type:"submit",variant:"solid",color:"primary",isLoading:c,isDisabled:c,radius:y(),style:{borderRadius:"var(--borderRadius, 8px)",fontFamily:'var(--fontFamily, "Inter")'},children:s?"Update Designation":"Create Designation"})]})]})]})})})},He=({open:u,onClose:b,onSuccess:j,designation:s})=>{const[v,w]=n.useState(!1),y=()=>{if(typeof window>"u")return"lg";const l=getComputedStyle(document.documentElement).getPropertyValue("--borderRadius")?.trim()||"12px",o=parseInt(l);return o===0?"none":o<=4?"sm":o<=8?"md":o<=16?"lg":"full"},c=async()=>{if(!s){T.error("Invalid designation provided");return}w(!0);const N=new Promise(async(l,o)=>{try{const m=await k.delete(`/designations/${s.id}`);m.status===200&&(j&&j(s,"delete"),l(m.data.message||"Designation deleted successfully"))}catch(m){console.error("Error deleting designation:",m),m.response?.status===400||m.response?.status===422?o(m.response?.data?.error||m.response?.data?.message||"Cannot delete designation with assigned employees"):m.response?.status===404?o("Designation not found or already deleted"):m.response?.status===403?o("You do not have permission to delete this designation"):o("An error occurred while deleting the designation")}finally{w(!1)}});T.promise(N,{pending:{render(){return"Deleting designation..."},icon:!1,style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}},success:{render({data:l}){return b(),l},icon:"✅",style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}},error:{render({data:l}){return l},icon:"❌",style:{backdropFilter:"blur(16px) saturate(200%)",background:"var(--theme-content1)",border:"1px solid var(--theme-divider)",color:"var(--theme-primary)"}}})};return s?e.jsx(ie,{isOpen:u,onOpenChange:v?void 0:b,size:"lg",radius:y(),classNames:{base:"bg-content1",backdrop:"bg-black/50 backdrop-blur-sm"},style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs(ne,{children:[e.jsxs(oe,{className:"flex gap-3 items-center",style:{fontFamily:'var(--fontFamily, "Inter")',borderBottom:"1px solid var(--theme-divider)"},children:[e.jsx("div",{className:"p-2 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-danger) 20%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsx(M,{className:"w-5 h-5",style:{color:"var(--theme-danger)"}})}),e.jsx("span",{className:"text-lg font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Delete Designation"})]}),e.jsx(le,{className:"py-6",style:{fontFamily:'var(--fontFamily, "Inter")'},children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-warning) 10%, transparent)",border:"1px solid color-mix(in srgb, var(--theme-warning) 30%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:[e.jsx(ge,{className:"w-6 h-6 flex-shrink-0",style:{color:"var(--theme-warning)"}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Are you sure you want to delete this designation?"}),e.jsx("p",{className:"text-sm font-semibold",style:{fontFamily:'var(--fontFamily, "Inter")',color:"var(--theme-primary)"},children:s.title})]})]}),s.employee_count>0&&e.jsx("div",{className:"p-4 rounded-lg",style:{background:"color-mix(in srgb, var(--theme-danger) 10%, transparent)",border:"1px solid color-mix(in srgb, var(--theme-danger) 30%, transparent)",borderRadius:"var(--borderRadius, 8px)"},children:e.jsxs("p",{className:"text-sm",style:{fontFamily:'var(--fontFamily, "Inter")',color:"var(--theme-danger)"},children:["This designation has ",e.jsx("strong",{children:s.employee_count})," employees assigned to it. You cannot delete a designation with active employees. Please reassign these employees to other designations first."]})}),e.jsx("p",{className:"text-sm text-default-500",style:{fontFamily:'var(--fontFamily, "Inter")'},children:"This action cannot be undone. All associated data will be permanently removed."})]})}),e.jsxs(de,{style:{borderTop:"1px solid var(--theme-divider)",fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(I,{onPress:b,isDisabled:v,variant:"light",radius:y(),style:{fontFamily:'var(--fontFamily, "Inter")'},children:"Cancel"}),e.jsx(I,{onPress:c,color:"danger",isDisabled:v||s.employee_count>0,isLoading:v,radius:y(),startContent:!v&&e.jsx(M,{className:"w-4 h-4"}),style:{fontFamily:'var(--fontFamily, "Inter")'},children:v?"Deleting...":"Delete Designation"})]})]})}):null},Ea=({title:u,initialDesignations:b,departments:j,managers:s,parentDesignations:v,allDesignations:w,stats:y,filters:c})=>{const{auth:N}=te().props,[l,o]=n.useState(b||{data:[]}),[m,i]=n.useState(!1),[f,F]=n.useState({type:null,designation:null}),D=n.useMemo(()=>{if(!j||j.length===0)return"all";const t={};w?.forEach(d=>{d.department_id&&(t[d.department_id]=(t[d.department_id]||0)+1)});const _=Object.entries(t).sort((d,C)=>C[1]-d[1])[0];return _?String(_[0]):"all"},[j,w]),[g,p]=n.useState({search:c?.search||"",status:c?.status||"all",department:c?.department||D,parentDesignation:c?.parentDesignation||"all"}),[a,r]=n.useState(!1),[S,h]=n.useState("table"),[x,L]=n.useState({currentPage:b?.current_page||1,perPage:b?.per_page||10}),[E,ce]=n.useState(y||{total:0,active:0,inactive:0,parent_designations:0}),[R,me]=n.useState(window.innerWidth<768);n.useEffect(()=>{const t=()=>me(window.innerWidth<768);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const q=N.permissions?.includes("designations.create")||!1,K=N.permissions?.includes("designations.update")||!1,Y=N.permissions?.includes("designations.delete")||!1,$=n.useCallback(async()=>{i(!0);try{const t=await k.get(route("designations.json"),{params:{page:x.currentPage,per_page:x.perPage,search:g.search,status:g.status,department:g.department!=="all"?g.department:void 0,parent_designation:g.parentDesignation}});o(t.data.designations||t.data)}catch(t){console.error("Error fetching designations:",t),T.error("Failed to load designations data")}finally{i(!1)}},[x,g]),O=n.useCallback(async()=>{try{const t=await k.get(route("designations.stats"));t.status===200&&ce(t.data.stats)}catch(t){console.error("Error fetching designation stats:",t)}},[]);n.useEffect(()=>{$(),O()},[$,O]);const V=(t,_)=>{p(d=>({...d,[t]:_})),L(d=>({...d,currentPage:1}))},pe=t=>{L(_=>({..._,currentPage:t})),window.scrollTo({top:0,behavior:"smooth"})},ue=t=>{L({currentPage:1,perPage:t})},A=(t,_=null)=>{F({type:t,designation:_})},U=()=>{F({type:null,designation:null})},G=(t=null,_=null)=>{_==="add"&&t?o(d=>{const C=[t,...d.data];return{...d,data:C,total:(d.total||0)+1}}):_==="edit"&&t?o(d=>{const C=d.data.map(z=>z.id===t.id?t:z);return{...d,data:C}}):_==="delete"&&t?o(d=>{const C=d.data.filter(z=>z.id!==t.id);return{...d,data:C,total:(d.total||1)-1}}):($(),O())},he=n.useMemo(()=>[{title:"Total Designations",value:E.total,icon:e.jsx(H,{className:"w-5 h-5"}),color:"text-blue-400",iconBg:"bg-blue-500/20",description:"All designations"},{title:"Active",value:E.active,icon:e.jsx(se,{className:"w-5 h-5"}),color:"text-green-400",iconBg:"bg-green-500/20",description:"Active designations"},{title:"Inactive",value:E.inactive,icon:e.jsx(re,{className:"w-5 h-5"}),color:"text-red-400",iconBg:"bg-red-500/20",description:"Inactive designations"},{title:"Parent Designations",value:E.parent_designations,icon:e.jsx(Le,{className:"w-5 h-5"}),color:"text-purple-400",iconBg:"bg-purple-500/20",description:"Top-level designations"}],[E]),fe=n.useMemo(()=>{const t=[];return q&&t.push({label:R?"Add":"Add Designation",icon:e.jsx(Me,{className:"w-4 h-4"}),onPress:()=>A("add_designation"),className:"bg-linear-to-r from-(--theme-primary) to-(--theme-secondary) text-white font-medium hover:opacity-90"}),t},[q,R]);return e.jsxs(Ne,{children:[e.jsx(xe,{title:u}),e.jsx("div",{className:"flex justify-center p-4",children:e.jsx(ve.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},children:e.jsx(ye,{className:"shadow-lg",children:e.jsx(be,{title:"Designation Management",subtitle:"Manage company designations and hierarchy",icon:e.jsx(H,{className:"w-8 h-8"}),variant:"default",actionButtons:fe,children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx(je,{stats:he,className:"mb-6"}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(W,{label:"Search Designations",placeholder:"Search by title...",value:g.search,onValueChange:t=>V("search",t),startContent:e.jsx($e,{className:"w-4 h-4 text-default-400"}),variant:"bordered",size:R?"sm":"md",classNames:{base:"w-full",input:"bg-transparent",inputWrapper:"border-default-200 hover:border-default-300"},style:{fontFamily:'var(--fontFamily, "Inter")'}})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs(B,{label:"Department",selectedKeys:g.department?[g.department]:[],onSelectionChange:t=>V("department",Array.from(t)[0]),variant:"bordered",size:R?"sm":"md",className:"w-48",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(P,{children:"All Departments"},"all"),j?.map(t=>e.jsx(P,{children:t.name},String(t.id)))]}),e.jsxs(B,{label:"Status",selectedKeys:g.status?[g.status]:[],onSelectionChange:t=>V("status",Array.from(t)[0]),variant:"bordered",size:R?"sm":"md",className:"w-32",style:{fontFamily:'var(--fontFamily, "Inter")'},children:[e.jsx(P,{children:"All Status"},"all"),e.jsx(P,{children:"Active"},"active"),e.jsx(P,{children:"Inactive"},"inactive")]})]})]}),e.jsx("div",{children:m?e.jsxs("div",{className:"text-center py-6",children:[e.jsx(ae,{size:"lg"}),e.jsx("p",{className:"mt-4 text-default-500",children:"Loading..."})]}):e.jsx(Oe,{designations:l,loading:m,onEdit:K?t=>A("edit_designation",t):void 0,onDelete:Y?t=>A("delete_designation",t):void 0,onView:t=>A("view_designation",t),pagination:x,onPageChange:pe,onRowsPerPageChange:ue,canEditDesignation:K,canDeleteDesignation:Y})})]})})})})}),(f.type==="add_designation"||f.type==="edit_designation")&&e.jsx(Ve,{open:!0,departments:j,designations:w,onClose:U,onSuccess:t=>G(t,f.type==="add_designation"?"add":"edit"),designation:f.designation}),f.type==="delete_designation"&&e.jsx(He,{open:!0,onClose:U,onSuccess:t=>G(t,"delete"),designation:f.designation})]})};export{Ea as default};
